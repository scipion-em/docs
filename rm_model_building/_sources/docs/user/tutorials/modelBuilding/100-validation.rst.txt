.. _`seq:structurevalidation`:

Structure validation and comparison
===================================

| At the end of the refinement process of :math:`\alpha` subunit (a
  similar one would be required for :math:`\beta` subunit), we need to
  assess the geometry of our :math:`model` regarding the starting volume
  to detect :math:`model` controversial elements or :math:`model`
  parameters that disagree with the map. Although each refinement
  program has their own tools to assess the progress of refinement (
  menu; real space correlations; and ), in this tutorial section, three
  assessment tools will be described to obtain comparative validation
  values after using any protocol in the workflow: Protocols (, Appendix
  `[app:emRingerProtocol] <#app:emRingerProtocol>`__,
  :raw-latex:`\citep{barad2015}`), (, Appendix
  `[app:molprobityProtocol] <#app:molprobityProtocol>`__,
  :raw-latex:`\citep{davis2004}`), and (, Appendix
  `[app:valCryoEMProtocol] <#app:valCryoEMProtocol>`__,
  :raw-latex:`\citep{afonine2018b}`). protocol will show validation
  values as well as correlation coefficients in real space. Old versions
  of (v. 1.13) do not include this tool. Correlation values in real
  space will thus be computed if a map is provided in protocol.
  Additionally, we are going to introduce the protocol (Appendix
  `[app:superposePdbsProtocol] <#app:superposePdbsProtocol>`__,
  :raw-latex:`\citep{zwartUrl}`) useful to compare visually the geometry
  of two atomic structures.
| Observe the first validation steps in the modeling workflow in
  starting from output generated by and .

.. figure:: Images/Fig69.pdf
   :alt: framework detailing the workflow to validate the model of the
   human :math:`\alpha` subunit.
   :name: fig:scipion_workflow_validation
   :width: 100.0%

   framework detailing the workflow to validate the model of the human
   :math:`\alpha` subunit.

: Structure validation is a model building step that you have to perform
recursively during the refinement process to assess if you are improving
your structure or not. Once you finish the refinement process you’ll
obtain the final assessment values. These values should be in a certain
range if you want to submit the atomic structure to databases. These
final validation scores should be computed regarding the density map
that you submit as main map, although during the recursive process you
might have used the sharpened maps for refinement/validation.

Specifically designed for cryo-EM data, tool assesses the appropriate
fitting of a model to a map, validating high-resolution features such as
side chain arrangements. The placement of side chains regarding the
molecule skeleton depends on the :math:`\chi_{1}` dihedral angle (a
dihedral angle is the angle between two intersecting planes), which is
determined by atomic positions of (, , ) and (, , ) (see ). The side
chain dihedral angles tend to cluster near :math:`180^\circ` and
:math:`\pm60^\circ`. The lower deviations regarding these values, the
better :math:`model`, and the higher value.

.. figure:: Images/sidechains.pdf
   :alt: Naming convention in side chains explained in a lysine-tyrosine
   strand. Note that these two residues are within a protein and thus
   have no terminal region.
   :name: fig:emringer_chi1
   :width: 65.0%

   Naming convention in side chains explained in a lysine-tyrosine
   strand. Note that these two residues are within a protein and thus
   have no terminal region.

We can start assessing with the :math:`\alpha` subunit :math:`models`
that we have generated along the modeling workflow. In each case, open
the protocol (( (1)), load the extracted map asymmetric unit (initial or
saved with ) (2) and the atomic structure that you’d like to validate in
relation to the map (3), execute the program (4) and analyze results
(5). A menu to check results in detail will be opened (bar ). plots with
density thresholds, with rolling window for each chain, as well as
dihedral angles for each residue are shown here. The most relevant
results, especially the score, will also be written in the protocol (6).

.. figure:: Images/Fig34.pdf
   :alt: Completing protocol form.
   :name: fig:emringer_protocol
   :width: 85.0%

   Completing protocol form.

| Run protocol and determine the respective score after running ,
  refinement, (form parameters indicated in ) after , and refinement
  with MASK before and after . Considering , does our :math:`\alpha`
  subunit :math:`models` seem to be OK or, at least, did they improve?
  (Answers in appendix `[app:solutions] <#app:solutions>`__;
  **Question**\ `1 <#seq:structurevalidation>`__\ **\ \_1**). Try the
  same validation with :math:`\beta` subunit :math:`models`.

.. _section-1:

| The atomic structure validation web service , with better reference
  data has been implemented in the open-source CCTBX portion of
  :raw-latex:`\citep{williams2018}`. This widely used tool assesses
  :math:`model` geometry and quality at both global and local levels.
  Originally designed to evaluate structures coming from X-Ray
  diffraction and NMR, it does not take into account the quality of the
  fitting with a 3D density map. The implementation of in v. 1.13,
  nevertheless, includes the possibility of adding a volume and
  assessing the correlation in the real space.
| The assessment process that we have carried out with can also be done
  with in . We are going to validate the geometry of :math:`\alpha`
  subunit :math:`models` that we have generated along the modeling
  workflow. In each case, open the protocol ( (1)), load the extracted
  unit cell volume (initial or generated by ) (2) with its resolution
  (3) only if your version is 1.13 and you want to have real space
  correlation between map and :math:`model`. For versions higher than
  1.13 simply load the :math:`model` atomic structure (4) and execute
  the protocol (5). With (6) menu bars are shown. results bar include
  validation statistics. Protocol emphasizes the most relevant ones (7).

.. figure:: Images/Fig35.pdf
   :alt: Completing protocol form.
   :name: fig:molprobity_protocol
   :width: 85.0%

   Completing protocol form.

Run protocol to obtain its statistics after running , refinement, (form
parameters indicated in ) after , and refinement with MASK before and
after .

.. _section-2:

| versions higher than 1.13 combine multiple tools for validating
  cryo-EM maps and models into the single tool called
  (:raw-latex:`\citep{afonine2018b}`). This tool has been implemented in
  versions higher than 1.13.
| To carry out the global validation of maps and models obtained from
  cryo-EM data, open the protocol in ( (1)), load the (initial or
  generated by ) (2) with its resolution (3), load the :math:`model`
  atomic structure (4) and execute the protocol (5). (6) shows the same
  menu bars available in results section of protocol. results bar
  include validation statistics. Protocol (7) emphasizes the most
  relevant ones.

.. figure:: Images/Fig60.pdf
   :alt: Filling in protocol form.
   :name: fig:validationCryoEM_protocol
   :width: 90.0%

   Filling in protocol form.

| In order to compare validation results of :math:`models` obtained
  along the modeling workflow, fill in the next table () including, in
  addition to statistics, scores and values obtained before. (Answers in
  appendix `[app:solutions] <#app:solutions>`__;
  **Question**\ `1 <#seq:structurevalidation>`__\ **\ \_2**). The same
  table () can be completed for :math:`\beta` subunit (Appendix
  `[app:solutions] <#app:solutions>`__;
  **Question**\ `1 <#seq:structurevalidation>`__\ **\ \_3**)

.. container::
   :name: table:empty

   .. table:: Validation statistics of human :math:`\alpha` subunit
   :math:`model`. stands for after . stands for .

      =========
      Statistic      
      \              
      after          
      after          
      \              
      \              
      (Bonds)        
      (Angles)       
      (%)            
      (%)            
      (%)            
      (%)            
      \              
      \              
      \              
      \              
      =========

| Results compiled in this table indicate that statistics are
  uncorrelated. From the point of view of correlation in real space, the
  best :math:`model` was obtained from after . Considering , the best
  :math:`model` derives from the whole workflow . With as validation
  rule, the last step in the workflow could be suppressed because the
  best value was obtained after (last modification of parameters). We’d
  like to select the best :math:`model` and continue refining it in
  order to improve it as much as possible. Assuming that no one
  :math:`model` is perfect, how can we select the best one?

:math:`Model` Comparison
------------------------

The question posed in the previous item does not have an easy answer in
the real world, in which we do not know the final atomic structure. In
this tutorial, nevertheless, we know the atomic structure already
published for this cryo-EM map and we may wonder how far we are from it.
The question can be answered by comparing a) validation statistics that
we have obtained for our :math:`models` with the statistics computed for
the available :math:`\alpha` subunit in structure , and b) the atomic
structures themselves by overlapping.

Comparison of validation statistics
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Validation statistics of :math:`\alpha` subunit of structure should be
obtained as first step to compare them with validation statistics of our
:math:`models`. With this aim we are going to follow the workflow
remarked in the :

.. figure:: Images/Fig72.pdf
   :alt: framework detailing the last part of the validation workflow.
   :name: fig:scipion_workflow_validation_2
   :width: 100.0%

   framework detailing the last part of the validation workflow.

-  | Protocol :
   | Download from structure

-  | Protocol (Appendix `[app:chimeraOperate] <#app:chimeraOperate>`__):
   | Similar to , protocol allows to perform operations with atomic
     structures. We are going to use this protocol to save independently
     in the :math:`\alpha` subunit. Open the protocol ( (1)), complete
     the parameter including the atomic structure previously imported
     (2), and execute the protocol (3).

   .. figure:: Images/Fig36.pdf
      :alt: Filling in protocol form.
      :name: fig:chimera_operate_protocol
      :width: 90.0%

      Filling in protocol form.

   | The graphics window will be opened with the structure as model
     number . To save independently the structure of human
     :math:`\alpha` subunit (chain A), write in command line:
   | Remark that the model saved in command line includes both the
     aminoacid chain and the group. In case you are interested in
     extracting only the aminoacid chain, you can use the protocol ,
     specifically designed to extract/add individual chains from/to an
     atomic structure (Atomic Structure Chain Operator; Appendix
     `[app:atomStructUtilsOperatorProtocol] <#app:atomStructUtilsOperatorProtocol>`__).
     Compare the results of protocols and Atomic Structure Chain
     Operator in . The red arrow points at group.

   .. figure:: Images/Fig70.pdf
      :alt: Comparison of results obtained with the protocols (left) and
      Atomic Structure Chain Operator (right).
      :name: fig:chimera_operate_protocol_2
      :width: 75.0%

      Comparison of results obtained with the protocols (left) and
      Atomic Structure Chain Operator (right).

-  Protocol :

   | Open protocol and follow the instructions above indicated. The
     structure saved in will replace this time our previous
     :math:`model`. Results can be observed in .

   .. figure:: Images/Fig71.pdf
      :alt: Results view of protocol.
      :name: fig:chimera_operate_protocol_3
      :width: 70.0%

      Results view of protocol.

-  | Protocol : Open again protocol and, following the already indicated
     instructions, include this time the atomic structure generated in
     the previous step. To fit the :math:`\alpha` subunit from 5NI1
     structure in the extracted asymmetric unit and save the fitting
     write in command line:

-  Validation protocols and:

   Compute validation statistics with these two protocols for
   :math:`\alpha` subunit from structure , write respective values in
   the previous table (), and compare them with the statistics of our
   :math:`models`.

   | Considering results shown in appendix
     `[app:solutions] <#app:solutions>`__
     (**Question**\ `1 <#seq:structurevalidation>`__\ **\ \_2**) for
     :math:`\alpha` subunit, we can conclude that published structures
     are not perfect and we are not very far from this published one. In
     fact, we have overcome every statistic except . Nevertheless, the
     different :math:`models` generated after refinement can still be
     improved by iterative refinement processes. Validation statistics
     thus allow to follow the quality improvement of atomic models.

   .. rubric:: Comparison of atomic structures
      :name: comparison-of-atomic-structures
      :class: unnumbered

   protocol allows to compare two atomic structures by overlapping them.
   Root mean square deviation (RMSD) between the fixed structure (the
   published one) and one of our :math:`models` supports the
   classification of :math:`models` according to its proximity to the
   published model. Open protocol form ( (1)), include the published
   structure of the :math:`\alpha` subunit as fixed structure (2), each
   one of the :math:`models` generated along the worflow (3), execute
   the protocol (4) and check results by pressing (5). Arrows of remark
   differing parts between the atomic structure of the :math:`\alpha`
   subunit from structure (green) and our :math:`model` generated by
   automatic refinement with protocol (pink). By opening these
   structures in you can see the differences between them. Finally,
   complete the with the value of (6) obtained for each :math:`model`.
   (Answers in appendix `[app:solutions] <#app:solutions>`__;
   **Question**\ `1 <#seq:structurevalidation>`__\ **\ \_2**).

   .. figure:: Images/Fig37.pdf
      :alt: Completing protocol form.
      :name: fig:superpose_pdbs_protocol
      :width: 90.0%

      Completing protocol form.

   .. figure:: Images/Fig38.pdf
      :alt: :math:`Model` generated for :math:`\alpha` subunit
      superposed to the published :math:`\alpha` chain of structure.
      :name: fig:superpose_pdbs_chimera
      :width: 50.0%

      :math:`Model` generated for :math:`\alpha` subunit superposed to
      the published :math:`\alpha` chain of structure.

| A :math:`model` for :math:`\alpha` subunit has to be selected at the
  end of the validation process. According to the statistics of
  (Appendix `[app:solutions] <#app:solutions>`__;
  **Question**\ `1 <#seq:structurevalidation>`__\ **\ \_2**), select the
  :math:`model` obtained in modeling workflow showing the smallest RMSD
  value, high value of , quite high value of and acceptable statistics.
  Follow a similar process to validate and select the :math:`model`
  generated for :math:`\beta` subunit. Appendix
  `[app:solutions] <#app:solutions>`__
  **Question**\ `1 <#seq:structurevalidation>`__\ **\ \_3** contains a
  statistics table for :math:`\beta` subunit, similar to that obtained
  for :math:`\alpha` subunit.
| In the real world the selected :math:`models` usually are the starting
  point to improve specific validation parameters by additional
  refinement. Since the improvement of certain parameters normally
  implies worsening of other parameters, a final compromise solution has
  to be taken.
