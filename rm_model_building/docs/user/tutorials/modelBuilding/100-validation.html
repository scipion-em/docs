

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>10. Structure validation and comparison &mdash; Scipion 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/how-to-install.html">Installing Scipion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/host-configuration.html">Host configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user-documentation.html#tutorials">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user-documentation.html#processing-how-to-s">Processing How To’s</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/facilities.html">On-the-fly processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/customize-report.html">Summary Reports</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/scipion-API.html">Scipion API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/plugins-API.html">Plugins API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/xmipp-API.html">Xmipp API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/contact-us.html">Contact Us</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Licences</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">Licenses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">10. </span>Structure validation and comparison</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/docs/user/tutorials/modelBuilding/100-validation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="structure-validation-and-comparison">
<span id="seq-structurevalidation"></span><h1><span class="section-number">10. </span>Structure validation and comparison<a class="headerlink" href="#structure-validation-and-comparison" title="Permalink to this heading">¶</a></h1>
<div class="line-block">
<div class="line">At the end of the refinement process of <span class="math">\alpha</span> subunit (a
similar one would be required for <span class="math">\beta</span> subunit), we need to
assess the geometry of our <span class="math">model</span> regarding the starting volume
to detect <span class="math">model</span> controversial elements or <span class="math">model</span>
parameters that disagree with the map. Although each refinement
program has their own tools to assess the progress of refinement (
menu; real space correlations; and ), in this tutorial section, three
assessment tools will be described to obtain comparative validation
values after using any protocol in the workflow: Protocols (, Appendix
<a class="reference external" href="#app:emRingerProtocol">[app:emRingerProtocol]</a>,
<a href="#id1"><span class="problematic" id="id2">:raw-latex:`\citep{barad2015}`</span></a>), (, Appendix
<a class="reference external" href="#app:molprobityProtocol">[app:molprobityProtocol]</a>,
<a href="#id3"><span class="problematic" id="id4">:raw-latex:`\citep{davis2004}`</span></a>), and (, Appendix
<a class="reference external" href="#app:valCryoEMProtocol">[app:valCryoEMProtocol]</a>,
<a href="#id5"><span class="problematic" id="id6">:raw-latex:`\citep{afonine2018b}`</span></a>). protocol will show validation
values as well as correlation coefficients in real space. Old versions
of (v. 1.13) do not include this tool. Correlation values in real
space will thus be computed if a map is provided in protocol.
Additionally, we are going to introduce the protocol (Appendix
<a class="reference external" href="#app:superposePdbsProtocol">[app:superposePdbsProtocol]</a>,
<a href="#id7"><span class="problematic" id="id8">:raw-latex:`\citep{zwartUrl}`</span></a>) useful to compare visually the geometry
of two atomic structures.</div>
<div class="line">Observe the first validation steps in the modeling workflow in
starting from output generated by and .</div>
</div>
<p>: Structure validation is a model building step that you have to perform
recursively during the refinement process to assess if you are improving
your structure or not. Once you finish the refinement process you’ll
obtain the final assessment values. These values should be in a certain
range if you want to submit the atomic structure to databases. These
final validation scores should be computed regarding the density map
that you submit as main map, although during the recursive process you
might have used the sharpened maps for refinement/validation.</p>
<p>Specifically designed for cryo-EM data, tool assesses the appropriate
fitting of a model to a map, validating high-resolution features such as
side chain arrangements. The placement of side chains regarding the
molecule skeleton depends on the <span class="math">\chi_{1}</span> dihedral angle (a
dihedral angle is the angle between two intersecting planes), which is
determined by atomic positions of (, , ) and (, , ) (see ). The side
chain dihedral angles tend to cluster near <span class="math">180^\circ</span> and
<span class="math">\pm60^\circ</span>. The lower deviations regarding these values, the
better <span class="math">model</span>, and the higher value.</p>
<p>We can start assessing with the <span class="math">\alpha</span> subunit <span class="math">models</span>
that we have generated along the modeling workflow. In each case, open
the protocol (( (1)), load the extracted map asymmetric unit (initial or
saved with ) (2) and the atomic structure that you’d like to validate in
relation to the map (3), execute the program (4) and analyze results
(5). A menu to check results in detail will be opened (bar ). plots with
density thresholds, with rolling window for each chain, as well as
dihedral angles for each residue are shown here. The most relevant
results, especially the score, will also be written in the protocol (6).</p>
<div class="figure align-default" id="fig-emringer-protocol">
<a class="reference internal image-reference" href="docs/user/tutorials/modelBuilding/Images/Fig34.pdf"><img alt="Completing protocol form." src="docs/user/tutorials/modelBuilding/Images/Fig34.pdf" style="width: 85.0%;" /></a>
<p class="caption"><span class="caption-text">Completing protocol form.</span><a class="headerlink" href="#fig-emringer-protocol" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line">Run protocol and determine the respective score after running ,
refinement, (form parameters indicated in ) after , and refinement
with MASK before and after . Considering , does our <span class="math">\alpha</span>
subunit <span class="math">models</span> seem to be OK or, at least, did they improve?
(Answers in appendix <a class="reference external" href="#app:solutions">[app:solutions]</a>;
<strong>Question</strong><a class="reference external" href="#seq:structurevalidation">1</a><strong>_1</strong>). Try the
same validation with <span class="math">\beta</span> subunit <span class="math">models</span>.</div>
</div>
<div class="line-block" id="section-1">
<div class="line">The atomic structure validation web service , with better reference
data has been implemented in the open-source CCTBX portion of
<a href="#id9"><span class="problematic" id="id10">:raw-latex:`\citep{williams2018}`</span></a>. This widely used tool assesses
<span class="math">model</span> geometry and quality at both global and local levels.
Originally designed to evaluate structures coming from X-Ray
diffraction and NMR, it does not take into account the quality of the
fitting with a 3D density map. The implementation of in v. 1.13,
nevertheless, includes the possibility of adding a volume and
assessing the correlation in the real space.</div>
<div class="line">The assessment process that we have carried out with can also be done
with in . We are going to validate the geometry of <span class="math">\alpha</span>
subunit <span class="math">models</span> that we have generated along the modeling
workflow. In each case, open the protocol ( (1)), load the extracted
unit cell volume (initial or generated by ) (2) with its resolution
(3) only if your version is 1.13 and you want to have real space
correlation between map and <span class="math">model</span>. For versions higher than
1.13 simply load the <span class="math">model</span> atomic structure (4) and execute
the protocol (5). With (6) menu bars are shown. results bar include
validation statistics. Protocol emphasizes the most relevant ones (7).</div>
</div>
<div class="figure align-default" id="fig-molprobity-protocol">
<a class="reference internal image-reference" href="docs/user/tutorials/modelBuilding/Images/Fig35.pdf"><img alt="Completing protocol form." src="docs/user/tutorials/modelBuilding/Images/Fig35.pdf" style="width: 85.0%;" /></a>
<p class="caption"><span class="caption-text">Completing protocol form.</span><a class="headerlink" href="#fig-molprobity-protocol" title="Permalink to this image">¶</a></p>
</div>
<p>Run protocol to obtain its statistics after running , refinement, (form
parameters indicated in ) after , and refinement with MASK before and
after .</p>
<div class="line-block" id="section-2">
<div class="line">versions higher than 1.13 combine multiple tools for validating
cryo-EM maps and models into the single tool called
(<a href="#id11"><span class="problematic" id="id12">:raw-latex:`\citep{afonine2018b}`</span></a>). This tool has been implemented in
versions higher than 1.13.</div>
<div class="line">To carry out the global validation of maps and models obtained from
cryo-EM data, open the protocol in ( (1)), load the (initial or
generated by ) (2) with its resolution (3), load the <span class="math">model</span>
atomic structure (4) and execute the protocol (5). (6) shows the same
menu bars available in results section of protocol. results bar
include validation statistics. Protocol (7) emphasizes the most
relevant ones.</div>
</div>
<div class="figure align-default" id="fig-validationcryoem-protocol">
<a class="reference internal image-reference" href="docs/user/tutorials/modelBuilding/Images/Fig60.pdf"><img alt="Filling in protocol form." src="docs/user/tutorials/modelBuilding/Images/Fig60.pdf" style="width: 90.0%;" /></a>
<p class="caption"><span class="caption-text">Filling in protocol form.</span><a class="headerlink" href="#fig-validationcryoem-protocol" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line">In order to compare validation results of <span class="math">models</span> obtained
along the modeling workflow, fill in the next table () including, in
addition to statistics, scores and values obtained before. (Answers in
appendix <a class="reference external" href="#app:solutions">[app:solutions]</a>;
<strong>Question</strong><a class="reference external" href="#seq:structurevalidation">1</a><strong>_2</strong>). The same
table () can be completed for <span class="math">\beta</span> subunit (Appendix
<a class="reference external" href="#app:solutions">[app:solutions]</a>;
<strong>Question</strong><a class="reference external" href="#seq:structurevalidation">1</a><strong>_3</strong>)</div>
</div>
<div class="docutils container" id="table-empty">
<p><span class="math">model</span>. stands for after . stands for .</p>
<blockquote>
<div><p>Statistic
after
after
(Bonds)
(Angles)
(%)
(%)
(%)
(%)
=========</p>
</div></blockquote>
</div>
<div class="line-block">
<div class="line">Results compiled in this table indicate that statistics are
uncorrelated. From the point of view of correlation in real space, the
best <span class="math">model</span> was obtained from after . Considering , the best
<span class="math">model</span> derives from the whole workflow . With as validation
rule, the last step in the workflow could be suppressed because the
best value was obtained after (last modification of parameters). We’d
like to select the best <span class="math">model</span> and continue refining it in
order to improve it as much as possible. Assuming that no one
<span class="math">model</span> is perfect, how can we select the best one?</div>
</div>
<div class="section" id="model-comparison">
<h2><span class="section-number">10.1. </span><span class="math">Model</span> Comparison<a class="headerlink" href="#model-comparison" title="Permalink to this heading">¶</a></h2>
<p>The question posed in the previous item does not have an easy answer in
the real world, in which we do not know the final atomic structure. In
this tutorial, nevertheless, we know the atomic structure already
published for this cryo-EM map and we may wonder how far we are from it.
The question can be answered by comparing a) validation statistics that
we have obtained for our <span class="math">models</span> with the statistics computed for
the available <span class="math">\alpha</span> subunit in structure , and b) the atomic
structures themselves by overlapping.</p>
<div class="section" id="comparison-of-validation-statistics">
<h3><span class="section-number">10.1.1. </span>Comparison of validation statistics<a class="headerlink" href="#comparison-of-validation-statistics" title="Permalink to this heading">¶</a></h3>
<p>Validation statistics of <span class="math">\alpha</span> subunit of structure should be
obtained as first step to compare them with validation statistics of our
<span class="math">models</span>. With this aim we are going to follow the workflow
remarked in the :</p>
<div class="figure align-default" id="fig-scipion-workflow-validation-2">
<a class="reference internal image-reference" href="docs/user/tutorials/modelBuilding/Images/Fig72.pdf"><img alt="framework detailing the last part of the validation workflow." src="docs/user/tutorials/modelBuilding/Images/Fig72.pdf" style="width: 100.0%;" /></a>
<p class="caption"><span class="caption-text">framework detailing the last part of the validation workflow.</span><a class="headerlink" href="#fig-scipion-workflow-validation-2" title="Permalink to this image">¶</a></p>
</div>
<ul>
<li><div class="line-block">
<div class="line">Protocol :</div>
<div class="line">Download from structure</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Protocol (Appendix <a class="reference external" href="#app:chimeraOperate">[app:chimeraOperate]</a>):</div>
<div class="line">Similar to , protocol allows to perform operations with atomic
structures. We are going to use this protocol to save independently
in the <span class="math">\alpha</span> subunit. Open the protocol ( (1)), complete
the parameter including the atomic structure previously imported
(2), and execute the protocol (3).</div>
</div>
<div class="figure align-default" id="fig-chimera-operate-protocol">
<a class="reference internal image-reference" href="docs/user/tutorials/modelBuilding/Images/Fig36.pdf"><img alt="Filling in protocol form." src="docs/user/tutorials/modelBuilding/Images/Fig36.pdf" style="width: 90.0%;" /></a>
<p class="caption"><span class="caption-text">Filling in protocol form.</span><a class="headerlink" href="#fig-chimera-operate-protocol" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line">The graphics window will be opened with the structure as model
number . To save independently the structure of human
<span class="math">\alpha</span> subunit (chain A), write in command line:</div>
<div class="line">Remark that the model saved in command line includes both the
aminoacid chain and the group. In case you are interested in
extracting only the aminoacid chain, you can use the protocol ,
specifically designed to extract/add individual chains from/to an
atomic structure (Atomic Structure Chain Operator; Appendix
<a class="reference external" href="#app:atomStructUtilsOperatorProtocol">[app:atomStructUtilsOperatorProtocol]</a>).
Compare the results of protocols and Atomic Structure Chain
Operator in . The red arrow points at group.</div>
</div>
</li>
<li><p>Protocol :</p>
<div class="line-block">
<div class="line">Open protocol and follow the instructions above indicated. The
structure saved in will replace this time our previous
<span class="math">model</span>. Results can be observed in .</div>
</div>
<div class="figure align-default" id="fig-chimera-operate-protocol-3">
<a class="reference internal image-reference" href="docs/user/tutorials/modelBuilding/Images/Fig71.pdf"><img alt="Results view of protocol." src="docs/user/tutorials/modelBuilding/Images/Fig71.pdf" style="width: 70.0%;" /></a>
<p class="caption"><span class="caption-text">Results view of protocol.</span><a class="headerlink" href="#fig-chimera-operate-protocol-3" title="Permalink to this image">¶</a></p>
</div>
</li>
<li><div class="line-block">
<div class="line">Protocol : Open again protocol and, following the already indicated
instructions, include this time the atomic structure generated in
the previous step. To fit the <span class="math">\alpha</span> subunit from 5NI1
structure in the extracted asymmetric unit and save the fitting
write in command line:</div>
</div>
</li>
<li><p>Validation protocols and:</p>
<p>Compute validation statistics with these two protocols for
<span class="math">\alpha</span> subunit from structure , write respective values in
the previous table (), and compare them with the statistics of our
<span class="math">models</span>.</p>
<div class="line-block">
<div class="line">Considering results shown in appendix
<a class="reference external" href="#app:solutions">[app:solutions]</a>
(<strong>Question</strong><a class="reference external" href="#seq:structurevalidation">1</a><strong>_2</strong>) for
<span class="math">\alpha</span> subunit, we can conclude that published structures
are not perfect and we are not very far from this published one. In
fact, we have overcome every statistic except . Nevertheless, the
different <span class="math">models</span> generated after refinement can still be
improved by iterative refinement processes. Validation statistics
thus allow to follow the quality improvement of atomic models.</div>
</div>
<p class="unnumbered rubric" id="comparison-of-atomic-structures">Comparison of atomic structures</p>
<p>protocol allows to compare two atomic structures by overlapping them.
Root mean square deviation (RMSD) between the fixed structure (the
published one) and one of our <span class="math">models</span> supports the
classification of <span class="math">models</span> according to its proximity to the
published model. Open protocol form ( (1)), include the published
structure of the <span class="math">\alpha</span> subunit as fixed structure (2), each
one of the <span class="math">models</span> generated along the worflow (3), execute
the protocol (4) and check results by pressing (5). Arrows of remark
differing parts between the atomic structure of the <span class="math">\alpha</span>
subunit from structure (green) and our <span class="math">model</span> generated by
automatic refinement with protocol (pink). By opening these
structures in you can see the differences between them. Finally,
complete the with the value of (6) obtained for each <span class="math">model</span>.
(Answers in appendix <a class="reference external" href="#app:solutions">[app:solutions]</a>;
<strong>Question</strong><a class="reference external" href="#seq:structurevalidation">1</a><strong>_2</strong>).</p>
<div class="figure align-default" id="fig-superpose-pdbs-protocol">
<a class="reference internal image-reference" href="docs/user/tutorials/modelBuilding/Images/Fig37.pdf"><img alt="Completing protocol form." src="docs/user/tutorials/modelBuilding/Images/Fig37.pdf" style="width: 90.0%;" /></a>
<p class="caption"><span class="caption-text">Completing protocol form.</span><a class="headerlink" href="#fig-superpose-pdbs-protocol" title="Permalink to this image">¶</a></p>
</div>
</li>
</ul>
<div class="line-block">
<div class="line">A <span class="math">model</span> for <span class="math">\alpha</span> subunit has to be selected at the
end of the validation process. According to the statistics of
(Appendix <a class="reference external" href="#app:solutions">[app:solutions]</a>;
<strong>Question</strong><a class="reference external" href="#seq:structurevalidation">1</a><strong>_2</strong>), select the
<span class="math">model</span> obtained in modeling workflow showing the smallest RMSD
value, high value of , quite high value of and acceptable statistics.
Follow a similar process to validate and select the <span class="math">model</span>
generated for <span class="math">\beta</span> subunit. Appendix
<a class="reference external" href="#app:solutions">[app:solutions]</a>
<strong>Question</strong><a class="reference external" href="#seq:structurevalidation">1</a><strong>_3</strong> contains a
statistics table for <span class="math">\beta</span> subunit, similar to that obtained
for <span class="math">\alpha</span> subunit.</div>
<div class="line">In the real world the selected <span class="math">models</span> usually are the starting
point to improve specific validation parameters by additional
refinement. Since the improvement of certain parameters normally
implies worsening of other parameters, a final compromise solution has
to be taken.</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: rm_model_building
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../../../gh-pages/index.html">gh-pages</a></dd>
            <dd><a href="../../../../../release-2.0.0/index.html">release-2.0.0</a></dd>
            <dd><a href="../../../../../release-3.0.0/index.html">release-3.0.0</a></dd>
            <dd><a href="100-validation.html">rm_model_building</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>