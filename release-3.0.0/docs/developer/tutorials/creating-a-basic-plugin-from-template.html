

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Creating a basic calculator plugin from scipion-em-template &mdash; Scipion 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../scipion-modes/how-to-install.html">Installing Scipion v3.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scipion-modes/host-configuration.html">Host configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user/user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/user-documentation.html#tutorials">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/user-documentation.html#processing-how-to-s">Processing How To’s</a></li>
</ul>
<p class="caption"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../facilities/facilities.html">On-the-fly processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../facilities/customize-report.html">Summary Reports</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developers.html">Developers Page</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/scipion-API.html">Scipion API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/plugins-API.html">Plugins API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/xmipp-API.html">Xmipp API</a></li>
</ul>
<p class="caption"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../misc/contact-us.html">Contact Us</a></li>
</ul>
<p class="caption"><span class="caption-text">Licences</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user/license.html">Licenses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>Creating a basic calculator plugin from scipion-em-template</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/docs/developer/tutorials/creating-a-basic-plugin-from-template.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="figure">
<a class="reference internal image-reference" href="../../../_images/scipion_logo.gif"><img alt="scipion logo" src="../../../_images/scipion_logo.gif" style="width: 250px;" /></a>
</div>
<div class="section" id="creating-a-basic-calculator-plugin-from-scipion-em-template">
<span id="creating-a-basic-plugin-from-template"></span><h1>Creating a basic calculator plugin from scipion-em-template<a class="headerlink" href="#creating-a-basic-calculator-plugin-from-scipion-em-template" title="Permalink to this headline">¶</a></h1>
<div class="section" id="associated-resources">
<h2>Associated resources<a class="headerlink" href="#associated-resources" title="Permalink to this headline">¶</a></h2>
<p>Here you can find resources associated with this content, like videos or presentations used in courses:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.google.com/presentation/d/1sACaNZFgH0qWeXE6BLUWEDW3cjYTS4kbojrKvvRp78s/present?usp=sharing">Course presentation</a></li>
</ul>
</div>
<div class="section" id="cloning-and-installing-scipion-em-template">
<h2>Cloning and installing scipion-em-template<a class="headerlink" href="#cloning-and-installing-scipion-em-template" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> desired/location
git clone -b course1_exBase https://github.com/scipion-em/scipion-em-template.git
<span class="nb">cd</span> scipion3/location
./scipion3 installp -p scipion-em-template/location --devel
</pre></div>
</div>
</div>
<div class="section" id="check-if-the-plugin-works-correctly">
<h2>Check if the plugin works correctly<a class="headerlink" href="#check-if-the-plugin-works-correctly" title="Permalink to this headline">¶</a></h2>
<p>Follow these steps:</p>
<ol class="arabic simple">
<li>Open a new terminal and move to Scipion’s directory:</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> scipion3/dir/
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li>Start Scipion:</li>
</ol>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./scipion3
</pre></div>
</div>
<ol class="arabic simple" start="3">
<li>Click on <strong>Create Project</strong>, type a name for it and then click on <strong>Create</strong>.</li>
</ol>
<div class="figure">
<img alt="create Scipion3 project" src="../../../_images/practice1_create_project.png" />
</div>
<p>4. On the left menu find the protocol called <strong>Hello world</strong>
(it is located in Protocols SPA -&gt; Tools -&gt; Greetings), double click on it. A window like this should appear:</p>
<div class="figure">
<img alt="Hello world protocol gui" src="../../../_images/practice1_hello_world_protocol_gui.png" />
</div>
<ol class="arabic simple" start="5">
<li>Click on the <strong>magic wand</strong> icon, choose <strong>Hola Mundo</strong> and click on <strong>Select</strong> button.</li>
</ol>
<div class="figure">
<img alt="Hello world protocol walkthrough" src="../../../_images/practice1_protocol_gui_walkthrough.png" />
</div>
<ol class="arabic simple" start="6">
<li>Change parameter <strong>Times</strong> value to <strong>5</strong> and click on <strong>Execute</strong> button.</li>
</ol>
<div class="figure">
<img alt="Hello world protocol execution" src="../../../_images/practice1_protocol_gui_execution.png" />
</div>
<ol class="arabic simple" start="7">
<li>Once the execution is finished, your project should look like this (observe the information displayed below in the
Summary tab).</li>
</ol>
<div class="figure">
<img alt="project gui summary" src="../../../_images/practice1_project_gui_summary.png" />
</div>
<ol class="arabic simple" start="8">
<li>Check also tabs Methods and Output Log. On the last one, in the <strong>run.stdout</strong> tab you can see the output produced by the
protocol and detailed information about the protocol execution.</li>
</ol>
<div class="figure">
<img alt="project gui log" src="../../../_images/practice1_project_gui_log.png" />
</div>
<ol class="arabic simple" start="9">
<li>Check pointer parameter functionality: right click on the protocol box and select <strong>Copy</strong>.</li>
</ol>
<div class="figure">
<img alt="project gui copy protocol" src="../../../_images/practice1_project_gui_copy_protocol.png" />
</div>
<ol class="arabic simple" start="10">
<li>Update the values for parameters <strong>Message</strong> and <strong>Times</strong> to the ones shown below and click on the <em>Magnifying glass*</em> icon.</li>
</ol>
<div class="figure">
<img alt="protocol gui second walkthrough" src="../../../_images/practice1_protocol_gui_2nd_walkthrough.png" />
</div>
<ol class="arabic simple" start="11">
<li>Select the only item that appears on the list and click on <strong>Select</strong>. Finally, click on <strong>Execute</strong> button in the
protocol window.</li>
</ol>
<div class="figure">
<img alt="protocol gui pointer select object" src="../../../_images/practice1_pointer_select_object.png" />
</div>
<ol class="arabic simple" start="12">
<li>Observe now in the summary area that the input value stored from the previous execution is shown, and that it has
been used in the counter calculation.</li>
</ol>
<div class="figure">
<img alt="project gui summary second" src="../../../_images/practice1_project_gui_summary_II.png" />
</div>
<p><em>Conclusion</em>:</p>
<p>Protocol <strong>myplugin - hello world</strong> receives 3 inputs:</p>
<ul class="simple">
<li>Message, which can be manually introduced or selected from a list of predefined options via a wizard.</li>
<li>Times, to specify how many times the message will be printed.</li>
<li>Previous count, optional parameter to be updated with a pointer which takes into account the number of times the
message has been printed in the previous execution.</li>
</ul>
</div>
<div class="section" id="convert-template-plugin-into-a-calculator">
<h2>Convert template plugin into a calculator<a class="headerlink" href="#convert-template-plugin-into-a-calculator" title="Permalink to this headline">¶</a></h2>
<p><em>Note</em>: if you get stuck in any of the exercises, the solution is provided via git branch in each of them. Due to the
exercises being consecutive you can move to the branch needed and continue. For example, if you got stuck in exercise
3 and want to continue, simply move to the branch which contains the solution of exercise 2 to get the check point from
where to continue.</p>
<p>To begin the practice, launch your favourite IDE (we recommend PyCharm).</p>
<p>Then, Click on File &gt; Open and select your plugin folder (scipion-em-template). Follow these steps:</p>
<ol class="arabic simple">
<li>Move your plugin protocol to the protocols list to the view <strong>Practice1</strong>, section <strong>PracticeDay1</strong>, into the protocol
group <strong>MyGroup</strong>, under the name of <strong>My first protocol</strong> (<em>Hint</em>: change file <strong>protocols.conf</strong>).
Once done, you need to close and reopen the Scipion project window (you can use a shortcut <strong>./scipion3 last</strong> that opens the last modified project).
The result should look like this:</li>
</ol>
<div class="figure" id="id1">
<img alt="exercise 1" src="../../../_images/practice1_ex1.png" />
<p class="caption"><span class="caption-text">Solution:</span></p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> scipion-em-template/location
git checkout -b course1_ex1
</pre></div>
</div>
<ol class="arabic" start="2">
<li><p class="first">Edit the wizard (file <strong>wizards.py</strong>) to change the greetings into operations: <strong>Sum, Subtract, Multiply, Divide</strong>.</p>
<p><em>Hint</em>: to make the wizard description coherent with the new operational behaviour, update the wizard window
title and wizard window message from <strong>‘Greetings from the world’</strong> to <strong>‘My calculator operations’</strong> and
<strong>‘Select one of the greetings’</strong> to <strong>‘Select one of the operations’</strong>. This must be done in the dialog definition
(line <strong>dlg = dialog.ListDialog(form.root, “Greetings from the world”, provider,  “Select one of the operations”</strong>).</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">if the variable name <strong>greetings</strong> is changed, use the same name as the input in the provider definition,
e. g., if greetings variable is renamed to myoperations (line <strong>operations = [String(‘ …)</strong>, then line <strong>provider =
ListTreeProviderString(greetings)</strong> must be updated to <strong>provider = ListTreeProviderString(myoperations)</strong>.</p>
</div>
<p>The result should look like this:</p>
</li>
</ol>
<div class="figure" id="id2">
<img alt="exercise 2" src="../../../_images/practice1_ex2.png" />
<p class="caption"><span class="caption-text"><em>Note</em>: The message field still shows the value <strong>Ciao mondo</strong> which isn’t one of the four options introduced in
the wizard. This will be fixed in the next exercise.</span></p>
<div class="legend">
Solution:</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> scipion-em-template/location
git checkout -b course1_ex2
</pre></div>
</div>
<ol class="arabic" start="3">
<li><p class="first">In the <strong>protocols.py</strong> rename the label field <strong>Message</strong> to <strong>Operation</strong>, and its default value to <strong>Sum</strong>. Update also the parameter
name to <strong>operation</strong> and the help to <strong>‘Operation which will be applied.’</strong>.</p>
<dl class="docutils">
<dt><em>Hint</em>: <strong>form.addParam</strong> method attributes are:</dt>
<dd><ul class="first last simple">
<li>Parameter name: name internally used in the code to refer to that parameter as a <strong>protocol attribute</strong>.</li>
<li>Data type, e.g. StringParam</li>
<li>Other attributes with syntax attributeName=attributeValue, e.g. label=’Message’.</li>
</ul>
</dd>
</dl>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">the wizard’s target is still the old field name and must be updated to the new one. To do that, in file
wizards.py, update the line <strong>_targets = [(MyPluginPrefixHelloWorld, [‘message’])]</strong> to <strong>_targets =
[(MyPluginPrefixHelloWorld, [‘operation’])]</strong>. Also, the wizard output must point to the new parameter, so update line
<strong>form.setVar(‘message’, dlg.values[0].get())</strong> to <strong>form.setVar(‘operation’, dlg.values[0].get())</strong>.</p>
</div>
<p>The result should look like this:</p>
</li>
</ol>
<div class="figure" id="id3">
<img alt="exercise 3" src="../../../_images/practice1_ex3.png" />
<p class="caption"><span class="caption-text">Solution:</span></p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> scipion-em-template/location
git checkout -b course1_ex3
</pre></div>
</div>
<ol class="arabic" start="4">
<li><p class="first">Now rename <strong>Times</strong> parameter to <strong>Operand 1</strong>, with a default value of <strong>1</strong>, parameter name to <strong>operand1</strong> and
its help to <strong>‘First operand considered in the selected operation.’</strong>.</p>
<p><em>Hint</em>: because the result of a division operation may be a float number, the data type must be changed to <strong>params.FloatParam</strong>.</p>
<p>Again, the result should look like:</p>
</li>
</ol>
<div class="figure" id="id4">
<img alt="exercise 4" src="../../../_images/practice1_ex4.png" />
<p class="caption"><span class="caption-text">Solution:</span></p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> scipion-em-template/location
git checkout -b course1_ex4
</pre></div>
</div>
<ol class="arabic" start="5">
<li><p class="first">Repeat the same for parameter <strong>Previous count</strong>: its new label will be <strong>Operand 2</strong>, with a default value of <strong>1</strong>,
parameter name <strong>operand2</strong> and its help <strong>‘Second operand considered in the selected operation.’</strong>.</p>
<p><em>Hint 1</em>: the new behaviour of this parameter doesn’t require pointers or null values.</p>
<p><em>Hint 2</em>: to make the parameter label bold in the protocol GUI, set the parameter attribute <strong>important=True</strong>.</p>
<p><em>Hint 3</em>: read the hint for the exercise 4. It also applies to the operand2.</p>
<p>The result should look like this:</p>
</li>
</ol>
<div class="figure" id="id5">
<img alt="exercise 5" src="../../../_images/practice1_ex5.png" />
<p class="caption"><span class="caption-text"><em>Note</em>: Observe that the magnifying glass icon is no longer present because this parameter is not allowing pointers.</span></p>
<div class="legend">
Solution:</div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> scipion-em-template/location
git checkout -b course1_ex5
</pre></div>
</div>
<ol class="arabic" start="6">
<li><p class="first">In the <strong>protocols.py</strong> type the operating method and customize the info functions.</p>
<p>To do that, follow these steps:</p>
<blockquote>
<div><dl class="docutils">
<dt>6.1  Insert <strong>‘Calculate’</strong> step, which will be called when protocol’s Execute button is pressed: replace the</dt>
<dd><p class="first last">line used to insert the previous greetingsStep,  <strong>self._insertFunctionStep(‘greetingsStep’)</strong>, by
<strong>self._insertFunctionStep(‘calculateStep’)</strong>.</p>
</dd>
</dl>
<p>6.2  Replace the method <strong>greetingsStep</strong> by a new one called <strong>calculateStep</strong>.</p>
<blockquote>
<div><p><em>Hint</em>: get operands and operation values from the GUI with <strong>self.[PARAM_NAME].get()</strong> and then implement the
operations logic using <strong>if</strong> command. Result of the operation must be stored in a protocol attribute, e. g.,
<strong>self.result</strong>, which must be of type float.</p>
</div></blockquote>
<p>6.3  Update output step, so the result is registered and thus available to be used, for example, in the methods or summary.</p>
<blockquote>
<div><blockquote>
<div><p><em>Hint</em>: use protocol inherited method <strong>self._defineOutputs</strong> to do that.</p>
</div></blockquote>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">to make a <strong>variable value be registered, it must be casted to a Scipion data type</strong>. In this
case, <strong>self.result</strong> should be casted to type <strong>params.Float</strong>.</p>
</div>
</div></blockquote>
<dl class="docutils">
<dt>6.4  Finally, in terms of customizing the protocol’s support/info functions, we’ll focus</dt>
<dd><p class="first last">only on the <strong>_summary</strong> method. Thus, you can comment or delete the method <strong>_methods</strong>. Then, update the
summary message which will be displayed so it shows the operation selected, both operands and the result.</p>
</dd>
</dl>
</div></blockquote>
<p>The result should look like:</p>
</li>
</ol>
<div class="figure" id="id6">
<img alt="exercise 6" src="../../../_images/practice1_ex6.png" />
<p class="caption"><span class="caption-text">Solution:</span></p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> scipion-em-template/location
git checkout -b course1_ex6
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: release-3.0.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../../az-install/docs/developer/tutorials/creating-a-basic-plugin-from-template.html">az-install</a></dd>
            <dd><a href="../../../../dependabot_pip_jinja2-2.11.3/docs/developer/tutorials/creating-a-basic-plugin-from-template.html">dependabot/pip/jinja2-2.11.3</a></dd>
            <dd><a href="../../../../dependabot_pip_pygments-2.7.4/docs/developer/tutorials/creating-a-basic-plugin-from-template.html">dependabot/pip/pygments-2.7.4</a></dd>
            <dd><a href="../../../../dependabot_pip_urllib3-1.26.5/docs/developer/tutorials/creating-a-basic-plugin-from-template.html">dependabot/pip/urllib3-1.26.5</a></dd>
            <dd><a href="../../../../gh-pages/index.html">gh-pages</a></dd>
            <dd><a href="../../../../release-2.0.0/index.html">release-2.0.0</a></dd>
            <dd><a href="creating-a-basic-plugin-from-template.html">release-3.0.0</a></dd>
            <dd><a href="../../../../rsanchezgarc-patch-1/docs/developer/tutorials/creating-a-basic-plugin-from-template.html">rsanchezgarc-patch-1</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>