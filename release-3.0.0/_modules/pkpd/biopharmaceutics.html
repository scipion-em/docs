

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pkpd.biopharmaceutics &mdash; Scipion 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../docs/scipion-modes/how-to-install.html">Installing Scipion v3.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/scipion-modes/host-configuration.html">Host configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/user/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../docs/user/user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/user/user-documentation.html#tutorials">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/user/user-documentation.html#processing-how-to-s">Processing How Toâ€™s</a></li>
</ul>
<p class="caption"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../docs/facilities/facilities.html">On-the-fly processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/facilities/customize-report.html">Summary Reports</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../docs/developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../docs/api/scipion-API.html">Scipion API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/api/plugins-API.html">Plugins API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docs/api/xmipp-API.html">Xmipp API</a></li>
</ul>
<p class="caption"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../docs/misc/contact-us.html">Contact Us</a></li>
</ul>
<p class="caption"><span class="caption-text">Licences</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../docs/user/license.html">Licenses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../pkpd.html">pkpd</a> &raquo;</li>
        
      <li>pkpd.biopharmaceutics</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pkpd.biopharmaceutics</h1><div class="highlight"><pre>
<span></span><span class="c1"># **************************************************************************</span>
<span class="c1"># *</span>
<span class="c1"># * Authors:     Carlos Oscar Sorzano (info@kinestat.com)</span>
<span class="c1"># *</span>
<span class="c1"># * Kinestat Pharma</span>
<span class="c1"># *</span>
<span class="c1"># * This program is free software; you can redistribute it and/or modify</span>
<span class="c1"># * it under the terms of the GNU General Public License as published by</span>
<span class="c1"># * the Free Software Foundation; either version 2 of the License, or</span>
<span class="c1"># * (at your option) any later version.</span>
<span class="c1"># *</span>
<span class="c1"># * This program is distributed in the hope that it will be useful,</span>
<span class="c1"># * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># * GNU General Public License for more details.</span>
<span class="c1"># *</span>
<span class="c1"># * You should have received a copy of the GNU General Public License</span>
<span class="c1"># * along with this program; if not, write to the Free Software</span>
<span class="c1"># * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA</span>
<span class="c1"># * 02111-1307  USA</span>
<span class="c1"># *</span>
<span class="c1"># *  All comments concerning this program package may be sent to the</span>
<span class="c1"># *  e-mail address &#39;info@kinestat.com&#39;</span>
<span class="c1"># *</span>
<span class="c1"># **************************************************************************</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Biopharmaceutics: Drug sources and how they dissolve</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">.pkpd_units</span> <span class="k">import</span> <span class="n">PKPDUnit</span><span class="p">,</span> <span class="n">changeRateToWeight</span><span class="p">,</span> <span class="n">divideUnits</span><span class="p">,</span> <span class="n">inverseUnits</span>
<span class="kn">from</span> <span class="nn">pkpd.utils</span> <span class="k">import</span> <span class="n">uniqueFloatValues</span><span class="p">,</span> <span class="n">excelWriteRow</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="k">import</span> <span class="n">InterpolatedUnivariateSpline</span><span class="p">,</span> <span class="n">PchipInterpolator</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="k">import</span> <span class="n">lambertw</span><span class="p">,</span> <span class="n">wrightomega</span>

<div class="viewcode-block" id="BiopharmaceuticsModel"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModel</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="BiopharmaceuticsModel.getNumberOfParameters"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.getNumberOfParameters">[docs]</a>    <span class="k">def</span> <span class="nf">getNumberOfParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParameterNames</span><span class="p">())</span></div>

    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="BiopharmaceuticsModel.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModel.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModel.setExperiment"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.setExperiment">[docs]</a>    <span class="k">def</span> <span class="nf">setExperiment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ptrExperiment</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span> <span class="o">=</span> <span class="n">ptrExperiment</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModel.getExperiment"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.getExperiment">[docs]</a>    <span class="k">def</span> <span class="nf">getExperiment</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModel.getDoseUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.getDoseUnits">[docs]</a>    <span class="k">def</span> <span class="nf">getDoseUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_WEIGHT_mg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getDoseUnits</span><span class="p">()</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModel.setParameters"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.setParameters">[docs]</a>    <span class="k">def</span> <span class="nf">setParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span> <span class="o">=</span> <span class="n">parameters</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModel.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="c1"># Total amount of drug that is available at time t</span>
        <span class="k">return</span> <span class="mf">0.0</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModel.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModel.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModel.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModel.areParametersSignificant"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">)):</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">lower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">upper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;False&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">lower</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">upper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModel.areParametersValid"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModel.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>


<div class="viewcode-block" id="BiopharmaceuticsModelOrder0"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder0">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelOrder0</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Constant absorption rate&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder0.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder0.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Rin&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder0.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder0.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dunits</span><span class="o">=</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_WEIGHT_mg</span>
            <span class="n">tunits</span><span class="o">=</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_TIME_MIN</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dunits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getDoseUnits</span><span class="p">()</span>
            <span class="n">tunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">dunits</span><span class="p">,</span><span class="n">tunits</span><span class="p">)</span>
        <span class="n">rateUnits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">dunits</span><span class="p">,</span><span class="n">tunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">rateUnits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder0.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder0.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">Rin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">-</span><span class="n">Rin</span><span class="o">*</span><span class="n">t</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder0.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder0.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Rin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=(</span><span class="si">%f</span><span class="s2">)*t&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Rin</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder0.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder0.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=Rin*t&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder0.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder0.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Zero order absorption (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div></div>


<div class="viewcode-block" id="BiopharmaceuticsModelOrder01"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelOrder01</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Constant absorption rate&#39;</span><span class="p">,</span><span class="s1">&#39;Constant absorption time&#39;</span><span class="p">,</span><span class="s1">&#39;Absorption rate&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Rin&#39;</span><span class="p">,</span><span class="s1">&#39;t0&#39;</span><span class="p">,</span><span class="s1">&#39;Ka&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">tunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span>
        <span class="k">if</span> <span class="n">tunits</span> <span class="o">==</span> <span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_TIME_MIN</span><span class="p">:</span>
            <span class="n">rateUnits</span> <span class="o">=</span> <span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_WEIGHTINVTIME_mg_MIN</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rateUnits</span> <span class="o">=</span> <span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_WEIGHTINVTIME_mg_H</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">rateUnits</span><span class="p">,</span> <span class="n">tunits</span><span class="p">,</span> <span class="n">inverseUnits</span><span class="p">(</span><span class="n">tunits</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">Rin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Ka</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;</span><span class="n">t0</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">-</span><span class="n">Rin</span><span class="o">*</span><span class="n">t</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">A0</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">-</span><span class="n">Rin</span><span class="o">*</span><span class="n">t0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">A0</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ka</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">t0</span><span class="p">))</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Rin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Ka</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=(</span><span class="si">%f</span><span class="s2">)*t if t&lt;</span><span class="si">%f</span><span class="s2"> and (</span><span class="si">%f</span><span class="s2">)*t+((</span><span class="si">%f</span><span class="s2">)-(</span><span class="si">%f</span><span class="s2">)*(</span><span class="si">%f</span><span class="s2">))*(1-exp(-(</span><span class="si">%f</span><span class="s2">)*t) if t&gt;</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Rin</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">Rin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="p">,</span> <span class="n">Rin</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">Ka</span><span class="p">,</span> <span class="n">t0</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=Rin*t if t&lt;t0 and Rin*t0+(Amax-Rin*t0)*(1-exp(-Ka*(t-t0)) if t&gt;t0&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Zero-First Mixed order absorption (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01Tlag1"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01Tlag1">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelOrder01Tlag1</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Fraction absorbed at order 0&#39;</span><span class="p">,</span><span class="s1">&#39;Constant absorption rate&#39;</span><span class="p">,</span><span class="s1">&#39;Constant absorption time&#39;</span><span class="p">,</span><span class="s1">&#39;Absorption rate&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01Tlag1.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01Tlag1.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;F0&#39;</span><span class="p">,</span><span class="s1">&#39;Rin&#39;</span><span class="p">,</span><span class="s1">&#39;tlag1&#39;</span><span class="p">,</span><span class="s1">&#39;Ka&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01Tlag1.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01Tlag1.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">dUnits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDoseUnits</span><span class="p">()</span>
        <span class="n">tUnits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">dUnits</span><span class="p">,</span><span class="n">tUnits</span><span class="p">),</span> <span class="n">tUnits</span><span class="p">,</span> <span class="n">inverseUnits</span><span class="p">(</span><span class="n">tUnits</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01Tlag1.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01Tlag1.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">F0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Rin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Rin</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">tlag1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Ka</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">A</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span>
        <span class="n">A</span><span class="o">-=</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="n">F0</span><span class="p">,</span><span class="n">Rin</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&gt;</span><span class="n">tlag1</span><span class="p">:</span>
            <span class="n">A</span><span class="o">-=</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ka</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">tlag1</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">A</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01Tlag1.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01Tlag1.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">F0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Rin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tlag1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Ka</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=(</span><span class="si">%f</span><span class="s2">)*t if 0&lt;t&lt;</span><span class="si">%f</span><span class="s2"> and (</span><span class="si">%f</span><span class="s2">)*(</span><span class="si">%f</span><span class="s2">)*(1-exp(-(</span><span class="si">%f</span><span class="s2">)*(t-(</span><span class="si">%f</span><span class="s2">))) if t&gt;</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Rin</span><span class="p">,</span> <span class="n">F0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">/</span><span class="n">Rin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">F0</span><span class="p">,</span> <span class="n">Ka</span><span class="p">,</span> <span class="n">tlag1</span><span class="p">,</span> <span class="n">tlag1</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01Tlag1.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01Tlag1.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=Rin*t if t&lt;Amax*F0/Rin and Amax*(1-F0)*(1-exp(-Ka*(t-tlag1)) if t&gt;tlag1&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder01Tlag1.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder01Tlag1.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Zero-First Mixed order absorption (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelOrder1</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Absorption rate&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Ka&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">inverseUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span><span class="p">)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">Ka</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ka</span><span class="o">*</span><span class="n">t</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Ka</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=(</span><span class="si">%f</span><span class="s2">)*(1-exp(-(</span><span class="si">%f</span><span class="s2">)*t)&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="p">,</span><span class="n">Ka</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=Amax*(1-exp(-Ka*t))&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;First order absorption (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div></div>


<div class="viewcode-block" id="BiopharmaceuticsModelOrderFractional"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrderFractional">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelOrderFractional</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Initial amount&#39;</span><span class="p">,</span><span class="s1">&#39;Constant absorption rate&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelOrderFractional.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrderFractional.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Amax&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">,</span><span class="s1">&#39;alpha&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrderFractional.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrderFractional.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_WEIGHT_mg</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_WEIGHTINVTIME_mg_MIN</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrderFractional.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrderFractional.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">Amax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">K</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">aux</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">t</span>
        <span class="k">if</span> <span class="n">aux</span><span class="o">&gt;</span><span class="n">Amax</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">Amax</span>
        <span class="k">return</span> <span class="n">Amax</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">Amax</span><span class="p">,</span><span class="n">alpha</span><span class="p">)</span><span class="o">-</span><span class="n">aux</span><span class="p">,</span><span class="mf">1.0</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrderFractional.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrderFractional.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Amax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">K</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=(</span><span class="si">%f</span><span class="s2">)-((</span><span class="si">%f</span><span class="s2">)^(</span><span class="si">%f</span><span class="s2">)-(</span><span class="si">%f</span><span class="s2">)*(</span><span class="si">%f</span><span class="s2">)*t)^(1/(</span><span class="si">%f</span><span class="s2">))&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Amax</span><span class="p">,</span><span class="n">Amax</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">alpha</span><span class="p">,</span><span class="n">alpha</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrderFractional.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrderFractional.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=Amax-(Amax^alpha-alpha*K*t)^(1/alpha)&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrderFractional.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrderFractional.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Fractional order absorption (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrderFractional.areParametersValid"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrderFractional.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1</span></div></div>


<div class="viewcode-block" id="BiopharmaceuticsModelImmediateAndOrder1"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelImmediateAndOrder1">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelImmediateAndOrder1</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Absorption rate&#39;</span><span class="p">,</span><span class="s1">&#39;Immediate fraction&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelImmediateAndOrder1.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelImmediateAndOrder1.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Ka&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelImmediateAndOrder1.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelImmediateAndOrder1.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">inverseUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span><span class="p">),</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelImmediateAndOrder1.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelImmediateAndOrder1.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">Ka</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">F</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ka</span><span class="o">*</span><span class="n">t</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelImmediateAndOrder1.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelImmediateAndOrder1.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Ka</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">F</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=(</span><span class="si">%f</span><span class="s2">)*delta(t)+(</span><span class="si">%f</span><span class="s2">)*(1-exp(-(</span><span class="si">%f</span><span class="s2">)*t)&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="n">F</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F</span><span class="p">),</span><span class="n">Ka</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelImmediateAndOrder1.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelImmediateAndOrder1.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=Amax*F*delta(t)+(1-F)*Amax*(1-exp(-Ka*t))&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelImmediateAndOrder1.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelImmediateAndOrder1.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Immediate and First order absorption (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div></div>


<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelOrder1AndOrder1</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Absorption rate1&#39;</span><span class="p">,</span><span class="s1">&#39;Absorption rate2&#39;</span><span class="p">,</span><span class="s1">&#39;tlag2&#39;</span><span class="p">,</span><span class="s1">&#39;Fraction 1&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Ka1&#39;</span><span class="p">,</span><span class="s1">&#39;Ka2&#39;</span><span class="p">,</span><span class="s1">&#39;tlag12&#39;</span><span class="p">,</span><span class="s1">&#39;F1&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">tunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">inverseUnits</span><span class="p">(</span><span class="n">tunits</span><span class="p">),</span><span class="n">inverseUnits</span><span class="p">(</span><span class="n">tunits</span><span class="p">),</span><span class="n">tunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">Ka1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Ka2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tlag12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">F1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">A1</span><span class="o">=</span><span class="n">F1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ka1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="n">A2</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">F1</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&gt;</span><span class="n">tlag12</span><span class="p">:</span>
            <span class="n">A2</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F1</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ka2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="n">tlag12</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="p">(</span><span class="n">A1</span><span class="o">+</span><span class="n">A2</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Ka1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Ka2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tlag12</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">F1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=(</span><span class="si">%f</span><span class="s2">)*(1-exp(-(</span><span class="si">%f</span><span class="s2">)*t)+(</span><span class="si">%f</span><span class="s2">)*(1-exp(-(</span><span class="si">%f</span><span class="s2">)*(t-</span><span class="si">%f</span><span class="s2">))&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="n">F1</span><span class="p">,</span><span class="n">Ka1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F1</span><span class="p">),</span><span class="n">Ka2</span><span class="p">,</span><span class="n">tlag12</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=Amax*F1*(1-exp(-Ka1*t))+(1-F1)*Amax*(1-exp(-Ka2*(t-tlag12)))&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;First and First order absorption (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div></div>


<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1Saturable"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1Saturable">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelOrder1AndOrder1Saturable</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Srihari Gopal M.D., M.H.S., An Vermeulen Ph.D., Partha Nandy Ph.D., Paulien Ravenstijn Ph.D., Isaac</span>
<span class="sd">        Nuamah Ph.D., J.A. Buron Vidal M.D., Joris Berwaerts M.D., Adam Savitz M.D., Ph.D., David Hough M.D. &amp; Mahesh</span>
<span class="sd">        N. Samtani Ph.D. Practical Guidance for Dosing and Switching from Paliperidone Palmitate 1-Monthly to 3-Monthly</span>
<span class="sd">        Formulation in Schizophrenia, Current Medical Research and Opinion, 2015, 31: 2043-2054.</span>

<span class="sd">        There are two absorptions of order 1: one is slow (fraction=1-F3), the other is rapid (fraction=F3).</span>
<span class="sd">        Both absorptions are saturable by the amount present in the absorption compartment so that the instantaneous</span>
<span class="sd">        absorption rate depends on the amount remaining.</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Maximal absorption rate slow&#39;</span><span class="p">,</span><span class="s1">&#39;Amount at 50</span><span class="si">% o</span><span class="s1">f slow absorption rate&#39;</span><span class="p">,</span><span class="s1">&#39;Hill factor&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Maximal absorption rate rapid&#39;</span><span class="p">,</span><span class="s1">&#39;Amount at 50</span><span class="si">% o</span><span class="s1">f rapid absorption rate&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Fraction 3&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1Saturable.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1Saturable.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;ka1max&#39;</span><span class="p">,</span><span class="s1">&#39;kamt150&#39;</span><span class="p">,</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span><span class="s1">&#39;ka3max&#39;</span><span class="p">,</span><span class="s1">&#39;kamt350&#39;</span><span class="p">,</span><span class="s1">&#39;F3&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1Saturable.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1Saturable.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">tunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span>
        <span class="n">Dunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getDoseUnits</span><span class="p">()</span>
        <span class="n">kaUnits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Dunits</span><span class="p">,</span><span class="n">tunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">kaUnits</span><span class="p">,</span> <span class="n">Dunits</span><span class="p">,</span> <span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span>
                               <span class="n">kaUnits</span><span class="p">,</span> <span class="n">Dunits</span><span class="p">,</span> <span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1Saturable.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1Saturable.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">ka1max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">kamt150</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ka3max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">kamt350</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">F3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">gamma</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">F3</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">F3</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">A50</span> <span class="o">=</span> <span class="n">kamt150</span>
            <span class="n">Ka</span> <span class="o">=</span> <span class="n">ka1max</span>
            <span class="n">A0</span> <span class="o">=</span> <span class="n">F3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">Ka</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">A50</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">A0</span> <span class="o">/</span> <span class="n">A50</span><span class="p">)))</span> <span class="o">/</span> <span class="n">A50</span><span class="p">)</span> <span class="o">/</span> <span class="n">A50</span>
            <span class="n">Aslow</span> <span class="o">=</span> <span class="n">A50</span> <span class="o">*</span> <span class="n">lambertw</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">Aslow</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">A50</span> <span class="o">=</span> <span class="n">kamt350</span>
            <span class="n">Ka</span> <span class="o">=</span> <span class="n">ka3max</span>
            <span class="n">A0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F3</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span>
            <span class="n">A0gamma</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span><span class="n">gamma</span><span class="p">)</span>
            <span class="n">A50gamma</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">A50</span><span class="p">,</span><span class="n">gamma</span><span class="p">)</span>
            <span class="n">A0log</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A0</span><span class="p">)</span>
            <span class="n">Arapid</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(((</span><span class="n">A0gamma</span> <span class="o">+</span> <span class="n">A50gamma</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">A0log</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span> <span class="o">-</span> <span class="n">Ka</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="n">A50gamma</span> <span class="o">-</span>
                         <span class="n">wrightomega</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">A50gamma</span><span class="p">)</span> <span class="o">+</span>
                                    <span class="p">(</span><span class="n">gamma</span> <span class="o">*</span> <span class="p">((</span><span class="n">A0gamma</span> <span class="o">+</span> <span class="n">A50gamma</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">A0log</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span> <span class="o">-</span> <span class="n">Ka</span> <span class="o">*</span> <span class="n">t</span><span class="p">))</span> <span class="o">/</span> <span class="n">A50gamma</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">Arapid</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="n">Aslow</span><span class="o">+</span><span class="n">Arapid</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">retval</span><span class="p">):</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">retval</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1Saturable.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1Saturable.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ka1max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">kamt150</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">gamma</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ka3max</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">kamt350</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">F3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">A50</span> <span class="o">=</span> <span class="n">kamt150</span>
        <span class="n">Ka</span> <span class="o">=</span> <span class="n">ka1max</span>
        <span class="n">A0</span> <span class="o">=</span> <span class="n">F3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">A50</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">A0</span> <span class="o">/</span> <span class="n">A50</span><span class="p">))</span>
        <span class="n">Aslow</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%f</span><span class="s2"> * lambertw(exp(-(</span><span class="si">%f</span><span class="s2"> * t - (</span><span class="si">%f</span><span class="s2">)) / </span><span class="si">%f</span><span class="s2">) / </span><span class="si">%f</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">A50</span><span class="p">,</span><span class="n">Ka</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">A50</span><span class="p">,</span><span class="n">A50</span><span class="p">)</span>

        <span class="n">A50</span> <span class="o">=</span> <span class="n">kamt350</span>
        <span class="n">Ka</span> <span class="o">=</span> <span class="n">ka3max</span>
        <span class="n">A0</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F3</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span>
        <span class="n">A0gamma</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">A0</span><span class="p">,</span><span class="n">gamma</span><span class="p">)</span>
        <span class="n">A50gamma</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">A50</span><span class="p">,</span><span class="n">gamma</span><span class="p">)</span>
        <span class="n">A0log</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">A0</span><span class="p">)</span>
        <span class="n">C1</span> <span class="o">=</span> <span class="p">(</span><span class="n">A0gamma</span> <span class="o">+</span> <span class="n">A50gamma</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">A0log</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span>
        <span class="n">Arapid</span> <span class="o">=</span> <span class="s2">&quot;exp((</span><span class="si">%f</span><span class="s2"> - Ka * t) / </span><span class="si">%f</span><span class="s2"> - &quot;</span><span class="o">%</span><span class="p">(</span><span class="n">C1</span><span class="p">,</span><span class="n">A50gamma</span><span class="p">)</span>
        <span class="n">C2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">A50gamma</span><span class="p">)</span>
        <span class="n">C3</span> <span class="o">=</span> <span class="p">(</span><span class="n">A0gamma</span> <span class="o">+</span> <span class="n">A50gamma</span> <span class="o">*</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">A0log</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span>
        <span class="n">Arapid</span> <span class="o">+=</span> <span class="s2">&quot;wrightOmega((</span><span class="si">%f</span><span class="s2">) + (</span><span class="si">%f</span><span class="s2"> * (</span><span class="si">%f</span><span class="s2"> - (</span><span class="si">%f</span><span class="s2">) * t)) / </span><span class="si">%f</span><span class="s2">) / </span><span class="si">%f</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">C2</span><span class="p">,</span><span class="n">gamma</span><span class="p">,</span><span class="n">C3</span><span class="p">,</span><span class="n">Ka</span><span class="p">,</span><span class="n">A50gamma</span><span class="p">,</span><span class="n">gamma</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=(</span><span class="si">%s</span><span class="s2">)+(</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Aslow</span><span class="p">,</span><span class="n">Arapid</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1Saturable.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1Saturable.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=kamt150 * lambertw(exp(-(ka1max * t - kamt150 * log(F3*Amax * exp(F3*Amax / kamt150))) / kamt150) / kamt150) &quot;</span><span class="o">+</span>\
                     <span class="s2">&quot;exp(((((1-F3)*Amax)^gamma + kamt350^gamma*gamma*log((1-F3)*Amax))/gamma - ka3max*t)/kamt350^gamma - wrightOmega(log(1/kamt350^gamma) + (gamma*((((1-F3)*Amax)^gamma + kamt350^gamma*gamma*log((1-F3)*Amax))/gamma - ka3max*t))/kamt350^gamma)/gamma)&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1AndOrder1Saturable.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1AndOrder1Saturable.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;First and First order absorption with saturation (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div></div>


<div class="viewcode-block" id="BiopharmaceuticsModelDoubleWeibull"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelDoubleWeibull">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelDoubleWeibull</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Time1 63%&#39;</span><span class="p">,</span><span class="s1">&#39;Exponential power1&#39;</span><span class="p">,</span><span class="s1">&#39;Fraction1&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Time2 63%&#39;</span><span class="p">,</span><span class="s1">&#39;Exponential power2&#39;</span><span class="p">,</span><span class="s1">&#39;tlag2&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelDoubleWeibull.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelDoubleWeibull.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;td1&#39;</span><span class="p">,</span><span class="s1">&#39;b1&#39;</span><span class="p">,</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span><span class="s1">&#39;td2&#39;</span><span class="p">,</span><span class="s1">&#39;b2&#39;</span><span class="p">,</span><span class="s1">&#39;tlag2&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelDoubleWeibull.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelDoubleWeibull.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">tunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">tunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span>
                               <span class="n">tunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">tunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelDoubleWeibull.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelDoubleWeibull.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">td1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">F1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">td2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">tlag2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

        <span class="n">t2</span> <span class="o">=</span> <span class="n">t</span><span class="o">-</span><span class="n">tlag2</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="n">F1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">td1</span><span class="p">,</span><span class="n">b1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">t2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">f2</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F1</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">t2</span><span class="o">/</span><span class="n">td2</span><span class="p">,</span><span class="n">b2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f2</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="p">(</span><span class="n">f1</span><span class="o">+</span><span class="n">f2</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelDoubleWeibull.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelDoubleWeibull.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">td1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">F1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">td2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">tlag2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=</span><span class="si">%f</span><span class="s2">*(1-(</span><span class="si">%f</span><span class="s2">)*exp(-(t/</span><span class="si">%f</span><span class="s2">)^(</span><span class="si">%f</span><span class="s2">))-(</span><span class="si">%f</span><span class="s2">)*exp(-((t-</span><span class="si">%f</span><span class="s2">)/</span><span class="si">%f</span><span class="s2">)^(</span><span class="si">%f</span><span class="s2">))&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="p">,</span><span class="n">F1</span><span class="p">,</span><span class="n">td1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">F1</span><span class="p">,</span><span class="n">tlag2</span><span class="p">,</span><span class="n">td2</span><span class="p">,</span><span class="n">b2</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelDoubleWeibull.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelDoubleWeibull.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=Amax*(1-F1*exp(-(t/td1)^b1)-(1-F1)*exp(-((t-tlag2)/td2)^b2)&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelDoubleWeibull.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelDoubleWeibull.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Double Weibull absorption (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelDoubleWeibull.areParametersValid"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelDoubleWeibull.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1</span></div></div>

<div class="viewcode-block" id="BiopharmaceuticsModelTripleWeibull"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelTripleWeibull">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelTripleWeibull</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Time1 63%&#39;</span><span class="p">,</span><span class="s1">&#39;Exponential power1&#39;</span><span class="p">,</span><span class="s1">&#39;Fraction1&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Time2 63%&#39;</span><span class="p">,</span><span class="s1">&#39;Exponential power2&#39;</span><span class="p">,</span><span class="s1">&#39;tlag2&#39;</span><span class="p">,</span> <span class="s1">&#39;Fraction2&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Time3 63%&#39;</span><span class="p">,</span><span class="s1">&#39;Exponential power3&#39;</span><span class="p">,</span><span class="s1">&#39;tlag3&#39;</span><span class="p">]</span>


<div class="viewcode-block" id="BiopharmaceuticsModelTripleWeibull.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelTripleWeibull.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;td1&#39;</span><span class="p">,</span><span class="s1">&#39;b1&#39;</span><span class="p">,</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span><span class="s1">&#39;td2&#39;</span><span class="p">,</span><span class="s1">&#39;b2&#39;</span><span class="p">,</span><span class="s1">&#39;tlag2&#39;</span><span class="p">,</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span><span class="s1">&#39;td3&#39;</span><span class="p">,</span><span class="s1">&#39;b3&#39;</span><span class="p">,</span><span class="s1">&#39;tlag3&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelTripleWeibull.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelTripleWeibull.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">tunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">tunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span>
                               <span class="n">tunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">tunits</span><span class="p">,</span> <span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span>
                               <span class="n">tunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">tunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelTripleWeibull.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelTripleWeibull.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">td1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">F1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">td2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">tlag2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">F2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">td3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">b3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
        <span class="n">tlag3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>

        <span class="n">f1</span> <span class="o">=</span> <span class="n">F1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">td1</span><span class="p">,</span><span class="n">b1</span><span class="p">))</span>
        <span class="n">t2</span> <span class="o">=</span> <span class="n">t</span><span class="o">-</span><span class="n">tlag2</span>
        <span class="k">if</span> <span class="n">t2</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">f2</span><span class="o">=</span><span class="n">F2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">t2</span><span class="o">/</span><span class="n">td2</span><span class="p">,</span><span class="n">b2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f2</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">t3</span> <span class="o">=</span> <span class="n">t</span><span class="o">-</span><span class="n">tlag3</span>
        <span class="k">if</span> <span class="n">t3</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">f3</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F1</span><span class="o">-</span><span class="n">F2</span><span class="p">)</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">t3</span><span class="o">/</span><span class="n">td3</span><span class="p">,</span><span class="n">b3</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f3</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="p">(</span><span class="n">f1</span><span class="o">+</span><span class="n">f2</span><span class="o">+</span><span class="n">f3</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelTripleWeibull.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelTripleWeibull.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">td1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">b1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">F1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">td2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">b2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">tlag2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">F2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">td3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">b3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span>
        <span class="n">tlag3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=</span><span class="si">%f</span><span class="s2">*(1-(</span><span class="si">%f</span><span class="s2">)*exp(-(t/</span><span class="si">%f</span><span class="s2">)^(</span><span class="si">%f</span><span class="s2">))-(</span><span class="si">%f</span><span class="s2">)*exp(-((t-</span><span class="si">%f</span><span class="s2">)/</span><span class="si">%f</span><span class="s2">)^(</span><span class="si">%f</span><span class="s2">)-(</span><span class="si">%f</span><span class="s2">)*exp(-((t-</span><span class="si">%f</span><span class="s2">)/</span><span class="si">%f</span><span class="s2">)^(</span><span class="si">%f</span><span class="s2">)))&quot;</span><span class="o">%</span>\
               <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="p">,</span><span class="n">F1</span><span class="p">,</span><span class="n">td1</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">F2</span><span class="p">,</span><span class="n">tlag2</span><span class="p">,</span><span class="n">td2</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">F1</span><span class="o">-</span><span class="n">F2</span><span class="p">,</span><span class="n">tlag3</span><span class="p">,</span><span class="n">td3</span><span class="p">,</span><span class="n">b3</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelTripleWeibull.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelTripleWeibull.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=Amax*(1-F1*exp(-(t/td1)^b1)-F2*exp(-((t-tlag2)/td2)^b2)-(1-F1-F2)*exp(-((t-tlag3)/td3)^b3))&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelTripleWeibull.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelTripleWeibull.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Triple Weibull absorption (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelTripleWeibull.areParametersValid"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelTripleWeibull.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1</span></div></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1Multiple4"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1Multiple4">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelOrder1Multiple4</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Br J Clin Pharmacol. 2013 Dec;76(6):868-79. doi: 10.1111/bcp.12118.</span>
<span class="sd">        Determination of the pharmacokinetics of glycopyrronium in the lung using a population pharmacokinetic</span>
<span class="sd">        modelling approach. Christian Bartels 1, Michael Looby, Romain Sechaud, Guenther Kaiser</span>

<span class="sd">        There are 4 entry vias:</span>
<span class="sd">        - F1, Order1: F1*(1-exp(-Ka1*t))</span>
<span class="sd">        - (1-F1), Remaining:</span>
<span class="sd">            - Slow: (1-F1)*Fslow*(1-exp(-Kaslow*t))</span>
<span class="sd">            - Medium: (1-F1)*Fmed*(1-exp(-Kamed*t))</span>
<span class="sd">            - Fast: (1-F1)*(1-Fmed-Fslow)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Fraction 1&#39;</span><span class="p">,</span><span class="s1">&#39;Absorption rate 1&#39;</span><span class="p">,</span><span class="s1">&#39;Fraction medium&#39;</span><span class="p">,</span><span class="s1">&#39;Absorption rate medium&#39;</span><span class="p">,</span><span class="s1">&#39;Fraction slow&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Absorption rate slow&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1Multiple4.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1Multiple4.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span><span class="s1">&#39;Ka1&#39;</span><span class="p">,</span><span class="s1">&#39;Fmed&#39;</span><span class="p">,</span><span class="s1">&#39;Kamed&#39;</span><span class="p">,</span><span class="s1">&#39;Fslow&#39;</span><span class="p">,</span><span class="s1">&#39;Kaslow&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1Multiple4.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1Multiple4.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">Kunits</span> <span class="o">=</span> <span class="n">inverseUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span> <span class="n">Kunits</span><span class="p">,</span> <span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span> <span class="n">Kunits</span><span class="p">,</span> <span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span> <span class="n">Kunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1Multiple4.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1Multiple4.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="n">F1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Ka1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Fmed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Kamed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Fslow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Kaslow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">via1</span> <span class="o">=</span> <span class="n">F1</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ka1</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="n">viafast</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Fmed</span><span class="o">-</span><span class="n">Fslow</span><span class="p">)</span>
        <span class="n">viamed</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F1</span><span class="p">)</span><span class="o">*</span><span class="n">Fmed</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Kamed</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="n">viaslow</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">F1</span><span class="p">)</span><span class="o">*</span><span class="n">Fslow</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Kaslow</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="p">(</span><span class="n">via1</span> <span class="o">+</span> <span class="n">viafast</span> <span class="o">+</span> <span class="n">viamed</span> <span class="o">+</span> <span class="n">viaslow</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1Multiple4.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1Multiple4.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">F1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Ka1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Fmed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Kamed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Fslow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Kaslow</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=(</span><span class="si">%f</span><span class="s2">)*(</span><span class="si">%f</span><span class="s2">*(1-exp(-</span><span class="si">%f</span><span class="s2">*t)) + (1-</span><span class="si">%f</span><span class="s2">)*(1-</span><span class="si">%f</span><span class="s2">*exp(-</span><span class="si">%f</span><span class="s2">*t)-</span><span class="si">%f</span><span class="s2">*exp(-</span><span class="si">%f</span><span class="s2">*t)))&quot;</span><span class="o">%</span>\
                  <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="p">,</span><span class="n">F1</span><span class="p">,</span><span class="n">Ka1</span><span class="p">,</span><span class="n">F1</span><span class="p">,</span><span class="n">Fmed</span><span class="p">,</span><span class="n">Kamed</span><span class="p">,</span><span class="n">Fslow</span><span class="p">,</span><span class="n">Kaslow</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1Multiple4.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1Multiple4.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=F1*(1-exp(-Ka1*t)) + (1-F1)*(1-Fmed*exp(-Kamed*t)-Fslow*exp(-Kaslow*t))&quot;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelOrder1Multiple4.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelOrder1Multiple4.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Multiple first order absorption (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div></div>


<div class="viewcode-block" id="BiopharmaceuticsModelSplineGeneric"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineGeneric">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSplineGeneric</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parametersPrepared</span><span class="o">=</span><span class="kc">None</span>

    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;B-spline model with </span><span class="si">%d</span><span class="s1"> knots&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineGeneric.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineGeneric.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tmax&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="o">&gt;=</span><span class="mi">10</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;spline</span><span class="si">%d</span><span class="s1">_A</span><span class="si">%02d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">+=</span><span class="p">[</span><span class="s1">&#39;spline</span><span class="si">%d</span><span class="s1">_A</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineGeneric.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineGeneric.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">+=</span> <span class="p">[</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineGeneric.rearrange"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineGeneric.rearrange">[docs]</a>    <span class="k">def</span> <span class="nf">rearrange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameters</span><span class="p">):</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="n">parameters</span>
        <span class="n">retval</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">retval</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineGeneric.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineGeneric.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&gt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">tmax</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parametersPrepared</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parametersPrepared</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="p">)</span>
            <span class="n">knotsUnique</span><span class="p">,</span> <span class="n">knotsYUnique</span><span class="o">=</span><span class="n">uniqueFloatValues</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knots</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="o">=</span><span class="n">PchipInterpolator</span><span class="p">(</span><span class="n">knotsUnique</span><span class="p">,</span> <span class="n">knotsYUnique</span><span class="p">)</span>
                <span class="c1"># self.B=InterpolatedUnivariateSpline(knotsUnique, knotsYUnique, k=1)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.tmax&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.nknots&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.parameters[1:]&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error en spline&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">knots</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="p">,</span> <span class="n">knotsUnique</span><span class="p">,</span> <span class="n">knotsYUnique</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Bug in spline&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parametersPrepared</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
        <span class="n">fraction</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">fraction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">fraction</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1">#print(&quot;getAg t= %f B(t)= %f fraction= %f Ag= %f&quot;%(t,self.B(t),fraction,self.Amax*(1-fraction)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">fraction</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineGeneric.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineGeneric.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="p">)</span>
        <span class="n">retval</span><span class="o">=</span><span class="s2">&quot;D(t) interpolating spline at x=</span><span class="si">%s</span><span class="s2"> and y=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array2string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knots</span><span class="p">,</span><span class="n">max_line_width</span><span class="o">=</span><span class="mi">10000</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">array2string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="p">,</span><span class="n">max_line_width</span><span class="o">=</span><span class="mi">10000</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineGeneric.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineGeneric.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># https://en.wikipedia.org/wiki/De_Boor%27s_algorithm</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=interpolating BSpline1 with </span><span class="si">%d</span><span class="s2"> knots distributed until tmax&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineGeneric.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineGeneric.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;BSplines with </span><span class="si">%d</span><span class="s2"> knots (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineGeneric.areParametersValid"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineGeneric.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline2"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline2">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline2</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline3"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline3">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline3</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">3</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline4"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline4">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline4</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">4</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline5"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline5">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline5</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">5</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline6"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline6">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline6</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">6</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline7"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline7">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline7</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">7</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline8"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline8">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline8</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">8</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline9"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline9">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline9</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">9</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline10"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline10">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline10</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">10</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline11"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline11">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline11</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">11</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline12"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline12">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline12</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">12</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline13"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline13">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline13</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">13</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline14"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline14">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline14</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">14</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline15"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline15">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline15</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">15</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline16"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline16">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline16</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">16</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline17"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline17">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline17</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">17</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline18"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline18">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline18</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">18</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline19"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline19">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline19</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">19</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSpline20"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSpline20">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSpline20</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">20</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXYGeneric"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXYGeneric">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSplineXYGeneric</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="o">=</span><span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parametersPrepared</span><span class="o">=</span><span class="kc">None</span>

    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;B-splineXY model with </span><span class="si">%d</span><span class="s1"> knots&#39;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXYGeneric.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXYGeneric.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tmax&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">):</span>
            <span class="n">retval</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;spline</span><span class="si">%d</span><span class="s1">_X</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">,</span> <span class="n">i</span><span class="p">)]</span>
            <span class="n">retval</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;spline</span><span class="si">%d</span><span class="s1">_A</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">,</span> <span class="n">i</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXYGeneric.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXYGeneric.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">+=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXYGeneric.rearrange"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXYGeneric.rearrange">[docs]</a>    <span class="k">def</span> <span class="nf">rearrange</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parameters</span><span class="p">):</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="n">parameters</span>
        <span class="n">retval</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">retval</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">retval</span><span class="p">[</span><span class="mi">2</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">retval</span><span class="p">[</span><span class="mi">2</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXYGeneric.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXYGeneric.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&gt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">tmax</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parametersPrepared</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parametersPrepared</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">::</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">::</span><span class="mi">2</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knots</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">tmax</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">::</span><span class="mi">2</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knots</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knots</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="p">)</span>
            <span class="n">knotsUnique</span><span class="p">,</span> <span class="n">knotsYUnique</span><span class="o">=</span><span class="n">uniqueFloatValues</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knots</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="o">=</span><span class="n">PchipInterpolator</span><span class="p">(</span><span class="n">knotsUnique</span><span class="p">,</span> <span class="n">knotsYUnique</span><span class="p">)</span>
                <span class="c1"># self.B=InterpolatedUnivariateSpline(knotsUnique, knotsYUnique, k=1)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.tmax&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.nknots&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;self.parameters[1:]&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error en splineXY&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">knots</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="p">,</span> <span class="n">knotsUnique</span><span class="p">,</span> <span class="n">knotsYUnique</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Bug in spline&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parametersPrepared</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
        <span class="n">fraction</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="n">fraction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">fraction</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="c1">#print(&quot;getAg t= %f B(t)= %f fraction= %f Ag= %f&quot;%(t,self.B(t),fraction,self.Amax*(1-fraction)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">fraction</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXYGeneric.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXYGeneric.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="p">)</span>
        <span class="n">retval</span><span class="o">=</span><span class="s2">&quot;D(t) interpolating spline at x=</span><span class="si">%s</span><span class="s2"> and y=</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array2string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knots</span><span class="p">,</span><span class="n">max_line_width</span><span class="o">=</span><span class="mi">10000</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">array2string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">knotsY</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="p">,</span><span class="n">max_line_width</span><span class="o">=</span><span class="mi">10000</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXYGeneric.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXYGeneric.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># https://en.wikipedia.org/wiki/De_Boor%27s_algorithm</span>
        <span class="k">return</span> <span class="s2">&quot;D(t)=interpolating BSpline1 with </span><span class="si">%d</span><span class="s2"> knots distributed until tmax&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXYGeneric.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXYGeneric.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;BSplinesXY with </span><span class="si">%d</span><span class="s2"> knots (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nknots</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXYGeneric.areParametersValid"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXYGeneric.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXY2"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXY2">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSplineXY2</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXY3"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXY3">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSplineXY3</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">3</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXY4"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXY4">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSplineXY4</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">4</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXY5"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXY5">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSplineXY5</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">5</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXY6"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXY6">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSplineXY6</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">6</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXY7"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXY7">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSplineXY7</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">7</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXY8"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXY8">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSplineXY8</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">8</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXY9"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXY9">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSplineXY9</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">9</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelSplineXY10"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelSplineXY10">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelSplineXY10</span><span class="p">(</span><span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BiopharmaceuticsModelSplineXYGeneric</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nknots</span> <span class="o">=</span> <span class="mi">10</span></div>


<div class="viewcode-block" id="BiopharmaceuticsModelNumerical"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelNumerical">[docs]</a><span class="k">class</span> <span class="nc">BiopharmaceuticsModelNumerical</span><span class="p">(</span><span class="n">BiopharmaceuticsModel</span><span class="p">):</span>
<div class="viewcode-block" id="BiopharmaceuticsModelNumerical.setXYValues"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelNumerical.setXYValues">[docs]</a>    <span class="k">def</span> <span class="nf">setXYValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">A</span><span class="p">):</span>
        <span class="c1"># A is the accumulated fraction released</span>
        <span class="n">tUnique</span><span class="p">,</span> <span class="n">Aunique</span> <span class="o">=</span> <span class="n">uniqueFloatValues</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">/</span><span class="mf">100.0</span><span class="p">)</span>
        <span class="c1"># self.B = InterpolatedUnivariateSpline(tUnique, Aunique,k=1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">PchipInterpolator</span><span class="p">(</span><span class="n">tUnique</span><span class="p">,</span> <span class="n">Aunique</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">t</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Numerical source with t and A&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="BiopharmaceuticsModelNumerical.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelNumerical.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelNumerical.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelNumerical.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelNumerical.getAg"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelNumerical.getAg">[docs]</a>    <span class="k">def</span> <span class="nf">getAg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span>
        <span class="n">tToUse</span><span class="o">=</span><span class="n">t</span>
        <span class="k">if</span> <span class="n">t</span><span class="o">&gt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">tmax</span><span class="p">:</span>
            <span class="n">tToUse</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tmax</span>
        <span class="n">fraction</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">tToUse</span><span class="p">)</span>
        <span class="n">fraction</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">fraction</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">Amax</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">fraction</span><span class="p">)</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelNumerical.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelNumerical.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Numerical source with t and A&#39;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelNumerical.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelNumerical.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;Numerical source with t and A&#39;</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelNumerical.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelNumerical.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Numerical source (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="BiopharmaceuticsModelNumerical.areParametersValid"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.BiopharmaceuticsModelNumerical.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div></div>


<div class="viewcode-block" id="PKPDVia"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia">[docs]</a><span class="k">class</span> <span class="nc">PKPDVia</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ptrExperiment</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viaName</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlag</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bioavailability</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paramsUnitsToOptimize</span><span class="o">=</span><span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span> <span class="o">=</span> <span class="n">ptrExperiment</span>

<div class="viewcode-block" id="PKPDVia.parseTokens"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.parseTokens">[docs]</a>    <span class="k">def</span> <span class="nf">parseTokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tokens</span><span class="p">):</span>
        <span class="c1"># Intravenous; iv; [tlag=0 min]; [bioavailability=1]</span>
        <span class="c1"># Oral; ev1; tlag=0 min; bioavailability=1</span>
        <span class="c1"># Default values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tlag</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bioavailability</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="o">.</span><span class="n">getTimeUnits</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span> <span class="o">=</span> <span class="n">PKPDUnit</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>

        <span class="c1"># Get name</span>
        <span class="n">currentToken</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viaName</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">currentToken</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">currentToken</span><span class="o">+=</span><span class="mi">1</span>

        <span class="c1"># Get via</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">currentToken</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">currentToken</span><span class="o">+=</span><span class="mi">1</span>

        <span class="k">while</span> <span class="n">currentToken</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
            <span class="n">optionalTokens</span><span class="o">=</span><span class="n">tokens</span><span class="p">[</span><span class="n">currentToken</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">optionalTokens</span><span class="p">:</span>
                <span class="n">optionalTokens</span><span class="o">=</span><span class="n">optionalTokens</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span>
                <span class="n">optionalVar</span><span class="o">=</span><span class="n">optionalTokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">optionalVar</span><span class="o">==</span><span class="s2">&quot;tlag&quot;</span><span class="p">:</span>
                    <span class="n">optionalTokens</span><span class="o">=</span><span class="n">optionalTokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tlag</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">optionalTokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                    <span class="n">unitString</span> <span class="o">=</span> <span class="n">optionalTokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span> <span class="o">=</span> <span class="n">PKPDUnit</span><span class="p">(</span><span class="n">unitString</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">unit</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unrecognized unit: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">unitString</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">isTime</span><span class="p">():</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Time unit is not valid&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">optionalVar</span><span class="o">==</span><span class="s2">&quot;bioavailability&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">bioavailability</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">optionalTokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">optionalTokens</span><span class="o">=</span><span class="n">optionalTokens</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">optionalTokens</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">optionalTokens</span><span class="o">==</span><span class="s2">&quot;tlag&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">paramsUnitsToOptimize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">optionalTokens</span><span class="o">==</span><span class="s2">&quot;bioavailability&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">paramsUnitsToOptimize</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">)</span>
            <span class="n">currentToken</span><span class="o">+=</span><span class="mi">1</span></div>

    <span class="k">def</span> <span class="nf">_printToStrig</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outStr</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">; &quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">viaName</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;tlag&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span><span class="p">:</span>
            <span class="n">outStr</span><span class="o">+=</span><span class="s2">&quot; tlag min; &quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outStr</span><span class="o">+=</span><span class="s2">&quot;tlag=</span><span class="si">%f</span><span class="s2"> </span><span class="si">%s</span><span class="s2">; &quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tlag</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">_toString</span><span class="p">())</span>
        <span class="k">if</span> <span class="s2">&quot;bioavailability&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span><span class="p">:</span>
            <span class="n">outStr</span><span class="o">+=</span><span class="s2">&quot; bioavailability&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outStr</span><span class="o">+=</span><span class="s2">&quot;bioavailability=</span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">bioavailability</span>
        <span class="k">return</span> <span class="n">outStr</span>

    <span class="k">def</span> <span class="nf">_printToStream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fh</span><span class="p">):</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">_printToStrig</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_printToExcel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wb</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
        <span class="n">excelWriteRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_printToStrig</span><span class="p">(),</span> <span class="n">wb</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">row</span><span class="o">+</span><span class="mi">1</span>

<div class="viewcode-block" id="PKPDVia.prepare"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.prepare">[docs]</a>    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;iv&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;iv-ev1&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelImmediateAndOrder1</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;ev0&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelOrder0</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;ev01&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelOrder01</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;ev0tlag1&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelOrder01Tlag1</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;ev1&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelOrder1</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;ev1x4&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelOrder1Multiple4</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;evFractional&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelOrderFractional</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;ev1-ev1&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelOrder1AndOrder1</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;ev1-ev1Saturable&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelOrder1AndOrder1Saturable</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;doubleWeibull&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelDoubleWeibull</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;tripleWeibull&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelTripleWeibull</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;spline2&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelSpline2</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;spline3&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelSpline3</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;spline4&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelSpline4</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;spline5&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelSpline5</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;spline6&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelSpline6</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;spline7&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelSpline7</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;spline8&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelSpline8</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;spline9&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelSpline9</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;spline10&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelSpline10</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;spline11&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSpline11</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;spline12&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSpline12</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;spline13&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSpline13</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;spline14&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSpline14</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;spline15&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSpline15</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;spline16&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSpline16</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;spline17&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSpline17</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;spline18&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSpline18</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;spline19&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSpline19</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;spline20&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSpline20</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;splineXY2&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSplineXY2</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;splineXY3&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSplineXY3</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;splineXY4&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSplineXY4</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;splineXY5&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSplineXY5</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;splineXY6&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSplineXY6</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;splineXY7&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSplineXY7</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;splineXY8&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSplineXY8</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;splineXY9&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSplineXY9</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;splineXY10&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">=</span> <span class="n">BiopharmaceuticsModelSplineXY10</span><span class="p">()</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">==</span><span class="s2">&quot;numerical&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">=</span><span class="n">BiopharmaceuticsModelNumerical</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">setExperiment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptrExperiment</span><span class="p">)</span></div>

<div class="viewcode-block" id="PKPDVia.changeTimeUnitsToMinutes"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.changeTimeUnitsToMinutes">[docs]</a>    <span class="k">def</span> <span class="nf">changeTimeUnitsToMinutes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">unit</span><span class="o">==</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_TIME_MIN</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">unit</span><span class="o">==</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_TIME_H</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tlag</span> <span class="o">*=</span> <span class="mi">60</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Time for doses must be hours or minutes&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PKPDVia.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;iv&quot;</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="s2">&quot;D=Div(t)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">getEquation</span><span class="p">()</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> (tlag=</span><span class="si">%f</span><span class="s2">, bioavailability=</span><span class="si">%f</span><span class="s2">)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">retval</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tlag</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">bioavailability</span><span class="p">)</span></div>

<div class="viewcode-block" id="PKPDVia.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;iv&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;D=Div(t)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">getModelEquation</span><span class="p">()</span></div>

<div class="viewcode-block" id="PKPDVia.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;iv&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Intravenous dose&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span></div>

<div class="viewcode-block" id="PKPDVia.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">names</span><span class="o">=</span><span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">!=</span> <span class="s2">&quot;iv&quot;</span><span class="p">:</span>
            <span class="n">names</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">getParameterNames</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">viaName</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span></div>

<div class="viewcode-block" id="PKPDVia.getNumberOfParameters"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.getNumberOfParameters">[docs]</a>    <span class="k">def</span> <span class="nf">getNumberOfParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParameterNames</span><span class="p">())</span></div>

<div class="viewcode-block" id="PKPDVia.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;iv&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramsUnitsToOptimize</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramsUnitsToOptimize</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">calculateParameterUnits</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span></div>

<div class="viewcode-block" id="PKPDVia.areParametersSignificant"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">currentIdx</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">paramName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">paramName</span><span class="o">==</span><span class="s2">&quot;tlag&quot;</span><span class="p">:</span>
                    <span class="n">retval</span><span class="o">+=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">lowerBound</span><span class="p">[</span><span class="n">currentIdx</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)]</span>
                <span class="k">elif</span> <span class="n">paramName</span><span class="o">==</span><span class="s2">&quot;bioavailability&quot;</span><span class="p">:</span>
                    <span class="n">retval</span><span class="o">+=</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">upperBound</span><span class="p">[</span><span class="n">currentIdx</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">)]</span>
                <span class="n">currentIdx</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;iv&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">retval</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">retval</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">areParametersSignificant</span><span class="p">(</span><span class="n">lowerBound</span><span class="p">[</span><span class="n">currentIdx</span><span class="p">:],</span> <span class="n">upperBound</span><span class="p">[</span><span class="n">currentIdx</span><span class="p">:])))</span></div>

<div class="viewcode-block" id="PKPDVia.areParametersValid"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="kc">True</span>
        <span class="n">currentIdx</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">paramName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">paramName</span><span class="o">==</span><span class="s2">&quot;tlag&quot;</span><span class="p">:</span>
                    <span class="n">retval</span><span class="o">=</span><span class="n">retval</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="n">currentIdx</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span>
                <span class="k">elif</span> <span class="n">paramName</span><span class="o">==</span><span class="s2">&quot;bioavailability&quot;</span><span class="p">:</span>
                    <span class="n">retval</span><span class="o">=</span><span class="n">retval</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="n">currentIdx</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="n">currentIdx</span><span class="p">]</span><span class="o">&lt;=</span><span class="mi">1</span>
                <span class="n">currentIdx</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">==</span> <span class="s2">&quot;iv&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">retval</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">retval</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">areParametersValid</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">currentIdx</span><span class="p">:])</span></div>

<div class="viewcode-block" id="PKPDVia.setParameters"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDVia.setParameters">[docs]</a>    <span class="k">def</span> <span class="nf">setParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="n">currentIdx</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">paramName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">paramName</span><span class="o">==</span><span class="s2">&quot;tlag&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tlag</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="n">currentIdx</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">paramName</span><span class="o">==</span><span class="s2">&quot;bioavailability&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">bioavailability</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="n">currentIdx</span><span class="p">]</span>
                <span class="n">currentIdx</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">!=</span> <span class="s2">&quot;iv&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">currentIdx</span><span class="p">:])</span></div></div>

<div class="viewcode-block" id="createVia"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.createVia">[docs]</a><span class="k">def</span> <span class="nf">createVia</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">ptrExperiment</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">via</span> <span class="o">=</span> <span class="n">PKPDVia</span><span class="p">(</span><span class="n">ptrExperiment</span><span class="p">)</span>
    <span class="n">via</span><span class="o">.</span><span class="n">parseTokens</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">))</span>
    <span class="n">via</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">via</span></div>

<div class="viewcode-block" id="PKPDDose"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose">[docs]</a><span class="k">class</span> <span class="nc">PKPDDose</span><span class="p">:</span>
    <span class="n">TYPE_BOLUS</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">TYPE_REPEATED_BOLUS</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">TYPE_INFUSION</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doseName</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">via</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doseAmount</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tF</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">every</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dunits</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paramsToOptimize</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">paramsUnitsToOptimize</span><span class="o">=</span><span class="p">[]</span>

<div class="viewcode-block" id="PKPDDose.parseTokens"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.parseTokens">[docs]</a>    <span class="k">def</span> <span class="nf">parseTokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">tokens</span><span class="p">,</span><span class="n">vias</span><span class="p">):</span>
        <span class="c1"># Dose1; via=Intravenous; bolus; t=0 min; d=60*$(weight)/1000 mg</span>
        <span class="c1"># Dose1; via=Oral; repeated_bolus; t=0:8:48 h; d=60*$(weight)/1000 mg</span>
        <span class="c1"># Dose1; via=Intravenous; infusion; t=0:59 min; d=1 mg/min</span>

        <span class="c1"># Get name</span>
        <span class="n">currentToken</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doseName</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">currentToken</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">currentToken</span><span class="o">+=</span><span class="mi">1</span>

        <span class="c1"># Get via</span>
        <span class="n">viaName</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">currentToken</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">viaName</span> <span class="ow">in</span> <span class="n">vias</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">=</span><span class="n">vias</span><span class="p">[</span><span class="n">viaName</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unrecognized via </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">viaName</span><span class="p">)</span>
        <span class="n">currentToken</span><span class="o">+=</span><span class="mi">1</span>

        <span class="c1"># Get type</span>
        <span class="n">doseTypeString</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">currentToken</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">doseTypeString</span><span class="o">==</span><span class="s2">&quot;bolus&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">=</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_BOLUS</span>
        <span class="k">elif</span> <span class="n">doseTypeString</span><span class="o">==</span><span class="s2">&quot;repeated_bolus&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">=</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_REPEATED_BOLUS</span>
        <span class="k">elif</span> <span class="n">doseTypeString</span><span class="o">==</span><span class="s2">&quot;infusion&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">=</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_INFUSION</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unrecognized dose type </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">doseTypeString</span><span class="p">)</span>
        <span class="n">currentToken</span><span class="o">+=</span><span class="mi">1</span>

        <span class="c1"># Get time description</span>
        <span class="n">timeUnitsString</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">currentToken</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">timeTokens</span><span class="o">=</span><span class="n">timeUnitsString</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">timeTokens</span><span class="p">)</span><span class="o">!=</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Time description is badly formed </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">timeUnitsString</span><span class="p">)</span>
        <span class="n">timeString</span> <span class="o">=</span> <span class="n">timeTokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">unitString</span> <span class="o">=</span> <span class="n">timeTokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">doseTypeString</span><span class="o">==</span><span class="s2">&quot;bolus&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">timeString</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">doseTypeString</span><span class="o">==</span><span class="s2">&quot;repeated_bolus&quot;</span><span class="p">:</span>
            <span class="n">timeTokens</span> <span class="o">=</span> <span class="n">timeString</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">timeTokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">every</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">timeTokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tF</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">timeTokens</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">doseTypeString</span><span class="o">==</span><span class="s2">&quot;infusion&quot;</span><span class="p">:</span>
            <span class="n">timeTokens</span> <span class="o">=</span> <span class="n">timeString</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">timeTokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tF</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">timeTokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unrecognized dose type </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">doseTypeString</span><span class="p">)</span>

        <span class="c1"># Get time units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span> <span class="o">=</span> <span class="n">PKPDUnit</span><span class="p">(</span><span class="n">unitString</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">unit</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unrecognized unit: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">unitString</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">isTime</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Time unit is not valid&quot;</span><span class="p">)</span>
        <span class="n">currentToken</span><span class="o">+=</span><span class="mi">1</span>

        <span class="c1"># Get dose units</span>
        <span class="n">doseUnitsString</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">currentToken</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">doseTokens</span><span class="o">=</span><span class="n">doseUnitsString</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">doseTokens</span><span class="p">)</span><span class="o">!=</span><span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Dose description is badly formed </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">doseUnitsString</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">doseAmount</span> <span class="o">=</span> <span class="n">doseTokens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">unitString</span> <span class="o">=</span> <span class="n">doseTokens</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dunits</span> <span class="o">=</span> <span class="n">PKPDUnit</span><span class="p">(</span><span class="n">unitString</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dunits</span><span class="o">.</span><span class="n">unit</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unrecognized unit: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">unitString</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">doseTypeString</span><span class="o">==</span><span class="s2">&quot;infusion&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dunits</span><span class="o">.</span><span class="n">isWeightInvTime</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;After normalization, the dose must be a weight/time (=rate)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dunits</span><span class="o">.</span><span class="n">isWeight</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;After normalization, the dose must be a weight&quot;</span><span class="p">)</span>
        <span class="n">currentToken</span><span class="o">+=</span><span class="mi">1</span></div>

    <span class="k">def</span> <span class="nf">_printToStream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fh</span><span class="p">):</span>
        <span class="n">outStr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">doseName</span><span class="o">+</span><span class="s2">&quot;; &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">getDoseString2</span><span class="p">()</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">outStr</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_printToExcel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wb</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
        <span class="n">outStr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">doseName</span><span class="o">+</span><span class="s2">&quot;; &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">getDoseString2</span><span class="p">()</span>
        <span class="n">excelWriteRow</span><span class="p">(</span><span class="n">outStr</span><span class="p">,</span><span class="n">wb</span><span class="p">,</span><span class="n">row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">row</span><span class="o">+</span><span class="mi">1</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDoseString2</span><span class="p">()</span>

<div class="viewcode-block" id="PKPDDose.getDoseString"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.getDoseString">[docs]</a>    <span class="k">def</span> <span class="nf">getDoseString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_BOLUS</span><span class="p">:</span>
            <span class="n">doseString</span> <span class="o">=</span> <span class="s2">&quot;bolus; t=</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_REPEATED_BOLUS</span><span class="p">:</span>
            <span class="n">doseString</span> <span class="o">=</span> <span class="s2">&quot;repeated_bolus; t=</span><span class="si">%f</span><span class="s2">:</span><span class="si">%f</span><span class="s2">:</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">every</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tF</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_INFUSION</span><span class="p">:</span>
            <span class="n">doseString</span> <span class="o">=</span> <span class="s2">&quot;infusion; t=</span><span class="si">%f</span><span class="s2">:</span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tF</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">doseString</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">return</span> <span class="n">doseString</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">_toString</span><span class="p">()</span></div>

<div class="viewcode-block" id="PKPDDose.getDoseString2"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.getDoseString2">[docs]</a>    <span class="k">def</span> <span class="nf">getDoseString2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">outStr</span><span class="o">=</span><span class="s2">&quot;via=</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">; d=</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">viaName</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">getDoseString</span><span class="p">(),</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">doseAmount</span><span class="p">,</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">dunits</span><span class="o">.</span><span class="n">_toString</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">outStr</span></div>

<div class="viewcode-block" id="PKPDDose.changeTimeUnitsTo"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.changeTimeUnitsTo">[docs]</a>    <span class="k">def</span> <span class="nf">changeTimeUnitsTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">targetUnit</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">targetUnit</span><span class="o">==</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_TIME_MIN</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">unit</span><span class="o">==</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_TIME_MIN</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">unit</span><span class="o">==</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_TIME_H</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_BOLUS</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">*=</span> <span class="mi">60</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_REPEATED_BOLUS</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">*=</span> <span class="mi">60</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tF</span> <span class="o">*=</span> <span class="mi">60</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">every</span> <span class="o">*=</span> <span class="mi">60</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_INFUSION</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">*=</span> <span class="mi">60</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tF</span> <span class="o">*=</span> <span class="mi">60</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Time for doses must be hours or minutes&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">targetUnit</span><span class="o">==</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_TIME_H</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">unit</span><span class="o">==</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_TIME_H</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">unit</span><span class="o">==</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_TIME_MIN</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_BOLUS</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">/=</span> <span class="mi">60</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_REPEATED_BOLUS</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">/=</span> <span class="mi">60</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tF</span> <span class="o">/=</span> <span class="mi">60</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">every</span> <span class="o">/=</span> <span class="mi">60</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_INFUSION</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">/=</span> <span class="mi">60</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">tF</span> <span class="o">/=</span> <span class="mi">60</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Time for doses must be hours or minutes&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Target time unit must be hours or minutes&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PKPDDose.prepare"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.prepare">[docs]</a>    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">prepare</span><span class="p">()</span></div>

<div class="viewcode-block" id="PKPDDose.getDoseAt"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.getDoseAt">[docs]</a>    <span class="k">def</span> <span class="nf">getDoseAt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dose between t0&lt;=t&lt;t0+dt, t0 is in the units of the dose&quot;&quot;&quot;</span>
        <span class="n">t0</span><span class="o">-=</span><span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">tlag</span>
        <span class="n">t1</span><span class="o">=</span><span class="n">t0</span><span class="o">+</span><span class="n">dt</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">tlag</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_BOLUS</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t0</span><span class="o">&lt;=</span><span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="o">&lt;</span><span class="n">t1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseAmount</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_REPEATED_BOLUS</span><span class="p">:</span>
            <span class="n">doseAmount</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tF</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">every</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">t0</span><span class="o">&lt;=</span><span class="n">t</span> <span class="ow">and</span> <span class="n">t</span><span class="o">&lt;</span><span class="n">t1</span><span class="p">:</span>
                    <span class="n">doseAmount</span><span class="o">+=</span><span class="bp">self</span><span class="o">.</span><span class="n">doseAmount</span>
            <span class="k">return</span> <span class="n">doseAmount</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_INFUSION</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">t0</span><span class="o">&gt;</span><span class="bp">self</span><span class="o">.</span><span class="n">tF</span> <span class="ow">or</span> <span class="n">t1</span><span class="o">&lt;</span><span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="p">:</span>
                <span class="k">return</span> <span class="mf">0.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tLeft</span><span class="o">=</span><span class="nb">max</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="p">)</span>
                <span class="n">tRight</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">tF</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseAmount</span><span class="o">*</span><span class="p">(</span><span class="n">tRight</span><span class="o">-</span><span class="n">tLeft</span><span class="p">)</span></div>

<div class="viewcode-block" id="PKPDDose.getAmountReleasedAt"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.getAmountReleasedAt">[docs]</a>    <span class="k">def</span> <span class="nf">getAmountReleasedAt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="n">doseAmount</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">doseAmount</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDoseAt</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span><span class="o">!=</span><span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_INFUSION</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">Amax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">bioavailability</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">doseAmount</span>
                <span class="n">doseAmount</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">getAg</span><span class="p">(</span><span class="n">t0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">tlag</span><span class="p">)</span><span class="o">-</span>\
                              <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">getAg</span><span class="p">(</span><span class="n">t0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">tlag</span><span class="o">+</span><span class="n">dt</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">doseAmount</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDoseAt</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">doseAmount</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">doseAmount</span><span class="o">=</span><span class="mi">0</span>
        <span class="c1"># print(&quot;t0=%f self.t0=%f self.tlag=%f self.dt=%f -&gt; released=%f&quot;%(t0,self.t0,self.via.tlag,dt,doseAmount))</span>
        <span class="k">return</span> <span class="n">doseAmount</span></div>

<div class="viewcode-block" id="PKPDDose.getAmountReleasedUpTo"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.getAmountReleasedUpTo">[docs]</a>    <span class="k">def</span> <span class="nf">getAmountReleasedUpTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t0</span><span class="p">):</span>
        <span class="n">doseAmount</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">viaProfile</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">doseAmount</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDoseAt</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="n">t0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span><span class="o">!=</span><span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_INFUSION</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">Amax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">bioavailability</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">doseAmount</span>
                <span class="n">doseAmount</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">getAg</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span><span class="o">-</span>\
                              <span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">viaProfile</span><span class="o">.</span><span class="n">getAg</span><span class="p">(</span><span class="n">t0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">t0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">tlag</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">doseAmount</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getDoseAt</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">t0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">doseAmount</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">doseAmount</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">return</span> <span class="n">doseAmount</span></div>

<div class="viewcode-block" id="PKPDDose.isDoseABolus"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.isDoseABolus">[docs]</a>    <span class="k">def</span> <span class="nf">isDoseABolus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doseType</span> <span class="o">!=</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_BOLUS</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t0</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="PKPDDose.getTUnitsString"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.getTUnitsString">[docs]</a>    <span class="k">def</span> <span class="nf">getTUnitsString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tunits</span><span class="o">.</span><span class="n">_toString</span><span class="p">()</span></div>

<div class="viewcode-block" id="PKPDDose.getDUnitsString"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.getDUnitsString">[docs]</a>    <span class="k">def</span> <span class="nf">getDUnitsString</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dunits</span><span class="o">.</span><span class="n">_toString</span><span class="p">()</span></div>

<div class="viewcode-block" id="PKPDDose.getDoseUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.PKPDDose.getDoseUnits">[docs]</a>    <span class="k">def</span> <span class="nf">getDoseUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dunits</span></div></div>


<div class="viewcode-block" id="createDeltaDose"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.createDeltaDose">[docs]</a><span class="k">def</span> <span class="nf">createDeltaDose</span><span class="p">(</span><span class="n">doseAmount</span><span class="p">,</span><span class="n">via</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">dunits</span><span class="o">=</span><span class="s2">&quot;mg&quot;</span><span class="p">):</span>
    <span class="n">dose</span> <span class="o">=</span> <span class="n">PKPDDose</span><span class="p">()</span>
    <span class="n">dose</span><span class="o">.</span><span class="n">doseName</span> <span class="o">=</span> <span class="s2">&quot;Bolus&quot;</span>
    <span class="n">dose</span><span class="o">.</span><span class="n">doseType</span> <span class="o">=</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_BOLUS</span>
    <span class="n">dose</span><span class="o">.</span><span class="n">doseAmount</span> <span class="o">=</span> <span class="n">doseAmount</span>
    <span class="n">dose</span><span class="o">.</span><span class="n">via</span> <span class="o">=</span> <span class="n">via</span>
    <span class="n">dose</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">t</span>
    <span class="n">dose</span><span class="o">.</span><span class="n">tunits</span> <span class="o">=</span> <span class="n">PKPDUnit</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
    <span class="n">dose</span><span class="o">.</span><span class="n">dunits</span> <span class="o">=</span> <span class="n">PKPDUnit</span><span class="p">(</span><span class="n">dunits</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dose</span></div>


<div class="viewcode-block" id="DrugSource"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource">[docs]</a><span class="k">class</span> <span class="nc">DrugSource</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parsedDoseList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterNames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vias</span> <span class="o">=</span> <span class="p">[]</span>

<div class="viewcode-block" id="DrugSource.setDoses"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.setDoses">[docs]</a>    <span class="k">def</span> <span class="nf">setDoses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parsedDoseList</span><span class="p">,</span> <span class="n">t0</span><span class="p">,</span> <span class="n">tF</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">originalDoseList</span> <span class="o">=</span> <span class="n">parsedDoseList</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parsedDoseList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">collectedVias</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterNames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vias</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dose</span> <span class="ow">in</span> <span class="n">parsedDoseList</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dose</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_BOLUS</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parsedDoseList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dose</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">dose</span><span class="o">.</span><span class="n">doseType</span> <span class="o">==</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_INFUSION</span><span class="p">:</span>
                <span class="n">newDose</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dose</span><span class="p">)</span>
                <span class="n">newDose</span><span class="o">.</span><span class="n">dunits</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dose</span><span class="o">.</span><span class="n">dunits</span><span class="p">)</span>
                <span class="n">newDose</span><span class="o">.</span><span class="n">dunits</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">changeRateToWeight</span><span class="p">(</span><span class="n">dose</span><span class="o">.</span><span class="n">dunits</span><span class="o">.</span><span class="n">unit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parsedDoseList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newDose</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">dose</span><span class="o">.</span><span class="n">t0</span><span class="p">,</span><span class="n">dose</span><span class="o">.</span><span class="n">tF</span><span class="p">,</span><span class="n">dose</span><span class="o">.</span><span class="n">every</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">t0</span><span class="o">&lt;=</span><span class="n">t</span> <span class="ow">and</span> <span class="n">t</span><span class="o">&lt;=</span><span class="n">tF</span><span class="p">:</span>
                        <span class="n">newDose</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dose</span><span class="p">)</span>
                        <span class="n">newDose</span><span class="o">.</span><span class="n">doseType</span> <span class="o">=</span> <span class="n">PKPDDose</span><span class="o">.</span><span class="n">TYPE_BOLUS</span>
                        <span class="n">newDose</span><span class="o">.</span><span class="n">t0</span> <span class="o">=</span> <span class="n">t</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">parsedDoseList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newDose</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">dose</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">viaName</span> <span class="ow">in</span> <span class="n">collectedVias</span><span class="p">:</span>
                <span class="n">collectedVias</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dose</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">viaName</span><span class="p">)</span>
                <span class="n">viaParameterNames</span> <span class="o">=</span> <span class="n">dose</span><span class="o">.</span><span class="n">via</span><span class="o">.</span><span class="n">getParameterNames</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parameterNames</span> <span class="o">+=</span> <span class="n">viaParameterNames</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vias</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">dose</span><span class="o">.</span><span class="n">via</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">viaParameterNames</span><span class="p">)))</span></div>

<div class="viewcode-block" id="DrugSource.getDoseUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.getDoseUnits">[docs]</a>    <span class="k">def</span> <span class="nf">getDoseUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parsedDoseList</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsedDoseList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getDoseUnits</span><span class="p">()</span></div>

<div class="viewcode-block" id="DrugSource.getAmountReleasedAt"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.getAmountReleasedAt">[docs]</a>    <span class="k">def</span> <span class="nf">getAmountReleasedAt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t0</span><span class="p">,</span><span class="n">dt</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="n">doseAmount</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">dose</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsedDoseList</span><span class="p">:</span>
            <span class="n">doseAmount</span><span class="o">+=</span><span class="n">dose</span><span class="o">.</span><span class="n">getAmountReleasedAt</span><span class="p">(</span><span class="n">t0</span><span class="p">,</span><span class="n">dt</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">doseAmount</span></div>

<div class="viewcode-block" id="DrugSource.getAmountReleasedUpTo"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.getAmountReleasedUpTo">[docs]</a>    <span class="k">def</span> <span class="nf">getAmountReleasedUpTo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t0</span><span class="p">):</span>
        <span class="n">doseAmount</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">dose</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parsedDoseList</span><span class="p">:</span>
            <span class="n">doseAmount</span><span class="o">+=</span><span class="n">dose</span><span class="o">.</span><span class="n">getAmountReleasedUpTo</span><span class="p">(</span><span class="n">t0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">doseAmount</span></div>

<div class="viewcode-block" id="DrugSource.getEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">via</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vias</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">+=</span><span class="n">via</span><span class="o">.</span><span class="n">getEquation</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; &quot;</span>
        <span class="k">return</span> <span class="n">retval</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span></div>

<div class="viewcode-block" id="DrugSource.getModelEquation"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">via</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vias</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">+=</span><span class="n">via</span><span class="o">.</span><span class="n">getModelEquation</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; &quot;</span>
        <span class="k">return</span> <span class="n">retval</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span></div>

<div class="viewcode-block" id="DrugSource.getDescription"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">via</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vias</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">+=</span><span class="n">via</span><span class="o">.</span><span class="n">getDescription</span><span class="p">()</span><span class="o">+</span><span class="s2">&quot; &quot;</span>
        <span class="k">return</span> <span class="n">retval</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span></div>

<div class="viewcode-block" id="DrugSource.getParameterNames"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterNames</span></div>

<div class="viewcode-block" id="DrugSource.getNumberOfParameters"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.getNumberOfParameters">[docs]</a>    <span class="k">def</span> <span class="nf">getNumberOfParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getParameterNames</span><span class="p">())</span></div>

<div class="viewcode-block" id="DrugSource.calculateParameterUnits"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">via</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vias</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">+=</span><span class="n">via</span><span class="o">.</span><span class="n">calculateParameterUnits</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="o">=</span><span class="n">retval</span>
            <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="DrugSource.areParametersSignificant"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">currentToken</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">via</span><span class="p">,</span> <span class="n">viaPrmNo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vias</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">+=</span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">via</span><span class="o">.</span><span class="n">areParametersSignificant</span><span class="p">(</span><span class="n">lowerBound</span><span class="p">[</span><span class="n">currentToken</span><span class="p">:(</span><span class="n">currentToken</span><span class="o">+</span><span class="n">viaPrmNo</span><span class="p">)],</span>
                                                             <span class="n">upperBound</span><span class="p">[</span><span class="n">currentToken</span><span class="p">:(</span><span class="n">currentToken</span><span class="o">+</span><span class="n">viaPrmNo</span><span class="p">)])]</span>
            <span class="n">currentToken</span><span class="o">+=</span><span class="n">viaPrmNo</span>
        <span class="k">if</span> <span class="n">retval</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">retval</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="DrugSource.areParametersValid"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">currentToken</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">via</span><span class="p">,</span><span class="n">viaPrmNo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vias</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">=</span><span class="n">retval</span> <span class="ow">and</span> <span class="n">via</span><span class="o">.</span><span class="n">areParametersValid</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">currentToken</span><span class="p">:</span><span class="n">currentToken</span><span class="o">+</span><span class="n">viaPrmNo</span><span class="p">])</span>
            <span class="n">currentToken</span><span class="o">+=</span><span class="n">viaPrmNo</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="DrugSource.setParameters"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.setParameters">[docs]</a>    <span class="k">def</span> <span class="nf">setParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="n">currentToken</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">via</span><span class="p">,</span><span class="n">viaPrmNo</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vias</span><span class="p">:</span>
            <span class="n">via</span><span class="o">.</span><span class="n">setParameters</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">currentToken</span><span class="p">:</span><span class="n">currentToken</span><span class="o">+</span><span class="n">viaPrmNo</span><span class="p">])</span>
            <span class="n">currentToken</span><span class="o">+=</span><span class="n">viaPrmNo</span></div>

<div class="viewcode-block" id="DrugSource.getVia"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.getVia">[docs]</a>    <span class="k">def</span> <span class="nf">getVia</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vias</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># Only the first one is accessible through this function</span></div>

<div class="viewcode-block" id="DrugSource.getDprofile"><a class="viewcode-back" href="../../api/pkpd/pkpd.biopharmaceutics.html#pkpd.biopharmaceutics.DrugSource.getDprofile">[docs]</a>    <span class="k">def</span> <span class="nf">getDprofile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
        <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">Nsamples</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">Nsamples</span><span class="p">)</span><span class="o">==</span><span class="nb">tuple</span><span class="p">:</span>
            <span class="n">Nsamples</span><span class="o">=</span><span class="n">Nsamples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">Nsamples</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getAmountReleasedAt</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">D</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: release-3.0.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../dependabot_pip_jinja2-2.10.1/index.html">dependabot/pip/jinja2-2.10.1</a></dd>
            <dd><a href="../../../gh-pages/index.html">gh-pages</a></dd>
            <dd><a href="../../../release-2.0.0/index.html">release-2.0.0</a></dd>
            <dd><a href="biopharmaceutics.html">release-3.0.0</a></dd>
            <dd><a href="../../../rsanchezgarc-patch-1/index.html">rsanchezgarc-patch-1</a></dd>
            <dd><a href="../../../vtune/index.html">vtune</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>