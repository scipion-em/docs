

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>phenix.viewers.viewer_validation_cryoem &mdash; Scipion 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/scipion-modes/how-to-install.html">Installing Scipion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/scipion-modes/host-configuration.html">Host configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/user-documentation.html#tutorials">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/user-documentation.html#processing-how-to-s">Processing How Toâ€™s</a></li>
</ul>
<p class="caption"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/facilities/facilities.html">On-the-fly processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/facilities/customize-report.html">Summary Reports</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/api/scipion-API.html">Scipion API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/api/plugins-API.html">Plugins API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/api/xmipp-API.html">Xmipp API</a></li>
</ul>
<p class="caption"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/misc/contact-us.html">Contact Us</a></li>
</ul>
<p class="caption"><span class="caption-text">Licences</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/license.html">Licenses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../phenix.html">phenix</a> &raquo;</li>
        
      <li>phenix.viewers.viewer_validation_cryoem</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for phenix.viewers.viewer_validation_cryoem</h1><div class="highlight"><pre>
<span></span><span class="c1"># *</span>
<span class="c1"># * Authors:     Roberto Marabini</span>
<span class="c1"># *              Marta Martinez</span>
<span class="c1"># *</span>
<span class="c1"># * Unidad de  Bioinformatica of Centro Nacional de Biotecnologia , CSIC</span>
<span class="c1"># *</span>
<span class="c1"># * This program is free software; you can redistribute it and/or modify</span>
<span class="c1"># * it under the terms of the GNU General Public License as published by</span>
<span class="c1"># * the Free Software Foundation; either version 2 of the License, or</span>
<span class="c1"># * (at your option) any later version.</span>
<span class="c1"># *</span>
<span class="c1"># * This program is distributed in the hope that it will be useful,</span>
<span class="c1"># * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># * GNU General Public License for more details.</span>
<span class="c1"># *</span>
<span class="c1"># * You should have received a copy of the GNU General Public License</span>
<span class="c1"># * along with this program; if not, write to the Free Software</span>
<span class="c1"># * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA</span>
<span class="c1"># * 02111-1307  USA</span>
<span class="c1"># *</span>
<span class="c1"># *  All comments concerning this program package may be sent to the</span>
<span class="c1"># *  e-mail address &#39;scipion@cnb.csic.es&#39;</span>
<span class="c1"># *</span>
<span class="c1"># **************************************************************************</span>

<span class="kn">from</span> <span class="nn">phenix.protocols.protocol_validation_cryoem</span> <span class="kn">import</span> <span class="n">PhenixProtRunValidationCryoEM</span>
<span class="kn">from</span> <span class="nn">.viewer_refinement_base</span> <span class="kn">import</span> <span class="n">PhenixProtRefinementBaseViewer</span>
<span class="kn">from</span> <span class="nn">pyworkflow.protocol.params</span> <span class="kn">import</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">EnumParam</span>
<span class="kn">from</span> <span class="nn">phenix</span> <span class="kn">import</span> <span class="n">Plugin</span><span class="p">,</span> <span class="n">PHENIXVERSION</span><span class="p">,</span> <span class="n">PHENIXVERSION18</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.font_manager</span>
<span class="kn">from</span> <span class="nn">phenix</span> <span class="kn">import</span> <span class="n">Plugin</span>
<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">json</span>


<div class="viewcode-block" id="PhenixProtRunValidationCryoEMViewer"><a class="viewcode-back" href="../../../api/phenix/phenix.viewers.viewer_validation_cryoem.html#phenix.viewers.viewer_validation_cryoem.PhenixProtRunValidationCryoEMViewer">[docs]</a><span class="k">class</span> <span class="nc">PhenixProtRunValidationCryoEMViewer</span><span class="p">(</span><span class="n">PhenixProtRefinementBaseViewer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Viewer for Phenix program validation cryoEM</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_label</span> <span class="o">=</span> <span class="s1">&#39;Validation cryoEM viewer&#39;</span>
    <span class="n">_targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">PhenixProtRunValidationCryoEM</span><span class="p">]</span>

    <span class="n">VALIDATIONTMPFILE</span> <span class="o">=</span> <span class="s1">&#39;tmpValidationFile.txt&#39;</span>
    <span class="n">CLASHESFILE</span> <span class="o">=</span> <span class="s1">&#39;tmpClashesFile.py&#39;</span>
    <span class="n">CCCHAINFILE</span> <span class="o">=</span> <span class="s2">&quot;ccPerChain.py&quot;</span>
    <span class="n">CCCHAINFILE2</span> <span class="o">=</span> <span class="s2">&quot;ccPerChain.txt&quot;</span>
    <span class="n">CCRESIDUESFILE</span> <span class="o">=</span> <span class="s2">&quot;ccPerResidue.py&quot;</span>
    <span class="n">CCRESIDUESFILE2</span> <span class="o">=</span> <span class="s2">&quot;ccPerResidue.txt&quot;</span>
    <span class="n">FSCMODELMAPFILE</span> <span class="o">=</span> <span class="s2">&quot;FscModelMap.txt&quot;</span>
    <span class="n">FSCHALFMAPFILE</span> <span class="o">=</span> <span class="s2">&quot;FscHalfMap.txt&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
         <span class="n">PhenixProtRefinementBaseViewer</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">!=</span> <span class="n">PHENIXVERSION</span><span class="p">:</span>
            <span class="c1"># VALIDATIONCRYOEMFILE = self.protocol._getExtraPath(</span>
            <span class="c1">#     self.protocol.VALIDATIONCRYOEMFILE)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">VALIDATIONCRYOEMPKLFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">VALIDATIONCRYOEMPKLFILE</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_writePickleData2</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">,</span>
                                  <span class="n">object_pairs_hook</span><span class="o">=</span><span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_defineParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">!=</span> <span class="n">PHENIXVERSION</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputVolume</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> \
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputStructure</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">getVolume</span><span class="p">())</span> \
                    <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputVolume</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputVolume</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputStructure</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">getVolume</span><span class="p">()</span>
            <span class="n">PhenixProtRefinementBaseViewer</span><span class="o">.</span><span class="n">_defineParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">)</span>
            <span class="n">form</span><span class="o">.</span><span class="n">addSection</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Summary&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Model&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showModelSummary&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Model Summary Table&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Model: Atomic structure.&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showDataSummary&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Data Summary Table&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Data: 3D map obtained by cryo-EM.&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Model vs. Data&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showModelVsDataSummary&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Model vs Data Summary Table&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Real space correlation values between 3D map and model.&quot;</span><span class="p">)</span>

            <span class="n">form</span><span class="o">.</span><span class="n">addSection</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;MolProbity&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Clashes_n_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Clashes: All-atom contact analysis&#39;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showClashes2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                               <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Bad contacts from PROBE (list)&quot;</span><span class="p">,</span>
                               <span class="n">help</span> <span class="o">=</span> <span class="s2">&quot;This list summarizes all severe clashes &quot;</span>
                               <span class="s2">&quot;(more than 0.4 Angstroms non-H-bond &quot;</span>
                               <span class="s2">&quot;overlap) found by PROBE; you can view &quot;</span>
                               <span class="s2">&quot;these graphically in Coot. If no &quot;</span>
                               <span class="s2">&quot;hydrogens were present, REDUCE was &quot;</span>
                               <span class="s2">&quot;used to add them prior to running &quot;</span>
                               <span class="s2">&quot;PROBE.&quot;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;exportFiles1&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                               <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Save list as text&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoClashes2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                               <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;No bad contacts (&gt; 0.4 Angstroms &quot;</span>
                                       <span class="s2">&quot;overlap) found.&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;CaBLAM&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CaBLAM_outliers_n&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCaBLAM&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                               <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;CaBLAM evaluation&#39;</span><span class="p">,</span>
                               <span class="n">help</span> <span class="o">=</span> <span class="s1">&#39;C-based low-resolution annotation method&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoCaBLAM&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No CaBLAM outliers found.&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;C-beta deviation analysis&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Cbeta_Outliers_n&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCbetaOutliersTable2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;C-beta Outliers&#39;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s2">&quot;C-beta position outliers (position &quot;</span>
                                         <span class="s2">&quot;deviates from ideal by more than &quot;</span>
                                         <span class="s2">&quot;0.25A).</span><span class="se">\n\n</span><span class="s2">Ideal CB position is &quot;</span>
                                         <span class="s2">&quot;determined from the average of the &quot;</span>
                                         <span class="s2">&quot;ideal C-N-CA-CB and N-C-CA-CB dihedrals.&quot;</span>
                                         <span class="s2">&quot; This measure is more sensitive than&quot;</span>
                                         <span class="s2">&quot; individual measures to both sidechain &quot;</span>
                                         <span class="s2">&quot;and mainchain misfittings.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoCbetaOutliers2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No C-beta position outliers detected&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s2">&quot;C-beta position outliers (position &quot;</span>
                                         <span class="s2">&quot;deviates from ideal by more than &quot;</span>
                                         <span class="s2">&quot;0.25A).</span><span class="se">\n\n</span><span class="s2">Ideal CB position is &quot;</span>
                                         <span class="s2">&quot;determined from the average of the &quot;</span>
                                         <span class="s2">&quot;ideal C-N-CA-CB and N-C-CA-CB dihedrals.&quot;</span>
                                         <span class="s2">&quot; This measure is more sensitive than&quot;</span>
                                         <span class="s2">&quot; individual measures to both sidechain &quot;</span>
                                         <span class="s2">&quot;and mainchain misfittings.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Cis and twisted peptides&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Omega_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCisAndTwistedPeptides2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Cis and Twisted peptides:&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Cis conformations are observed in &quot;</span>
                                         <span class="s2">&quot;about 5</span><span class="si">% o</span><span class="s2">f Prolines.</span><span class="se">\n\n</span><span class="s2">Cis &quot;</span>
                                         <span class="s2">&quot;conformations are observed in about &quot;</span>
                                         <span class="s2">&quot;0.03</span><span class="si">% o</span><span class="s2">f general residues.</span><span class="se">\n\n</span><span class="s2">Twisted &quot;</span>
                                         <span class="s2">&quot;peptides are almost certainly &quot;</span>
                                         <span class="s2">&quot;modeling errors.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoNonTransPeptides2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No non-trans peptides detected&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Cis conformations are observed in &quot;</span>
                                        <span class="s2">&quot;about 5</span><span class="si">% o</span><span class="s2">f Prolines.</span><span class="se">\n\n</span><span class="s2">Cis &quot;</span>
                                        <span class="s2">&quot;conformations are observed in about &quot;</span>
                                        <span class="s2">&quot;0.03</span><span class="si">% o</span><span class="s2">f general residues.</span><span class="se">\n\n</span><span class="s2">Twisted &quot;</span>
                                        <span class="s2">&quot;peptides are almost certainly &quot;</span>
                                        <span class="s2">&quot;modeling errors.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Rotamers&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rota_Outliers_n&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showRotaOutliersTable2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Rotamer outlier list&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Although a residue may lie in the &quot;</span>
                                     <span class="s2">&quot;favored regions of the Chi1-Chi2 plot, &quot;</span>
                                     <span class="s2">&quot;outliers are flagged based on the &quot;</span>
                                     <span class="s2">&quot;distribution of all non-branched Chi &quot;</span>
                                     <span class="s2">&quot;angles in a residue.</span><span class="se">\n</span><span class="s2">Zero outliers is &quot;</span>
                                     <span class="s2">&quot;not the goal. Rotamer outliers can be  &quot;</span>
                                     <span class="s2">&quot;justified by sufficiently strong &quot;</span> \
                                     <span class="s2">&quot;electron density, van der Waals &quot;</span>
                                     <span class="s2">&quot;packing, and/or hydrogen bonds.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoRotaOutliers2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No Rotamer outliers detected&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;displayPlotRota&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Chi1-Chi2 graphs&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Visualization of Rotamer outliers in Chi1-Chi2 plots.&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Rhamachandran&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rhama_Outliers_n&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showRhamaOutliersTable2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Rhamachandran outlier list&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Ramachandran outliers are those aminoacids&quot;</span>
                                         <span class="s2">&quot; with non-favourable dihedral angles. &quot;</span>
                                         <span class="s2">&quot;Most of the time, Ramachandran outliers are &quot;</span>
                                         <span class="s2">&quot;a consequence of mistakes during the data &quot;</span>
                                         <span class="s2">&quot;processing.&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoRamaOutliers2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No Rhamachandran outliers detected&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;displayPlotRhama&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Rhamachandran graphs&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Visualization of outliers in Rhamachandran graphs.&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Geometry Restraints&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showHelp&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;This section reports statistics for geometry restraints &quot;</span>
                                <span class="s2">&quot;used in refinement. As a general rule, a fully refined &quot;</span>
                                <span class="s2">&quot;structure should not have any outliers unless these are &quot;</span>
                                <span class="s2">&quot;exceptionally clear in the electron density (usually at &quot;</span>
                                <span class="s2">&quot;very high resolution). Be sure to also check the MolProbity &quot;</span>
                                <span class="s2">&quot;validation results for this structure, as they are more &quot;</span>
                                <span class="s2">&quot;sensitive to the geometric properties of proteins and nucleic &quot;</span>
                                <span class="s2">&quot;acids (especially in the case of dihedral angles).&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showBLrestraints2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Bond length&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Check here the number of outlier pairs of atoms &quot;</span>
                                <span class="s2">&quot;according to the bond length restraints &quot;</span>
                                <span class="s2">&quot;between pairs of linked atoms.</span><span class="se">\n</span><span class="s2">Warning!!!: &quot;</span>
                                <span class="s2">&quot;Refined structures should not have any outliers&quot;</span>
                                <span class="s2">&quot; except those are obvious in high &quot;</span>
                                <span class="s2">&quot;resolution electron density maps.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Length_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showBLoutliers2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;List of bond length outliers&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List of outlier pairs of atoms (sorted by deviation) &quot;</span>
                                    <span class="s2">&quot;according to the bond length restraints.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showBArestraints2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Bond angle&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Check here the number of outlier triplets of atoms &quot;</span>
                                <span class="s2">&quot;according to the bond angle restraints.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;Warning!!!: Refined structures should not &quot;</span>
                                <span class="s2">&quot;have any outliers except those are obvious in &quot;</span>
                                <span class="s2">&quot;high resolution electron density maps.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Angles_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showBAoutliers2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;List of bond angle outliers&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List of outlier triplets of atoms (sorted by &quot;</span>
                                    <span class="s2">&quot;deviation) according to the bond angle &quot;</span>
                                    <span class="s2">&quot;restraints&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showDArestraints2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Dihedral angle&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Check here the number of outlier tetrads of atoms &quot;</span>
                                <span class="s2">&quot;according &quot;</span>
                                <span class="s2">&quot;to the side chain dihedral torsion (chi) angle &quot;</span>
                                <span class="s2">&quot;restraints.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;Warning!!!: Refined structures should not &quot;</span>
                                <span class="s2">&quot;have any outliers except those are obvious in &quot;</span>
                                <span class="s2">&quot;high resolution electron density maps.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Dihedral_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showDAoutliers2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;List of dihedral angle outliers&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List of outlier tetrads of atoms (&quot;</span>
                                    <span class="s2">&quot;sorted by deviation) &quot;</span>
                                    <span class="s2">&quot;according to the dihedral &quot;</span>
                                    <span class="s2">&quot;angle restraints&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCHILrestraints2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Chirality&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Check here the number of outlier tetrads of atoms &quot;</span>
                                <span class="s2">&quot;according to the volume chirality &quot;</span>
                                <span class="s2">&quot;restraints.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;Warning!!!: Refined structures should not &quot;</span>
                                <span class="s2">&quot;have any outliers except those are obvious &quot;</span>
                                <span class="s2">&quot;in high resolution electron density maps.&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showPLANARrestraints2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Planarity&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Check here the number of outliers of planar &quot;</span>
                                <span class="s2">&quot;groups, such as aromatic rings,&quot;</span>
                                <span class="s2">&quot;according to the planar &quot;</span>
                                <span class="s2">&quot;restraints.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;Warning!!!: Refined structures should not &quot;</span>
                                <span class="s2">&quot;have any outliers except those are obvious &quot;</span>
                                <span class="s2">&quot;in high resolution electron density maps.&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showPARALrestraints&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Parallelity&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;Warning!!!: Refined structures should not &quot;</span>
                                <span class="s2">&quot;have any outliers except those are obvious &quot;</span>
                                <span class="s2">&quot;in high resolution electron density maps.&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showNONBondDistancerestraints&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Non-bonded distance&quot;</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;Warning!!!: Refined structures should not &quot;</span>
                                <span class="s2">&quot;have any outliers except those are obvious &quot;</span>
                                <span class="s2">&quot;in high resolution electron density maps.&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Display of rotamer and Rhamachandran outliers and clashes&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCootOutliers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Open in Coot&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Interactive visualization of outliers and clashes&quot;</span>
                                <span class="s2">&quot; with Coot:</span><span class="se">\n\n</span><span class="s2">Ramachandran outliers</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;Rotamer outliers</span><span class="se">\n</span><span class="s2">C-beta outliers</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;Severe clashes &quot;</span><span class="p">)</span>
            <span class="n">form</span><span class="o">.</span><span class="n">addSection</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Model vs. Data&quot;</span><span class="p">)</span>
            <span class="n">form</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCorCoefTable&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Overall correlation coefficients&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Real-space correlation coefficients</span><span class="se">\n\n</span><span class="s2">For a detailed &quot;</span>
                                <span class="s2">&quot;definition of global correlation metrics CC (mask), &quot;</span>
                                <span class="s2">&quot;CC (box), CC (volume), and CC (peaks) see Afonine, P. V., &quot;</span>
                                <span class="s2">&quot;Klaholz, B. P., Moriarty, N. W., Poon, B. K., Sobolev, &quot;</span>
                                <span class="s2">&quot;O. V., Terwilliger, T. C., Adams, P. D. &quot;</span>
                                <span class="s2">&quot;&amp; Urzhumtsev, A. (2018).</span><span class="se">\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;https://doi.org/10.1107/S20597983180093.</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                                <span class="s2">&quot;CC (mask): Model map vs. experimental map correlation &quot;</span>
                                <span class="s2">&quot;coefficient calculated considering map values inside &quot;</span>
                                <span class="s2">&quot;a mask calculated around the macromolecule&quot;</span>
                                <span class="s2">&quot;.</span><span class="se">\n\n</span><span class="s2">CC (box): Model map vs. experimental map correlation &quot;</span>
                                <span class="s2">&quot;coefficient calculated considering all grid points of the &quot;</span>
                                <span class="s2">&quot;box.</span><span class="se">\n\n</span><span class="s2">CC (volume) and CC (peaks) compare only &quot;</span>
                                <span class="s2">&quot;map regions with the highest density values &quot;</span>
                                <span class="s2">&quot;and regions below a certain contouring &quot;</span>
                                <span class="s2">&quot;threshold level are ignored.</span><span class="se">\n</span><span class="s2">CC (volume): &quot;</span>
                                <span class="s2">&quot;The map region considered is defined by &quot;</span>
                                <span class="s2">&quot;the N highest points inside the molecular &quot;</span>
                                <span class="s2">&quot;mask.</span><span class="se">\n\n</span><span class="s2">CC (peaks): In this case, calculations &quot;</span>
                                <span class="s2">&quot;consider the union of regions defined by &quot;</span>
                                <span class="s2">&quot;the N highest peaks in the model-calculated &quot;</span>
                                <span class="s2">&quot;map and the N highest peaks in the &quot;</span>
                                <span class="s2">&quot;experimental map.</span><span class="se">\n\n</span><span class="s2">Local real-space correlation coefficients &quot;</span>
                                <span class="s2">&quot;CC (main chain) and CC (side chain) involve main skeleton chain &quot;</span>
                                <span class="s2">&quot;and lateral chains, respectively.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s2">&quot;Correlation graphs&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Chain_list&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Chains_list</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Chain_list&#39;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Chains_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;displayPlotChains&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Plot CC vs. Chain ID&quot;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;exportFiles2&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Save chain CC as text&#39;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;selectChain&#39;</span><span class="p">,</span> <span class="n">EnumParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">choices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">Chains_list</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Chain&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Select a chain of the macromolecule&quot;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;displayPlotResidues&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Plot CC vs. Residue number of the selected Chain&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Dashed line indicates the average value of CC for &quot;</span>
                                    <span class="s2">&quot;the whole chain.&quot;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;exportFiles3&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Save residue CC of the selected Chain as text&#39;</span><span class="p">)</span>
            <span class="n">form</span><span class="o">.</span><span class="n">addSection</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Data&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Summary&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s2">&quot;showBox&quot;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Box info (unit cell)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Cell dimensions of the map (pixels).&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s2">&quot;showBoxDetails&quot;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Unit cell: &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Unit cell&#39;</span><span class="p">]</span> <span class="o">+</span>
                                 <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;Space group: &quot;</span> <span class="o">+</span>
                                 <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Space group&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMapResolution&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Map Resolution Estimates (Angstroms)&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Resolution estimates of the map considering &quot;</span>
                                <span class="s2">&quot;both map experimental data and model-derived &quot;</span>
                                <span class="s2">&quot;information.</span><span class="se">\n\n</span><span class="s2">d99: Resolution cutoff beyond &quot;</span>
                                <span class="s2">&quot;which Fourier map coefficients are negligibly &quot;</span>
                                <span class="s2">&quot;small. Calculated from the full map or from each&quot;</span>
                                <span class="s2">&quot; one of half maps [d99 (half map 1), d99 (half &quot;</span>
                                <span class="s2">&quot;map 2)].</span><span class="se">\n</span><span class="s2">Overall Biso: Overall isotropic B-value.&quot;</span>
                                <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">d_model: Resolution cutoff at which the model &quot;</span>
                                <span class="s2">&quot;map is the most similar to the target (experimental)&quot;</span>
                                <span class="s2">&quot; map. Requires map and model. For d_model to be &quot;</span>
                                <span class="s2">&quot;meaningful, model is expected to fit the map as good&quot;</span>
                                <span class="s2">&quot; as possible. d_model (B factors = 0) tries to avoid&quot;</span>
                                <span class="s2">&quot;the blurring of the map.</span><span class="se">\n</span><span class="s2">FSC (model): d_FSC_model; &quot;</span>
                                <span class="s2">&quot;Resolution cutoff up to which the model and map &quot;</span>
                                <span class="s2">&quot;Fourier coefficients are similar at FSC values of 0, &quot;</span>
                                <span class="s2">&quot;0.143, 0.5.</span><span class="se">\n</span><span class="s2">FSC (half map 1, 2) = 0.143 (d_fsc): d_FSC; &quot;</span>
                                <span class="s2">&quot;Highest resolution at which the experimental data are &quot;</span>
                                <span class="s2">&quot;confident. Obtained from FSC curve calculated using&quot;</span>
                                <span class="s2">&quot; two half-maps and taken at FSC=0.143. The two half&quot;</span>
                                <span class="s2">&quot; maps are required to compute this value.</span><span class="se">\n</span><span class="s2">Mask &quot;</span>
                                <span class="s2">&quot;smoothing radius (Angstroms): Radius of the default &quot;</span>
                                <span class="s2">&quot;soft mask used since sharp edges resulting from &quot;</span>
                                <span class="s2">&quot;applying a binary map may introduce Fourier artifacts.&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMapStatistics&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Map Statistics&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Origin: Coordinates of map origin.</span><span class="se">\n</span><span class="s2">All: Map box size &quot;</span>
                                <span class="s2">&quot;in pixels.</span><span class="se">\n</span><span class="s2">Min, Max, Mean: Statistics of the map &quot;</span>
                                <span class="s2">&quot;electron density values.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol</span><span class="o">.</span><span class="n">getHalfMaps</span><span class="p">():</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showHalfMapCC&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Half-map CC: &quot;</span> <span class="o">+</span>
                                     <span class="p">(</span><span class="s2">&quot;</span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s2">&quot;HalfMapCC&quot;</span><span class="p">]),</span>
                               <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Correlation coefficient between both half maps.&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMapHistogram&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Histogram of Map Values&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Plot that shows the number of map grid points regarding&quot;</span>
                                <span class="s2">&quot; the electron density values. Histograms are &quot;</span>
                                <span class="s2">&quot;usually skewed to the right.&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMapHistValues&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Map Values (slots) vs. Map (count)&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Table of intervals of map electron density (slots of map&quot;</span>
                                <span class="s2">&quot; values) and number of grid points involved.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol</span><span class="o">.</span><span class="n">getHalfMaps</span><span class="p">():</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;FSC (Half-maps)&#39;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s2">&quot;showPlotFSC1&quot;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Plot FSC vs. resolution (Angstroms)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s2">&quot;FSC curve calculated using two half maps regarding &quot;</span>
                                    <span class="s2">&quot;the spatial frequency (1/Angstroms) and resolution &quot;</span>
                                    <span class="s2">&quot;(Angstroms).&quot;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;exportFiles4&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Save FSC plot data as text&#39;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;FSC (Model-map)&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s2">&quot;showPlotFSC2&quot;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Plot FSC vs. resolution (Angstroms)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;FSC curve calculated using the full map and the &quot;</span>
                                <span class="s2">&quot;model-derived map regarding the spatial frequency &quot;</span>
                                <span class="s2">&quot;(1/Angstroms) and resolution (Angstroms).&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;exportFiles5&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Save FSC plot data as text&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">==</span> <span class="n">PHENIXVERSION</span><span class="p">:</span>
            <span class="n">PhenixProtRefinementBaseViewer</span><span class="o">.</span><span class="n">_defineParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">!=</span> <span class="n">PHENIXVERSION</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">_getVisualizeDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span><span class="p">{</span>
                   <span class="s1">&#39;displayMapModel&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displayMapModel</span><span class="p">,</span>
                   <span class="s1">&#39;showModelSummary&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showModelSummary</span><span class="p">,</span>
                   <span class="s1">&#39;showDataSummary&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showDataSummary</span><span class="p">,</span>
                   <span class="s1">&#39;showModelVsDataSummary&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showModelVsDataSummary</span><span class="p">,</span>
                   <span class="s1">&#39;showClashes2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showClashes2</span><span class="p">,</span>
                   <span class="s1">&#39;exportFiles1&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exportFiles1</span><span class="p">,</span>
                   <span class="s1">&#39;showCaBLAM&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCaBLAM</span><span class="p">,</span>
                   <span class="s1">&#39;showCbetaOutliersTable2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCbetaOutliersTable2</span><span class="p">,</span>
                   <span class="s1">&#39;showCisAndTwistedPeptides2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCisAndTwistedPeptides2</span><span class="p">,</span>
                   <span class="s1">&#39;showRotaOutliersTable2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showRotaOutliersTable2</span><span class="p">,</span>
                   <span class="s1">&#39;displayPlotRota&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displayPlotRota</span><span class="p">,</span>
                   <span class="s1">&#39;showCootOutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCootOutliers</span><span class="p">,</span>
                   <span class="s1">&#39;showRhamaOutliersTable2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showRhamaOutliersTable2</span><span class="p">,</span>
                   <span class="s1">&#39;displayPlotRhama&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displayPlotRhama</span><span class="p">,</span>
                   <span class="s1">&#39;showBLrestraints2&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">_showBLrestraints2</span><span class="p">,</span>
                   <span class="s1">&#39;showBLoutliers2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBLoutliers</span><span class="p">,</span>
                   <span class="s1">&#39;showBArestraints2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBArestraints2</span><span class="p">,</span>
                   <span class="s1">&#39;showBAoutliers2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBAoutliers</span><span class="p">,</span>
                   <span class="s1">&#39;showDArestraints2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showDArestraints2</span><span class="p">,</span>
                   <span class="s1">&#39;showDAoutliers2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showDAoutliers</span><span class="p">,</span>
                   <span class="s1">&#39;showCHILrestraints2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCHILrestraints2</span><span class="p">,</span>
                   <span class="s1">&#39;showPLANARrestraints2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showPLANARrestraints2</span><span class="p">,</span>
                   <span class="s1">&#39;showPARALrestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showPARALrestraints</span><span class="p">,</span>
                   <span class="s1">&#39;showNONBondDistancerestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showNONBondDistancerestraints</span><span class="p">,</span>
                   <span class="s1">&#39;showCorCoefTable&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCorCoefTable</span><span class="p">,</span>
                   <span class="s1">&#39;displayPlotChains&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displayPlotChains</span><span class="p">,</span>
                   <span class="s1">&#39;exportFiles2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exportFiles2</span><span class="p">,</span>
                   <span class="s1">&#39;displayPlotResidues&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displayPlotResidues</span><span class="p">,</span>
                   <span class="s1">&#39;exportFiles3&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exportFiles3</span><span class="p">,</span>
                   <span class="s1">&#39;showMapResolution&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showMapResolution</span><span class="p">,</span>
                   <span class="s1">&#39;showMapStatistics&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showMapStatistics</span><span class="p">,</span>
                   <span class="s1">&#39;showMapHistogram&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showMapHistogram</span><span class="p">,</span>
                   <span class="s1">&#39;showMapHistValues&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showMapHistValues</span><span class="p">,</span>
                   <span class="s1">&#39;showPlotFSC1&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showPlotFSC1</span><span class="p">,</span>
                   <span class="s1">&#39;exportFiles4&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exportFiles4</span><span class="p">,</span>
                   <span class="s1">&#39;showPlotFSC2&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showPlotFSC2</span><span class="p">,</span>
                   <span class="s1">&#39;exportFiles5&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exportFiles5</span>
                  <span class="p">}</span>
    <span class="k">if</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">==</span> <span class="n">PHENIXVERSION</span><span class="p">:</span>
        <span class="k">def</span> <span class="nf">_getVisualizeDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span><span class="p">{</span>
                   <span class="s1">&#39;displayMapModel&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displayMapModel</span><span class="p">,</span>
                   <span class="s1">&#39;showMolProbityResults&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualizeMolProbityResults</span><span class="p">,</span>
                   <span class="s1">&#39;showCootOutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCootOutliers</span><span class="p">,</span>
                   <span class="s1">&#39;showMissingAtoms&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showMissingAtoms</span><span class="p">,</span>
                   <span class="s1">&#39;showBLrestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBLrestraints</span><span class="p">,</span>
                   <span class="s1">&#39;showBLoutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBLoutliers</span><span class="p">,</span>
                   <span class="s1">&#39;showBArestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBArestraints</span><span class="p">,</span>
                   <span class="s1">&#39;showBAoutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBAoutliers</span><span class="p">,</span>
                   <span class="s1">&#39;showDArestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showDArestraints</span><span class="p">,</span>
                   <span class="s1">&#39;showDAoutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showDAoutliers</span><span class="p">,</span>
                   <span class="s1">&#39;showCHILrestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCHILrestraints</span><span class="p">,</span>
                   <span class="s1">&#39;showCHILoutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCHILoutliers</span><span class="p">,</span>
                   <span class="s1">&#39;showPLANARrestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showPLANARrestraints</span><span class="p">,</span>
                   <span class="s1">&#39;showPLANARoutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showPLANARoutliers</span><span class="p">,</span>
                   <span class="s1">&#39;showPlotType&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showPlotType</span><span class="p">,</span>
                   <span class="s1">&#39;showRamaOutliersTable&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showRamaOutliersTable</span><span class="p">,</span>
                   <span class="s1">&#39;showRotaOutliersTable&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showRotaOutliersTable</span><span class="p">,</span>
                   <span class="s1">&#39;showCbetaOutliersTable&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCbetaOutliersTable</span><span class="p">,</span>
                   <span class="s1">&#39;showBackAsnGlnHisSidechains&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBackAsnGlnHisSidechains</span><span class="p">,</span>
                   <span class="s1">&#39;showCisAndTwistedPeptides&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCisAndTwistedPeptides</span><span class="p">,</span>
                   <span class="s1">&#39;showMultiCriterionPlot&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showMultiCriterionPlot</span><span class="p">,</span>
                   <span class="s1">&#39;showOverallRSCResults&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showOverallRSCResults</span><span class="p">,</span>
                   <span class="s1">&#39;showClashes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showClashes</span><span class="p">,</span>
                   <span class="s1">&#39;showCCTable&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCCTable</span><span class="p">,</span>
                   <span class="s1">&#39;displayFSCplot&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displayFSCplot</span><span class="p">,</span>
                   <span class="s1">&#39;showOccupancies&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showOccupancies</span><span class="p">,</span>
                   <span class="s1">&#39;showIsotropicB&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showIsotropicB</span><span class="p">,</span>
                   <span class="s1">&#39;showSuspiciousBfactors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span> <span class="n">_showSuspiciousBfactors</span>
                   <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_showModelSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">]</span>
        <span class="n">dataList1_1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Composition (#)&#39;</span><span class="p">,</span> <span class="s1">&#39;     Chains&#39;</span><span class="p">,</span> <span class="s1">&#39;     Atoms&#39;</span><span class="p">,</span> <span class="s1">&#39;     Residues&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;     Water&#39;</span><span class="p">,</span> <span class="s1">&#39;     Ligands&#39;</span><span class="p">,</span> <span class="s1">&#39;Bonds (RMSD)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;     Length (Angstroms) (# &gt; 4sigma)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;     Angles (degrees) (# &gt; 4sigma)&#39;</span><span class="p">,</span> <span class="s1">&#39;MolProbity score&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;Clash score&#39;</span><span class="p">,</span> <span class="s1">&#39;Ramachandran plot (%)&#39;</span><span class="p">,</span> <span class="s1">&#39;     Outliers&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;     Allowed&#39;</span><span class="p">,</span> <span class="s1">&#39;     Favored&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">PHENIXVERSION18</span><span class="p">:</span>
            <span class="n">dataList1_2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Rama-Z (Ramachandran plot Z-score, RMSD)&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;     whole (N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_whole_n&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;     helix (N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_helix_n&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;     sheet (N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_sheet_n&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;     loop (N = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_loop_n&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">]</span>
        <span class="n">dataList1_3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Rotamer outliers (%)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;Cbeta outliers (%)&#39;</span><span class="p">,</span> <span class="s1">&#39;Peptide plane (%)&#39;</span><span class="p">,</span> <span class="s1">&#39;     Cis proline/general&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;     Twisted proline/general&#39;</span><span class="p">,</span> <span class="s1">&#39;CaBLAM outliers (%)&#39;</span><span class="p">,</span> <span class="s1">&#39;ADP (B-factors)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;     Iso/Aniso (#)&#39;</span><span class="p">,</span> <span class="s1">&#39;     min/max/mean&#39;</span><span class="p">,</span> <span class="s1">&#39;           Protein&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;           Nucleotide&#39;</span><span class="p">,</span> <span class="s1">&#39;           Ligand&#39;</span><span class="p">,</span> <span class="s1">&#39;           Water&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;Occupancy&#39;</span><span class="p">,</span> <span class="s1">&#39;     Mean&#39;</span><span class="p">,</span> <span class="s1">&#39;     occ = 1 (%)&#39;</span><span class="p">,</span> <span class="s1">&#39;     0 &lt; occ &lt; 1 (%)&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;     occ &gt; 1 (%)&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">PHENIXVERSION18</span><span class="p">:</span>
            <span class="n">dataList1</span> <span class="o">=</span> <span class="n">dataList1_1</span> <span class="o">+</span> <span class="n">dataList1_2</span> <span class="o">+</span> <span class="n">dataList1_3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dataList1</span> <span class="o">=</span> <span class="n">dataList1_1</span> <span class="o">+</span> <span class="n">dataList1_3</span>

        <span class="n">dataList2_1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Chains&#39;</span><span class="p">],</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s2">&quot;Atoms&quot;</span><span class="p">])</span><span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;(Hydrogens: &quot;</span> <span class="o">+</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s2">&quot;Hydrogens&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;Protein: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Protein_residues&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span>
                     <span class="s2">&quot;Nucleotide: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Nucleotide_residues&#39;</span><span class="p">]),</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Water&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Ligands&#39;</span><span class="p">],</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Length&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Length_outliers&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Angles&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Angles_outliers&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;MolProbity_score&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Clash_score&#39;</span><span class="p">],</span>
                     <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rhama_Outliers&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rhama_Allowed&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rhama_Favored&#39;</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">PHENIXVERSION18</span><span class="p">:</span>
            <span class="n">dataList2_2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_whole_value&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_whole_std&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_helix_value&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_helix_std&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_sheet_value&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_sheet_std&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">,</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_loop_value&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rama_Z_loop_std&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">]</span>
        <span class="n">dataList2_3</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rota_Outliers&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Cbeta_Outliers&#39;</span><span class="p">],</span>
                     <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Cis_proline&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Cis_general&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Twisted_proline&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Twisted_general&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CaBLAM_outliers&#39;</span><span class="p">],</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;n_iso&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;n_aniso&#39;</span><span class="p">]),</span>
                     <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;protein_min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;protein_max&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;protein_mean&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;nucleotide_min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;nucleotide_max&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;nucleotide_mean&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;other_min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;other_max&#39;</span><span class="p">]</span>
                     <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;other_mean&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;water_min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;water_max&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;water_mean&#39;</span><span class="p">],</span>
                     <span class="s2">&quot;&quot;</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;occupancy_mean&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;occupancy_occ_1&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;occupancy_0_occ_1&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;occupancy_occ_higher_1&#39;</span><span class="p">]]</span>

        <span class="k">if</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">PHENIXVERSION18</span><span class="p">:</span>
            <span class="n">dataList2</span> <span class="o">=</span> <span class="n">dataList2_1</span> <span class="o">+</span> <span class="n">dataList2_2</span> <span class="o">+</span> <span class="n">dataList2_3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dataList2</span> <span class="o">=</span> <span class="n">dataList2_1</span> <span class="o">+</span> <span class="n">dataList2_3</span>

        <span class="n">dataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataList1</span><span class="p">,</span> <span class="n">dataList2</span><span class="p">):</span>
            <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">))</span>

        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Model&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Summary Table&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showDataSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="n">dataList1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Box&#39;</span><span class="p">,</span> <span class="s1">&#39;     Length (Angstroms)&#39;</span><span class="p">,</span> <span class="s1">&#39;     Angles (degrees)&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;Supplied Resolution (Angstroms)&#39;</span><span class="p">,</span> <span class="s1">&#39;Resolution Estimates (Angstroms)&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;     d FSC (half maps; 0.143)&#39;</span><span class="p">,</span> <span class="s1">&#39;     d 99 (full/half1/half2)&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;     d model&#39;</span><span class="p">,</span> <span class="s1">&#39;     d FSC model (0/0.143/0.5)&#39;</span><span class="p">,</span> <span class="s1">&#39;Map min/max/mean&#39;</span><span class="p">]</span>
        <span class="n">dataList2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Box_lengths&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Box_angles&#39;</span><span class="p">],</span>
                     <span class="p">(</span><span class="s2">&quot;</span><span class="si">%.1f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Supplied_Resolution&#39;</span><span class="p">]),</span>
                     <span class="s2">&quot;Masked&quot;</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;dFSC_half_maps_0.143_masked&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d99_full_masked&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d99_half1_masked&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d99_half2_masked&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;dmodel_masked&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;dFSCmodel_0_masked&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;dFSCmodel_0.143_masked&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;dFSCmodel_0.5_masked&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_min&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_max&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_mean&#39;</span><span class="p">]]</span>
        <span class="n">dataList3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                     <span class="s2">&quot;Unmasked&quot;</span><span class="p">,</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;dFSC_half_maps_0.143_unmasked&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d99_full_unmasked&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d99_half1_unmasked&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d99_half2_unmasked&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;dmodel_unmasked&#39;</span><span class="p">],</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;dFSCmodel_0_unmasked&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;dFSCmodel_0.143_unmasked&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;dFSCmodel_0.5_unmasked&#39;</span><span class="p">],</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>

        <span class="n">dataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataList1</span><span class="p">,</span> <span class="n">dataList2</span><span class="p">,</span> <span class="n">dataList3</span><span class="p">):</span>
            <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">))</span>

        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Data&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Summary Table&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showModelVsDataSummary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="s1">&#39;Value&#39;</span><span class="p">]</span>
        <span class="n">dataList1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CC (mask)&#39;</span><span class="p">,</span> <span class="s1">&#39;CC (box)&#39;</span><span class="p">,</span> <span class="s1">&#39;CC (peaks)&#39;</span><span class="p">,</span> <span class="s1">&#39;CC (volume)&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;Mean CC for ligands&#39;</span><span class="p">]</span>
        <span class="n">dataList2</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CC_mask&#39;</span><span class="p">]),</span>
                     <span class="p">(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CC_box&#39;</span><span class="p">]),</span>
                     <span class="p">(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CC_peaks&#39;</span><span class="p">]),</span>
                     <span class="p">(</span><span class="s2">&quot;</span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CC_volume&#39;</span><span class="p">]),</span>
                     <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Ligand_CC&#39;</span><span class="p">]]</span>

        <span class="n">dataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataList1</span><span class="p">,</span> <span class="n">dataList2</span><span class="p">):</span>
            <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">))</span>

        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Model vs. Data&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Summary Table&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showClashes2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Clashes_header&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Clashes_table&#39;</span><span class="p">]</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Bad contacts from PROBE: </span><span class="si">%d</span><span class="s2"> overlapping atom pairs&quot;</span> \
               <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataList</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;All atom-contact analyis&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_exportFiles1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">CLASHESFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CLASHESFILE</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">onSelect</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">dirName</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getPath</span><span class="p">()</span>
            <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;import pickle</span>
<span class="s2">def pickleData(file):</span>
<span class="s2">    with open(file,&quot;r&quot;) as f:</span>
<span class="s2">        return pickle.load(f)</span>

<span class="s2"># process file </span><span class="si">{VALIDATIONCRYOEMPKLFILENAME}</span><span class="s2">&quot;</span>
<span class="s2">data = pickleData(&#39;</span><span class="si">{VALIDATIONCRYOEMPKLFILENAME}</span><span class="s2">&#39;)</span>
<span class="s2">data.model.geometry.clash.clashes.save_table_data(&quot;</span><span class="si">{dirName}</span><span class="s2">/clashes.txt&quot;)</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">VALIDATIONCRYOEMPKLFILENAME</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">VALIDATIONCRYOEMPKLFILENAME</span><span class="p">,</span>
                   <span class="n">dirName</span><span class="o">=</span><span class="n">dirName</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">CLASHESFILENAME</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>
            <span class="c1"># execute file with phenix.python</span>
            <span class="n">Plugin</span><span class="o">.</span><span class="n">runPhenixProgram</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">CLASHESFILENAME</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_openBrowser</span><span class="p">(</span><span class="n">onSelect</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showCaBLAM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CaBLAM_header&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CaBLAM_table&#39;</span><span class="p">]</span>
        <span class="n">dataListNew</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dataList</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">[:</span><span class="mi">9</span><span class="p">]:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%6.5f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">j</span><span class="p">)</span>
            <span class="n">dataListNew</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>

        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Outliers (</span><span class="si">%%</span><span class="s2">): </span><span class="si">%s</span><span class="s2">  Disfavored (</span><span class="si">%%</span><span class="s2">): </span><span class="si">%.2f</span><span class="s2">  Calpha outliers (</span><span class="si">%%</span><span class="s2">): </span><span class="si">%.2f</span><span class="s2">&quot;</span> \
               <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CaBLAM_outliers&#39;</span><span class="p">],</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CaBLAM_disfavored&#39;</span><span class="p">],</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CaBLAM_Calpha_outliers&#39;</span><span class="p">])</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;CaBLAM&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataListNew</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showCbetaOutliersTable2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Cbeta_header&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Cbeta_table&#39;</span><span class="p">]</span>
        <span class="n">dataListNew</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dataList</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%6.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">j</span><span class="p">)</span>
            <span class="n">dataListNew</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;C-beta outliers&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;C-beta deviation analysis&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataListNew</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showCisAndTwistedPeptides2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Omega_headers&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Omega_table&#39;</span><span class="p">]</span>
        <span class="n">dataListNew</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dataList</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%6.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">j</span><span class="p">)</span>
            <span class="n">dataListNew</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Cis conformations are observed in about 5</span><span class="si">% o</span><span class="s2">f Prolines.</span><span class="se">\n</span><span class="s2">&quot;</span> \
               <span class="s2">&quot;Cis conformations are observed in about 0.03</span><span class="si">% o</span><span class="s2">f general residues.</span><span class="se">\n</span><span class="s2">&quot;</span> \
               <span class="s2">&quot;Twisted peptides are almost certainly modeling errors.&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Cis and twisted peptides&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataListNew</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showRotaOutliersTable2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rota_header&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rota_table&#39;</span><span class="p">]</span>
        <span class="n">dataListNew</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dataList</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%6.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">j</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">i</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%6.1f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">j</span><span class="p">)</span>
            <span class="n">dataListNew</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Outlier list&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Rotamer analysis&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataListNew</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_displayPlotRota</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_displayPlotBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ROTATMPFILE</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_displayPlotBase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">listNumber</span><span class="p">):</span>
        <span class="n">FILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_writeCommand2</span><span class="p">(</span><span class="n">listNumber</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">FILENAME</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">)</span>
        <span class="c1"># execute file with phenix.python</span>
        <span class="n">Plugin</span><span class="o">.</span><span class="n">runPhenixProgram</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">FILENAME</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_writeCommand2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listNumber</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span><span class="s2">&quot;&quot;&quot;import pickle     </span>
<span class="s2">def pickleData(file):</span>
<span class="s2">    with open(file,&quot;r&quot;) as f:</span>
<span class="s2">        return pickle.load(f)</span>
<span class="s2">        </span>
<span class="s2"># process file </span><span class="si">{VALIDATIONCRYOEMPKLFILENAME}</span><span class="s2">&quot;</span>
<span class="s2">data = pickleData(&#39;</span><span class="si">{VALIDATIONCRYOEMPKLFILENAME}</span><span class="s2">&#39;)</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">VALIDATIONCRYOEMPKLFILENAME</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">VALIDATIONCRYOEMPKLFILENAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">listNumber</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">listNumber</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">listNumber</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;# Rhamachandran plot</span>
<span class="s2">if data.model.geometry.ramachandran.ramalyze is not None:</span>
<span class="s2">&quot;&quot;&quot;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">listNumber</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;# Rotamer plot</span>
<span class="s2">if data.model.geometry.rotamer.rotalyze is not None:</span>
<span class="s2">&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    try :</span>
<span class="s2">        import wxtbx.app</span>
<span class="s2">    except ImportError, e :</span>
<span class="s2">        raise Sorry(&quot;wxPython not available.&quot;)</span>
<span class="s2">    app = wxtbx.app.CCTBXApp(0)</span>
<span class="s2">&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">listNumber</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    data.model.geometry.ramachandran.ramalyze.display_wx_plots() </span>
<span class="s2">&quot;&quot;&quot;</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">listNumber</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    data.model.geometry.rotamer.rotalyze.display_wx_plots() </span>
<span class="s2">&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    app.MainLoop()</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">listNumber</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;# Chain plot</span>
<span class="s2">if data.model_vs_data.cc is not None:</span>
<span class="s2">    import matplotlib.pyplot as plt</span>
<span class="s2">    chain_names = []</span>
<span class="s2">    chain_cc = []</span>
<span class="s2">    for item in data.model_vs_data.cc.cc_per_chain:</span>
<span class="s2">        if item.chain_id not in chain_names:</span>
<span class="s2">            chain_names.append(item.chain_id)</span>
<span class="s2">            chain_cc.append(item.cc)</span>
<span class="s2">    assert(len(chain_names) == len(chain_cc))</span>
<span class="s2">    fig = plt.figure(figsize=(10,4))</span>
<span class="s2">    p = fig.add_subplot(111)</span>
<span class="s2">    fig.subplots_adjust(left = 0.10, right = 0.975, bottom = 0.25, top = 0.80)</span>
<span class="s2">    p.bar(chain_names, chain_cc, width = 0.9)</span>
<span class="s2">    p.set_xlabel(&#39;Chain ID&#39;)</span>
<span class="s2">    p.set_ylabel(&#39;CC&#39;)</span>
<span class="s2">    p.set_ylim(0, 1)</span>
<span class="s2">    p.set_title(&#39;Plot of correlation coefficients regarding chain IDs&#39;, fontsize = 14)</span>
<span class="s2">    x = range(len(chain_cc))</span>
<span class="s2">    p.set_xticks(x)</span>
<span class="s2">    p.set_xticklabels(chain_names)</span>
<span class="s2">    fig.canvas.draw()</span>
<span class="s2">    plt.show()</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">listNumber</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">chain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chains_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selectChain</span><span class="o">.</span><span class="n">get</span><span class="p">()]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;# Chain plot</span>
<span class="s2">if data.model_vs_data.cc is not None:</span>
<span class="s2">    import matplotlib.pyplot as plt</span>
<span class="s2">    resseq_list = []</span>
<span class="s2">    residue_cc = []</span>
<span class="s2">    for item in data.model_vs_data.cc.cc_per_residue:</span>
<span class="s2">        if item.chain_id == &quot;</span><span class="si">%s</span><span class="s2">&quot;:</span>
<span class="s2">            resseq_list.append(item.resseq)</span>
<span class="s2">            residue_cc.append(item.cc)</span>
<span class="s2">    chain_mean = sum(residue_cc) / len(residue_cc) </span>
<span class="s2">    assert(len(resseq_list) == len(residue_cc))</span>
<span class="s2">    fig = plt.figure(figsize=(15,4))</span>
<span class="s2">    p = fig.add_subplot(111)</span>
<span class="s2">    fig.subplots_adjust(left = 0.10, right = 0.975, bottom = 0.25, top = 0.80)</span>
<span class="s2">    p.plot(resseq_list, residue_cc, &#39;b-&#39;, linewidth=1)</span>
<span class="s2">    p.set_xlabel(&#39;Residue number&#39;)</span>
<span class="s2">    p.set_ylabel(&#39;CC&#39;)</span>
<span class="s2">    p.set_ylim(-0.1, 1)</span>
<span class="s2">    p.set_title(&#39;Plot of correlation coefficients regarding residue numbers of chain &quot;</span><span class="si">%s</span><span class="s2">&quot;&#39;, fontsize = 14)</span>
<span class="s2">    intv = int(round((len(resseq_list))/5))</span>
<span class="s2">    x_axis = [0, intv, 2 * intv, 3 * intv, 4 * intv, 5 * intv]</span>
<span class="s2">    p.set_xticks(x_axis)</span>
<span class="s2">    p.set_xticklabels(x_axis)</span>
<span class="s2">    # draw line for mean</span>
<span class="s2">    p.axhline(y = chain_mean, color = &#39;k&#39;, linestyle = &#39;dashed&#39;)</span>
<span class="s2">    fig.canvas.draw()</span>
<span class="s2">    plt.show()</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">%</span> <span class="p">(</span><span class="n">chain</span><span class="p">,</span> <span class="n">chain</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showRhamaOutliersTable2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rhama_header&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Rhama_table&#39;</span><span class="p">]</span>
        <span class="n">dataListNew</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dataList</span><span class="p">:</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%6.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">j</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">j</span> <span class="o">!=</span> <span class="n">i</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
                    <span class="n">i1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%6.1f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">j</span><span class="p">)</span>
            <span class="n">dataListNew</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Outlier list&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Rhamachandran analysis&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataListNew</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_displayPlotRhama</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_displayPlotBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RAMATMPFILE</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showBLrestraints2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictBL</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">dictBL</span><span class="p">[</span><span class="s1">&#39;Number of restraints:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;BLRestraints&#39;</span><span class="p">]</span>
        <span class="n">dictBL</span><span class="p">[</span><span class="s1">&#39;RMS (deviation):&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;BLMean&#39;</span><span class="p">]</span>
        <span class="n">dictBL</span><span class="p">[</span><span class="s1">&#39;Max. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;BLMax&#39;</span><span class="p">]</span>
        <span class="n">dictBL</span><span class="p">[</span><span class="s1">&#39;Min. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;BLMin&#39;</span><span class="p">]</span>
        <span class="n">dictBL</span><span class="p">[</span><span class="s1">&#39;Number of outliers &gt; 4sigma:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Length_outliers&#39;</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Bond Length Restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Geometry Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictBL</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showBArestraints2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictBA</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">dictBA</span><span class="p">[</span><span class="s1">&#39;Number of restraints:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;BARestraints&#39;</span><span class="p">]</span>
        <span class="n">dictBA</span><span class="p">[</span><span class="s1">&#39;RMS (deviation):&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;BAMean&#39;</span><span class="p">]</span>
        <span class="n">dictBA</span><span class="p">[</span><span class="s1">&#39;Max. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;BAMax&#39;</span><span class="p">]</span>
        <span class="n">dictBA</span><span class="p">[</span><span class="s1">&#39;Min. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;BAMin&#39;</span><span class="p">]</span>
        <span class="n">dictBA</span><span class="p">[</span><span class="s1">&#39;Number of outliers &gt; 4sigma:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Angles_outliers&#39;</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Bond Angle Restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Geometry Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictBA</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showDArestraints2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictDA</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">dictDA</span><span class="p">[</span><span class="s1">&#39;Number of restraints:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;DARestraints&#39;</span><span class="p">]</span>
        <span class="n">dictDA</span><span class="p">[</span><span class="s1">&#39;RMS (deviation):&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;DAMean&#39;</span><span class="p">]</span>
        <span class="n">dictDA</span><span class="p">[</span><span class="s1">&#39;Max. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;DAMax&#39;</span><span class="p">]</span>
        <span class="n">dictDA</span><span class="p">[</span><span class="s1">&#39;Min. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;DAMin&#39;</span><span class="p">]</span>
        <span class="n">dictDA</span><span class="p">[</span><span class="s1">&#39;Number of outliers &gt; 4sigma:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Dihedral_outliers&#39;</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Dihedral Angle Restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Geometry Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictDA</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showCHILrestraints2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictChil</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">dictChil</span><span class="p">[</span><span class="s1">&#39;Number of restraints:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;ChiralityRestraints&#39;</span><span class="p">]</span>
        <span class="n">dictChil</span><span class="p">[</span><span class="s1">&#39;RMS (deviation):&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;ChiralityMean&#39;</span><span class="p">]</span>
        <span class="n">dictChil</span><span class="p">[</span><span class="s1">&#39;Max. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;ChiralityMax&#39;</span><span class="p">]</span>
        <span class="n">dictChil</span><span class="p">[</span><span class="s1">&#39;Min. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;ChiralityMin&#39;</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Chirality restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Geometry Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictChil</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showPLANARrestraints2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictPLANAR</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">dictPLANAR</span><span class="p">[</span><span class="s1">&#39;Number of restraints:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;PlanarityRestraints&#39;</span><span class="p">]</span>
        <span class="n">dictPLANAR</span><span class="p">[</span><span class="s1">&#39;RMS (deviation):&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;PlanarityMean&#39;</span><span class="p">]</span>
        <span class="n">dictPLANAR</span><span class="p">[</span><span class="s1">&#39;Max. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;PlanarityMax&#39;</span><span class="p">]</span>
        <span class="n">dictPLANAR</span><span class="p">[</span><span class="s1">&#39;Min. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;PlanarityMin&#39;</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Planarity restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Geometry Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictPLANAR</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showPARALrestraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictPARAL</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">dictPARAL</span><span class="p">[</span><span class="s1">&#39;Number of restraints:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;ParallelityRestraints&#39;</span><span class="p">]</span>
        <span class="n">dictPARAL</span><span class="p">[</span><span class="s1">&#39;RMS (deviation):&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;ParallelityMean&#39;</span><span class="p">]</span>
        <span class="n">dictPARAL</span><span class="p">[</span><span class="s1">&#39;Max. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;ParallelityMax&#39;</span><span class="p">]</span>
        <span class="n">dictPARAL</span><span class="p">[</span><span class="s1">&#39;Min. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;ParallelityMin&#39;</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Parallelity restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Geometry Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictPARAL</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showNONBondDistancerestraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictNONBondDistance</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">dictNONBondDistance</span><span class="p">[</span><span class="s1">&#39;Number of restraints:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;NonbondedRestraints&#39;</span><span class="p">]</span>
        <span class="n">dictNONBondDistance</span><span class="p">[</span><span class="s1">&#39;RMS (deviation):&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;NonbondedMean&#39;</span><span class="p">]</span>
        <span class="n">dictNONBondDistance</span><span class="p">[</span><span class="s1">&#39;Max. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;NonbondedMax&#39;</span><span class="p">]</span>
        <span class="n">dictNONBondDistance</span><span class="p">[</span><span class="s1">&#39;Min. deviation:&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;NonbondedMin&#39;</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Non-bonded distance restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Geometry Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictNONBondDistance</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showCorCoefTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictCC</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">dictCC</span><span class="p">[</span><span class="s2">&quot;CC (mask): &quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CC_mask&#39;</span><span class="p">]</span>
        <span class="n">dictCC</span><span class="p">[</span><span class="s2">&quot;CC (box): &quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CC_box&#39;</span><span class="p">]</span>
        <span class="n">dictCC</span><span class="p">[</span><span class="s2">&quot;CC (volume): &quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CC_volume&#39;</span><span class="p">]</span>
        <span class="n">dictCC</span><span class="p">[</span><span class="s2">&quot;CC (peaks): &quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CC_peaks&#39;</span><span class="p">]</span>
        <span class="n">dictCC</span><span class="p">[</span><span class="s2">&quot;CC (main chain): &quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CC_main_chain&#39;</span><span class="p">]</span>
        <span class="n">dictCC</span><span class="p">[</span><span class="s2">&quot;CC (side chain): &quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;CC_side_chain&#39;</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.2</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Overall correlation coefficients&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Model vs. Data&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictCC</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_displayPlotChains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_displayPlotBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CCCHAINFILE</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_displayPlotResidues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_displayPlotBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CCRESIDUESFILE</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_exportFiles2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">Chain_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Chain_list&#39;</span><span class="p">]</span>
        <span class="n">CCCHAINFILE2NAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CCCHAINFILE2</span>
        <span class="k">def</span> <span class="nf">onSelect</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">dirName</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getPath</span><span class="p">()</span>
            <span class="n">Path</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{dirName}</span><span class="s2">/</span><span class="si">{fileName}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dirName</span><span class="o">=</span><span class="n">dirName</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="n">CCCHAINFILE2NAME</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;CC per chain</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">Chain_list</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_openBrowser</span><span class="p">(</span><span class="n">onSelect</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_exportFiles3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">Residue_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Residue_list&#39;</span><span class="p">]</span>
        <span class="n">CCRESIDUESFILE2NAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CCRESIDUESFILE2</span>
        <span class="n">chain</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Chains_list</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">selectChain</span><span class="o">.</span><span class="n">get</span><span class="p">()]</span>
        <span class="k">def</span> <span class="nf">onSelect</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">dirName</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getPath</span><span class="p">()</span>
            <span class="n">Path</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{dirName}</span><span class="s2">/</span><span class="si">{fileName}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dirName</span><span class="o">=</span><span class="n">dirName</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="n">CCRESIDUESFILE2NAME</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;CC per residue</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">Residue_list</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">chain</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span>
                                <span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="n">item</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_openBrowser</span><span class="p">(</span><span class="n">onSelect</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_openBrowser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">onSelect</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">pyworkflow.gui.browser</span> <span class="kn">import</span> <span class="n">FileBrowserWindow</span>
        <span class="n">browser</span> <span class="o">=</span> <span class="n">FileBrowserWindow</span><span class="p">(</span><span class="s2">&quot;Select a folder to save file&quot;</span><span class="p">,</span>
                                     <span class="n">master</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getWindow</span><span class="p">(),</span>
                                     <span class="n">path</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span>
                                     <span class="n">onSelect</span><span class="o">=</span><span class="n">onSelect</span><span class="p">,</span>
                                     <span class="n">onlyFolders</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">browser</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_showMapResolution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;Masked&#39;</span><span class="p">,</span> <span class="s1">&#39;Unmasked&#39;</span><span class="p">]</span>
        <span class="n">dataList1_1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Using map alone (d99): &quot;</span><span class="p">,</span> <span class="s2">&quot;Overall Biso: &quot;</span><span class="p">,</span> <span class="s2">&quot;d_model: &quot;</span><span class="p">,</span>
                     <span class="s2">&quot;d_model (B factors = 0): &quot;</span><span class="p">,</span> <span class="s2">&quot;FSC (model) = 0: &quot;</span><span class="p">,</span>
                     <span class="s2">&quot;FSC (model) = 0.143: &quot;</span><span class="p">,</span> <span class="s2">&quot;FSC (model) = 0.5: &quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol</span><span class="o">.</span><span class="n">getHalfMaps</span><span class="p">():</span>
            <span class="n">dataList1_2</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;d99 (half map 1): &quot;</span><span class="p">,</span> <span class="s2">&quot;d99 (half map 2): &quot;</span><span class="p">,</span>
                           <span class="s2">&quot;FSC (half map 1,2) = 0.143 (d_fsc): &quot;</span><span class="p">]</span>
        <span class="n">dataList1_3</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Mask smoothing radius (Angstroms): &quot;</span><span class="p">]</span>
        <span class="n">dataList2_1</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*d99_full_masked&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s2">&quot;overall_b_iso_masked&quot;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*dmodel_masked&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d_model_b0_masked&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*dFSCmodel_0_masked&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*dFSCmodel_0.143_masked&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*dFSCmodel_0.5_masked&#39;</span><span class="p">]]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol</span><span class="o">.</span><span class="n">getHalfMaps</span><span class="p">():</span>
            <span class="n">dataList2_2</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d99_half1_masked2&#39;</span><span class="p">],</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d99_half2_masked2&#39;</span><span class="p">],</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*dFSC_half_maps_0.143_masked&#39;</span><span class="p">]]</span>
        <span class="n">dataList2_3</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;mask_smoothing_radius&#39;</span><span class="p">]]</span>
        <span class="n">dataList3_1</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*d99_full_unmasked&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s2">&quot;overall_b_iso_unmasked&quot;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*dmodel_unmasked&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d_model_b0_unmasked&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*dFSCmodel_0_unmasked&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*dFSCmodel_0.143_unmasked&#39;</span><span class="p">],</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*dFSCmodel_0.5_unmasked&#39;</span><span class="p">]]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol</span><span class="o">.</span><span class="n">getHalfMaps</span><span class="p">():</span>
            <span class="n">dataList3_2</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d99_half1_unmasked2&#39;</span><span class="p">],</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d99_half2_unmasked2&#39;</span><span class="p">],</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;*dFSC_half_maps_0.143_unmasked&#39;</span><span class="p">]]</span>
        <span class="n">dataList3_3</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol</span><span class="o">.</span><span class="n">getHalfMaps</span><span class="p">():</span>
            <span class="n">dataList1</span> <span class="o">=</span> <span class="n">dataList1_1</span> <span class="o">+</span> <span class="n">dataList1_2</span> <span class="o">+</span> <span class="n">dataList1_3</span>
            <span class="n">dataList2</span> <span class="o">=</span> <span class="n">dataList2_1</span> <span class="o">+</span> <span class="n">dataList2_2</span> <span class="o">+</span> <span class="n">dataList2_3</span>
            <span class="n">dataList3</span> <span class="o">=</span> <span class="n">dataList3_1</span> <span class="o">+</span> <span class="n">dataList3_2</span> <span class="o">+</span> <span class="n">dataList3_3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dataList1</span> <span class="o">=</span> <span class="n">dataList1_1</span>  <span class="o">+</span> <span class="n">dataList1_3</span>
            <span class="n">dataList2</span> <span class="o">=</span> <span class="n">dataList2_1</span>  <span class="o">+</span> <span class="n">dataList2_3</span>
            <span class="n">dataList3</span> <span class="o">=</span> <span class="n">dataList3_1</span>  <span class="o">+</span> <span class="n">dataList3_3</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataList1</span><span class="p">,</span> <span class="n">dataList2</span><span class="p">,</span> <span class="n">dataList3</span><span class="p">):</span>
            <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">))</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Data&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Map Resolution (Angstroms) Estimates&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showMapStatistics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">]</span>
        <span class="n">dataList1</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Origin: &quot;</span><span class="p">,</span> <span class="s2">&quot;Last: &quot;</span><span class="p">,</span> <span class="s2">&quot;Focus: &quot;</span><span class="p">,</span>
                     <span class="s2">&quot;All: &quot;</span><span class="p">,</span> <span class="s2">&quot;Min, Max, Mean: &quot;</span><span class="p">]</span>
        <span class="n">dataList2</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_origin&#39;</span><span class="p">])),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_last&#39;</span><span class="p">])),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_focus&#39;</span><span class="p">])),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_all&#39;</span><span class="p">])),</span>
                     <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_min_max_mean&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">)]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dataList1</span><span class="p">,</span> <span class="n">dataList2</span><span class="p">):</span>
            <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">))</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Map Statistics&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Data&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showMapHistogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.80</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol</span><span class="o">.</span><span class="n">getHalfMaps</span><span class="p">():</span>
            <span class="n">splots</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_value&#39;</span><span class="p">])</span> <span class="o">==</span>
                    <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;HalfMap1_count&#39;</span><span class="p">]))</span>
            <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_value&#39;</span><span class="p">])</span> <span class="o">==</span>
                    <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;HalfMap2_count&#39;</span><span class="p">]))</span>

            <span class="n">p1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
            <span class="n">p1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_value&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_count&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Map&quot;</span><span class="p">)</span>
            <span class="n">splots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>

            <span class="n">p2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
            <span class="n">p2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_value&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;HalfMap1_count&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Half-map 1&quot;</span><span class="p">)</span>
            <span class="n">p2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_value&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;HalfMap2_count&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Half-map 2&quot;</span><span class="p">)</span>
            <span class="n">splots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">splots</span><span class="p">:</span>
                <span class="c1"># Place the legend to the upper right of this subplot</span>
                <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
                <span class="n">p</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Map value&#39;</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
                <span class="n">p</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Histogram of Map Values&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_value&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_count&#39;</span><span class="p">]))</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.975</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.80</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_value&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_count&#39;</span><span class="p">],</span>
                <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Map&quot;</span><span class="p">)</span>
            <span class="c1"># Place the legend to the upper right of this subplot</span>
            <span class="n">p</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
            <span class="n">p</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Map value&#39;</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Count&#39;</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
            <span class="n">p</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogram of Map Values&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_showMapHistValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Left</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Right</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Map_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_count&#39;</span><span class="p">]</span>
        <span class="n">slots</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;Map_slots&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">slots</span><span class="p">)):</span>
            <span class="n">slots_parts</span> <span class="o">=</span> <span class="n">slots</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">Left</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">slots_parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">4</span><span class="p">))</span>
            <span class="n">Right</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.4f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">slots_parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="mi">4</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vol</span><span class="o">.</span><span class="n">getHalfMaps</span><span class="p">():</span>
            <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Map_values&#39;</span><span class="p">,</span> <span class="s1">&#39;Map&#39;</span><span class="p">,</span> <span class="s1">&#39;Half-map 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Half-map 2&#39;</span><span class="p">]</span>
            <span class="n">HalfMap1_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;HalfMap1_count&#39;</span><span class="p">]</span>
            <span class="n">HalfMap2_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;HalfMap2_count&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                    <span class="n">Left</span><span class="p">,</span> <span class="n">Right</span><span class="p">,</span> <span class="n">Map_count</span><span class="p">,</span> <span class="n">HalfMap1_count</span><span class="p">,</span> <span class="n">HalfMap2_count</span><span class="p">):</span>
                <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;  -  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">a2</span><span class="p">),</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">a5</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Map_values&#39;</span><span class="p">,</span> <span class="s1">&#39;Map&#39;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Left</span><span class="p">,</span> <span class="n">Right</span><span class="p">,</span> <span class="n">Map_count</span><span class="p">):</span>
                <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;  -  &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">a2</span><span class="p">),</span> <span class="n">a3</span><span class="p">))</span>

        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Map Values (slots) vs. Map (count)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Data&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showPlotFSC1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">fsc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;FSC_Masked&#39;</span><span class="p">]</span>
        <span class="n">x_d_inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d_inv_Masked&#39;</span><span class="p">]</span>
        <span class="n">fsc_u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;FSC_Unmasked&#39;</span><span class="p">]</span>
        <span class="n">x_d_inv_u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d_inv_Unmasked&#39;</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="mf">0.143</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_plot</span><span class="p">(</span><span class="n">x_d_inv</span><span class="p">,</span> <span class="n">fsc</span><span class="p">,</span> <span class="n">x_d_inv_u</span><span class="p">,</span> <span class="n">fsc_u</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
                        <span class="n">label1</span><span class="o">=</span><span class="s2">&quot;Masked&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="o">=</span><span class="s2">&quot;Unmasked&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showPlotFSC2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">fsc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;FSC_Model_Map_Masked&#39;</span><span class="p">]</span>
        <span class="n">x_d_inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d_inv_Model_Map_Masked&#39;</span><span class="p">]</span>
        <span class="n">fsc_u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;FSC_Model_Map_Unmasked&#39;</span><span class="p">]</span>
        <span class="n">x_d_inv_u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d_inv_Model_Map_Unmasked&#39;</span><span class="p">]</span>
        <span class="n">d</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_show_plot</span><span class="p">(</span><span class="n">x_d_inv</span><span class="p">,</span> <span class="n">fsc</span><span class="p">,</span> <span class="n">x_d_inv_u</span><span class="p">,</span> <span class="n">fsc_u</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span>
                        <span class="n">label1</span><span class="o">=</span><span class="s2">&quot;Masked&quot;</span><span class="p">,</span> <span class="n">label2</span><span class="o">=</span><span class="s2">&quot;Unmasked&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_show_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">label1</span><span class="p">,</span> <span class="n">label2</span><span class="p">):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
        <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">l1</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label1</span><span class="p">)</span>
        <span class="n">l2</span><span class="p">,</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label2</span><span class="p">)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;FSC&quot;</span><span class="p">,</span>
                       <span class="n">fontproperties</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span>
                           <span class="n">family</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">],</span>
                           <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                           <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>

        <span class="n">xticks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">max_x</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x2</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">((</span><span class="nb">round</span><span class="p">(</span><span class="n">max_x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">/</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">xticks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>

        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;1/resolution (1/$\AA$)&#39;</span><span class="p">,</span>
                       <span class="n">fontproperties</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span>
                           <span class="n">family</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">],</span>
                           <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                           <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>
        <span class="n">labels1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xticks</span><span class="p">)):</span>
            <span class="n">labels1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">xticks</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels1</span><span class="p">,</span>
                            <span class="n">fontproperties</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span>
                                <span class="n">family</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Courier&#39;</span><span class="p">,</span> <span class="s1">&#39;Monaco&#39;</span><span class="p">,</span> <span class="s1">&#39;monospace&#39;</span><span class="p">],</span>
                                <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span>
                                <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">d</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0.5</span> <span class="ow">or</span> \
                <span class="p">(</span><span class="n">d</span> <span class="o">==</span> <span class="mf">0.143</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s2">&quot;HalfMapCC&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">1.</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">y1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">y1</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">x1</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>

        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;resolution ($\AA$)&#39;</span><span class="p">,</span>
                       <span class="n">fontproperties</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span>
                           <span class="n">family</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Helvetica&#39;</span><span class="p">,</span> <span class="s1">&#39;sans-serif&#39;</span><span class="p">],</span>
                           <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                           <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>

        <span class="n">labels2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xticks</span><span class="p">)):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">xticks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">xticks</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">labels2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.1f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\u221E</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels2</span><span class="p">,</span>
                            <span class="n">fontproperties</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">font_manager</span><span class="o">.</span><span class="n">FontProperties</span><span class="p">(</span>
                                <span class="n">family</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Courier&#39;</span><span class="p">,</span> <span class="s1">&#39;Monaco&#39;</span><span class="p">,</span> <span class="s1">&#39;monospace&#39;</span><span class="p">],</span>
                                <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span>
                                <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0.5</span> <span class="ow">or</span> \
                <span class="p">(</span><span class="n">d</span> <span class="o">==</span> <span class="mf">0.143</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s2">&quot;HalfMapCC&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="mf">1.</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">y2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span>
                <span class="n">b</span> <span class="o">=</span> <span class="n">y2</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">d</span>
                <span class="k">if</span> <span class="p">((</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)):</span>
                    <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">x2</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">((</span><span class="n">l2</span><span class="p">,</span> <span class="n">l1</span><span class="p">),</span> <span class="p">(</span><span class="n">label2</span><span class="p">,</span> <span class="n">label1</span><span class="p">),</span> <span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_exportFiles4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">fsc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;FSC_Masked&#39;</span><span class="p">]</span>
        <span class="n">x_d_inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d_inv_Masked&#39;</span><span class="p">]</span>
        <span class="n">fsc_u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;FSC_Unmasked&#39;</span><span class="p">]</span>
        <span class="n">x_d_inv_u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d_inv_Unmasked&#39;</span><span class="p">]</span>
        <span class="n">FILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FSCHALFMAPFILE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_export_file</span><span class="p">(</span><span class="n">fsc</span><span class="p">,</span> <span class="n">x_d_inv</span><span class="p">,</span> <span class="n">fsc_u</span><span class="p">,</span> <span class="n">x_d_inv_u</span><span class="p">,</span> <span class="n">FILENAME</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_exportFiles5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">fsc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;FSC_Model_Map_Masked&#39;</span><span class="p">]</span>
        <span class="n">x_d_inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d_inv_Model_Map_Masked&#39;</span><span class="p">]</span>
        <span class="n">fsc_u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;FSC_Model_Map_Unmasked&#39;</span><span class="p">]</span>
        <span class="n">x_d_inv_u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span><span class="p">[</span><span class="s1">&#39;d_inv_Model_Map_Unmasked&#39;</span><span class="p">]</span>
        <span class="n">FILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">FSCMODELMAPFILE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_export_file</span><span class="p">(</span><span class="n">fsc</span><span class="p">,</span> <span class="n">x_d_inv</span><span class="p">,</span> <span class="n">fsc_u</span><span class="p">,</span> <span class="n">x_d_inv_u</span><span class="p">,</span> <span class="n">FILENAME</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_export_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fsc</span><span class="p">,</span> <span class="n">x_d_inv</span><span class="p">,</span> <span class="n">fsc_u</span><span class="p">,</span> <span class="n">x_d_inv_u</span><span class="p">,</span> <span class="n">fileName</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">onSelect</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="n">dirName</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getPath</span><span class="p">()</span>
            <span class="n">Path</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">{dirName}</span><span class="s2">/</span><span class="si">{fileName}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dirName</span><span class="o">=</span><span class="n">dirName</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="n">fileName</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">Path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Unmasked</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39;d_inv&#39;</span> <span class="o">+</span> <span class="s1">&#39;            &#39;</span> <span class="o">+</span> <span class="s1">&#39;fsc&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_d_inv_u</span><span class="p">,</span> <span class="n">fsc_u</span><span class="p">):</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.12f</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.12f</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">))</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">Masked</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="s1">&#39;d_inv&#39;</span> <span class="o">+</span> <span class="s1">&#39;            &#39;</span> <span class="o">+</span> <span class="s1">&#39;fsc&#39;</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_d_inv</span><span class="p">,</span> <span class="n">fsc</span><span class="p">):</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">((</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.12f</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.12f</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_openBrowser</span><span class="p">(</span><span class="n">onSelect</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_writePickleData2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">VALIDATIONTMPFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">VALIDATIONTMPFILE</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">import pickle</span>
<span class="s2">import collections</span>
<span class="s2">import json</span>

<span class="s2">def pickleData(file):</span>
<span class="s2">    with open(file,&quot;r&quot;) as f:</span>
<span class="s2">        return pickle.load(f)</span>
<span class="s2">        </span>
<span class="s2"># process file </span><span class="si">{VALIDATIONCRYOEMPKLFILENAME}</span><span class="s2">&quot;</span>
<span class="s2">data = pickleData(&#39;</span><span class="si">{VALIDATIONCRYOEMPKLFILENAME}</span><span class="s2">&#39;)</span>
<span class="s2">dictOverall2 = collections.OrderedDict()</span>

<span class="s2"># composition</span>
<span class="s2">chain_names = []</span>
<span class="s2">for item in data.model_vs_data.cc.cc_per_chain:</span>
<span class="s2">    if item.chain_id not in chain_names:</span>
<span class="s2">        chain_names.append(item.chain_id)   </span>
<span class="s2">dictOverall2[&#39;Chains&#39;] = len(chain_names)</span>
<span class="s2">dictOverall2[&#39;Atoms&#39;] = data.model.composition.n_atoms</span>
<span class="s2">dictOverall2[&#39;Hydrogens&#39;] = data.model.composition.n_hd</span>
<span class="s2">dictOverall2[&#39;Protein_residues&#39;] = data.model.composition.n_protein</span>
<span class="s2">dictOverall2[&#39;Nucleotide_residues&#39;] = data.model.composition.n_nucleotide</span>
<span class="s2">dictOverall2[&#39;Water&#39;] = data.model.composition.n_water</span>

<span class="s2">Ligands = []</span>
<span class="s2">if data.model.composition.n_other != 0:</span>
<span class="s2">    for k, v  in data.model.composition.other_cnts.iteritems():</span>
<span class="s2">        Ligands.append(str(k) + &#39;: &#39; + str(v))</span>
<span class="s2">        dictOverall2[&#39;Ligands&#39;] = Ligands</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;Ligands&#39;] = &#39;---&#39;</span>
<span class="s2">        </span>
<span class="s2"># Bonds (RMSD)</span>
<span class="s2">dictOverall2[&#39;Length&#39;] = &quot;</span><span class="si">%.3f</span><span class="s2">&quot; % (round(data.model.geometry.bond.mean, 3))</span>
<span class="s2">dictOverall2[&#39;Length_outliers&#39;] = len(data.model.geometry.bond.outliers)</span>
<span class="s2">dictOverall2[&#39;BLRestraints&#39;] = data.model.geometry.bond.n</span>
<span class="s2">dictOverall2[&#39;BLMean&#39;] = data.model.geometry.bond.mean</span>
<span class="s2">dictOverall2[&#39;BLMax&#39;] = data.model.geometry.bond.max</span>
<span class="s2">dictOverall2[&#39;BLMin&#39;] = data.model.geometry.bond.min</span>
<span class="s2">dictOverall2[&#39;Angles&#39;] = &quot;</span><span class="si">%.3f</span><span class="s2">&quot; % (round(data.model.geometry.angle.mean, 3))</span>
<span class="s2">dictOverall2[&#39;Angles_outliers&#39;] = len(data.model.geometry.angle.outliers)</span>
<span class="s2">dictOverall2[&#39;BARestraints&#39;] = data.model.geometry.angle.n</span>
<span class="s2">dictOverall2[&#39;BAMean&#39;] = data.model.geometry.angle.mean</span>
<span class="s2">dictOverall2[&#39;BAMax&#39;] = data.model.geometry.angle.max</span>
<span class="s2">dictOverall2[&#39;BAMin&#39;] = data.model.geometry.angle.min</span>
<span class="s2">dictOverall2[&#39;Dihedral_outliers&#39;] = len(data.model.geometry.dihedral.outliers)</span>
<span class="s2">dictOverall2[&#39;DARestraints&#39;] = data.model.geometry.dihedral.n</span>
<span class="s2">dictOverall2[&#39;DAMean&#39;] = data.model.geometry.dihedral.mean</span>
<span class="s2">dictOverall2[&#39;DAMax&#39;] = data.model.geometry.dihedral.max</span>
<span class="s2">dictOverall2[&#39;DAMin&#39;] = data.model.geometry.dihedral.min</span>
<span class="s2">dictOverall2[&#39;ChiralityRestraints&#39;] = data.model.geometry.chirality.n</span>
<span class="s2">dictOverall2[&#39;ChiralityMean&#39;] = data.model.geometry.chirality.mean</span>
<span class="s2">dictOverall2[&#39;ChiralityMax&#39;] = data.model.geometry.chirality.max</span>
<span class="s2">dictOverall2[&#39;ChiralityMin&#39;] = data.model.geometry.chirality.min</span>
<span class="s2">dictOverall2[&#39;PlanarityRestraints&#39;] = data.model.geometry.planarity.n</span>
<span class="s2">dictOverall2[&#39;PlanarityMean&#39;] = data.model.geometry.planarity.mean</span>
<span class="s2">dictOverall2[&#39;PlanarityMax&#39;] = data.model.geometry.planarity.max</span>
<span class="s2">dictOverall2[&#39;PlanarityMin&#39;] = data.model.geometry.planarity.min</span>
<span class="s2">dictOverall2[&#39;ParallelityRestraints&#39;] = data.model.geometry.parallelity.n</span>
<span class="s2">dictOverall2[&#39;ParallelityMean&#39;] = data.model.geometry.parallelity.mean</span>
<span class="s2">dictOverall2[&#39;ParallelityMax&#39;] = data.model.geometry.parallelity.max</span>
<span class="s2">dictOverall2[&#39;ParallelityMin&#39;] = data.model.geometry.parallelity.min</span>
<span class="s2">dictOverall2[&#39;NonbondedRestraints&#39;] = data.model.geometry.nonbonded.n</span>
<span class="s2">dictOverall2[&#39;NonbondedMean&#39;] = data.model.geometry.nonbonded.mean</span>
<span class="s2">dictOverall2[&#39;NonbondedMax&#39;] = data.model.geometry.nonbonded.max</span>
<span class="s2">dictOverall2[&#39;NonbondedMin&#39;] = data.model.geometry.nonbonded.min</span>
<span class="s2">        </span>
<span class="s2"># MolProbity score</span>
<span class="s2">dictOverall2[&#39;MolProbity_score&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.molprobity_score, 2))</span>
<span class="s2">        </span>
<span class="s2"># Clash score</span>
<span class="s2">dictOverall2[&#39;Clash_score&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.clash.score, 2))</span>
<span class="s2">dictOverall2[&#39;Clashes_n_outliers&#39;] = data.model.geometry.clash.clashes.n_outliers</span>
<span class="s2">dictOverall2[&#39;Clashes_header&#39;] = data.model.geometry.clash.clashes.gui_list_headers</span>
<span class="s2">dictOverall2[&#39;Clashes_table&#39;] = data.model.geometry.clash.clashes.as_gui_table_data()</span>
<span class="s2">        </span>
<span class="s2"># Rhamachandran plot (%)</span>
<span class="s2">dictOverall2[&#39;Rhama_Outliers_n&#39;] = data.model.geometry.ramachandran.outliers</span>
<span class="s2">dictOverall2[&#39;Rhama_Outliers&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.ramachandran.outliers, 2))</span>
<span class="s2">dictOverall2[&#39;Rhama_Allowed&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.ramachandran.allowed, 2))</span>
<span class="s2">dictOverall2[&#39;Rhama_Favored&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.ramachandran.favored, 2))</span>
<span class="s2">dictOverall2[&#39;Rhama_header&#39;] = data.model.geometry.ramachandran.ramalyze.gui_list_headers</span>
<span class="s2">dictOverall2[&#39;Rhama_table&#39;] = data.model.geometry.ramachandran.ramalyze.as_gui_table_data()</span>
<span class="s2">        </span>
<span class="s2"># Rotamer outliers (%)</span>
<span class="s2">dictOverall2[&#39;Rota_Outliers_n&#39;] = data.model.geometry.rotamer.outliers</span>
<span class="s2">dictOverall2[&#39;Rota_Outliers&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.rotamer.outliers, 2))</span>
<span class="s2">dictOverall2[&#39;Rota_header&#39;] = data.model.geometry.rotamer.rotalyze.gui_list_headers</span>
<span class="s2">dictOverall2[&#39;Rota_table&#39;] = data.model.geometry.rotamer.rotalyze.as_gui_table_data()</span>
<span class="s2">        </span>
<span class="s2"># Cbeta outliers (%)</span>
<span class="s2">dictOverall2[&#39;Cbeta_Outliers_n&#39;] = data.model.geometry.c_beta.cbetadev.n_outliers</span>
<span class="s2">dictOverall2[&#39;Cbeta_Outliers&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.c_beta.outliers, 2))</span>
<span class="s2">dictOverall2[&#39;Cbeta_header&#39;] = data.model.geometry.c_beta.cbetadev.gui_list_headers</span>
<span class="s2">dictOverall2[&#39;Cbeta_table&#39;] = data.model.geometry.c_beta.cbetadev.as_gui_table_data()</span>
<span class="s2">        </span>
<span class="s2"># Peptide plane (%)</span>
<span class="s2">dictOverall2[&#39;Cis_proline&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.model.geometry.omega.cis_proline, 1))</span>
<span class="s2">dictOverall2[&#39;Cis_general&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.model.geometry.omega.cis_general, 1))</span>
<span class="s2">dictOverall2[&#39;Twisted_proline&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.model.geometry.omega.twisted_proline, 1))</span>
<span class="s2">dictOverall2[&#39;Twisted_general&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.model.geometry.omega.twisted_general, 1))</span>
<span class="s2">dictOverall2[&#39;Omega_outliers&#39;] = data.model.geometry.omega.omegalyze.n_outliers</span>
<span class="s2">dictOverall2[&#39;Omega_headers&#39;] = data.model.geometry.omega.omegalyze.gui_list_headers</span>
<span class="s2">dictOverall2[&#39;Omega_table&#39;] = data.model.geometry.omega.omegalyze.as_gui_table_data()</span>
<span class="s2">      </span>
<span class="s2"># CaBLAM outliers (%)</span>
<span class="s2">dictOverall2[&#39;CaBLAM_outliers_n&#39;] = data.model.geometry.cablam.outliers</span>
<span class="s2">dictOverall2[&#39;CaBLAM_outliers&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.cablam.outliers, 2))</span>
<span class="s2">dictOverall2[&#39;CaBLAM_disfavored&#39;] = round(data.model.geometry.cablam.disfavored, 2)</span>
<span class="s2">dictOverall2[&#39;CaBLAM_Calpha_outliers&#39;] = round(data.model.geometry.cablam.ca_outliers, 2)</span>
<span class="s2">dictOverall2[&#39;CaBLAM_header&#39;] = data.model.geometry.cablam.gui_table()[&#39;column_labels&#39;]</span>
<span class="s2">dictOverall2[&#39;CaBLAM_table&#39;] = data.model.geometry.cablam.gui_table()[&#39;data&#39;]</span>
<span class="s2">        </span>
<span class="s2"># ADP (B-factors)</span>
<span class="s2">dictOverall2[&#39;n_iso&#39;] = data.model.adp.overall.n_iso</span>
<span class="s2">dictOverall2[&#39;n_aniso&#39;] = data.model.adp.overall.n_aniso</span>
<span class="s2">#min/max/mean</span>
<span class="s2">if data.model.adp.protein is not None:</span>
<span class="s2">    dictOverall2[&#39;protein_min&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.protein.min, 2))</span>
<span class="s2">    dictOverall2[&#39;protein_max&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.protein.max, 2))</span>
<span class="s2">    dictOverall2[&#39;protein_mean&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.protein.mean, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;protein_min&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;protein_max&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;protein_mean&#39;] = &#39;---&#39;</span>
<span class="s2">if data.model.adp.nucleotide is not None:</span>
<span class="s2">    dictOverall2[&#39;nucleotide_min&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.nucleotide.min, 2))</span>
<span class="s2">    dictOverall2[&#39;nucleotide_max&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.nucleotide.max, 2))</span>
<span class="s2">    dictOverall2[&#39;nucleotide_mean&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.nucleotide.mean, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;nucleotide_min&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;nucleotide_max&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;nucleotide_mean&#39;] = &#39;---&#39;</span>
<span class="s2">if data.model.adp.other is not None:</span>
<span class="s2">    dictOverall2[&#39;other_min&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.other.min, 2))</span>
<span class="s2">    dictOverall2[&#39;other_max&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.other.max, 2))</span>
<span class="s2">    dictOverall2[&#39;other_mean&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.other.mean, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;other_min&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;other_max&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;other_mean&#39;] = &#39;---&#39;</span>
<span class="s2">if data.model.adp.water is not None:</span>
<span class="s2">   dictOverall2[&#39;water_min&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.water.min, 2))</span>
<span class="s2">   dictOverall2[&#39;water_max&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.water.max, 2))</span>
<span class="s2">   dictOverall2[&#39;water_mean&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.adp.water.mean, 2))</span>
<span class="s2">else:</span>
<span class="s2">   dictOverall2[&#39;water_min&#39;] = &#39;---&#39;</span>
<span class="s2">   dictOverall2[&#39;water_max&#39;] = &#39;---&#39;</span>
<span class="s2">   dictOverall2[&#39;water_mean&#39;] = &#39;---&#39;     </span>

<span class="s2"># Occupancy</span>
<span class="s2">dictOverall2[&#39;occupancy_mean&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.occupancy.mean, 2))</span>
<span class="s2">dictOverall2[&#39;occupancy_occ_1&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.occupancy.equal_to_1_fraction, 2))</span>
<span class="s2">dictOverall2[&#39;occupancy_0_occ_1&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.occupancy.between_0_and_1_fraction, 2))</span>
<span class="s2">dictOverall2[&#39;occupancy_occ_higher_1&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.occupancy.greater_than_1_fraction, 2))</span>
<span class="s2">        </span>
<span class="s2"># Box</span>
<span class="s2">lengths = []</span>
<span class="s2">for item in data.data.crystal_symmetry.unit_cell().parameters()[:3]:</span>
<span class="s2">    lengths.append(&quot;</span><span class="si">%.2f</span><span class="s2">&quot; </span><span class="si">% i</span><span class="s2">tem)</span>
<span class="s2">dictOverall2[&#39;Box_lengths&#39;] = str(lengths[0]) + &quot;, &quot; + str(lengths[1]) + &quot;, &quot; + str(lengths[2])</span>
<span class="s2">angles = []</span>
<span class="s2">for item in data.data.crystal_symmetry.unit_cell().parameters()[3:]:</span>
<span class="s2">    angles.append(&quot;</span><span class="si">%.2f</span><span class="s2">&quot; </span><span class="si">% i</span><span class="s2">tem)</span>
<span class="s2">dictOverall2[&#39;Box_angles&#39;] = str(angles[0]) + &quot;, &quot; + str(angles[1]) + &quot;, &quot; + str(angles[2])</span>
<span class="s2">dictOverall2[&#39;Unit cell&#39;] = str(data.data.crystal_symmetry.unit_cell().parameters())</span>
<span class="s2">dictOverall2[&#39;Space group&#39;] = str(data.data.crystal_symmetry.space_group().info().symbol_and_number())</span>
<span class="s2">        </span>
<span class="s2"># Supplied Resolution</span>
<span class="s2">dictOverall2[&#39;Supplied_Resolution&#39;] = round(data.model_vs_data.cc.atom_radius, 1)</span>
<span class="s2">        </span>
<span class="s2"># Resolution Estimates      Masked      Unmasked</span>
<span class="s2">if data.data.masked.d_fsc is not None:</span>
<span class="s2">    dictOverall2[&#39;dFSC_half_maps_0.143_masked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.masked.d_fsc, 1))</span>
<span class="s2">    dictOverall2[&#39;*dFSC_half_maps_0.143_masked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.masked.d_fsc, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;dFSC_half_maps_0.143_masked&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*dFSC_half_maps_0.143_masked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.unmasked.d_fsc is not None:</span>
<span class="s2">    dictOverall2[&#39;dFSC_half_maps_0.143_unmasked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.unmasked.d_fsc, 1))</span>
<span class="s2">    dictOverall2[&#39;*dFSC_half_maps_0.143_unmasked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.unmasked.d_fsc, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;dFSC_half_maps_0.143_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*dFSC_half_maps_0.143_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.masked.d99 is not None:</span>
<span class="s2">    dictOverall2[&#39;d99_full_masked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.masked.d99, 1))</span>
<span class="s2">    dictOverall2[&#39;*d99_full_masked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.masked.d99, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;d99_full_masked&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*d99_full_masked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.unmasked.d99 is not None:</span>
<span class="s2">    dictOverall2[&#39;d99_full_unmasked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.unmasked.d99, 1))</span>
<span class="s2">    dictOverall2[&#39;*d99_full_unmasked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.unmasked.d99, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;d99_full_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*d99_full_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.masked.d99_1 is not None:</span>
<span class="s2">    dictOverall2[&#39;d99_half1_masked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.masked.d99_1, 1))</span>
<span class="s2">    dictOverall2[&#39;d99_half1_masked2&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.masked.d99_1, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;d99_half1_masked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.unmasked.d99_1 is not None:</span>
<span class="s2">    dictOverall2[&#39;d99_half1_unmasked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.unmasked.d99_1, 1))</span>
<span class="s2">    dictOverall2[&#39;d99_half1_unmasked2&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.unmasked.d99_1, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;d99_half1_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.masked.d99_2 is not None:</span>
<span class="s2">    dictOverall2[&#39;d99_half2_masked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.masked.d99_2, 1))</span>
<span class="s2">    dictOverall2[&#39;d99_half2_masked2&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.masked.d99_2, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;d99_half2_masked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.unmasked.d99_2 is not None:</span>
<span class="s2">    dictOverall2[&#39;d99_half2_unmasked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.unmasked.d99_2, 1))</span>
<span class="s2">    dictOverall2[&#39;d99_half2_unmasked2&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.unmasked.d99_2, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;d99_half2_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.masked.d_model is not None:</span>
<span class="s2">    dictOverall2[&#39;dmodel_masked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.masked.d_model, 1))</span>
<span class="s2">    dictOverall2[&#39;*dmodel_masked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.masked.d_model, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;dmodel_masked&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*dmodel_masked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.unmasked.d_model is not None:</span>
<span class="s2">    dictOverall2[&#39;dmodel_unmasked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.unmasked.d_model, 1))</span>
<span class="s2">    dictOverall2[&#39;*dmodel_unmasked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.unmasked.d_model, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;dmodel_masked&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*dmodel_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.masked.d_model_b0 is not None:</span>
<span class="s2">   dictOverall2[&#39;d_model_b0_masked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.masked.d_model_b0, 2))</span>
<span class="s2">else:</span>
<span class="s2">   dictOverall2[&#39;d_model_b0_masked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.unmasked.d_model_b0 is not None:</span>
<span class="s2">   dictOverall2[&#39;d_model_b0_unmasked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.unmasked.d_model_b0, 2))</span>
<span class="s2">else:</span>
<span class="s2">   dictOverall2[&#39;d_model_b0_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.masked.d_fsc_model_0 is not None:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0_masked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.masked.d_fsc_model_0, 1))</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0_masked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.masked.d_fsc_model_0, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0_masked&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0_masked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.unmasked.d_fsc_model_0 is not None:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0_unmasked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.unmasked.d_fsc_model_0, 1))</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0_unmasked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.unmasked.d_fsc_model_0, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.masked.d_fsc_model_0143 is not None:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0.143_masked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.masked.d_fsc_model_0143, 1))</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0.143_masked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.masked.d_fsc_model_0143, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0.143_masked&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0.143_masked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.unmasked.d_fsc_model_0143 is not None:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0.143_unmasked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.unmasked.d_fsc_model_0143, 1))</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0.143_unmasked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.unmasked.d_fsc_model_0143, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0.143_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0.143_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.masked.d_fsc_model_05 is not None:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0.5_masked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.masked.d_fsc_model_05, 1))</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0.5_masked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.masked.d_fsc_model_05, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0.5_masked&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0.5_masked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.unmasked.d_fsc_model_05 is not None:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0.5_unmasked&#39;] = &quot;</span><span class="si">%.1f</span><span class="s2">&quot; % (round(data.data.unmasked.d_fsc_model_05, 1))</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0.5_unmasked&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.unmasked.d_fsc_model_05, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;dFSCmodel_0.5_unmasked&#39;] =&#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;*dFSCmodel_0.5_unmasked&#39;] = &#39;---&#39;</span>
<span class="s2">if data.data.masked.b_iso_overall is not None:</span>
<span class="s2">    dictOverall2[&quot;overall_b_iso_masked&quot;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.masked.b_iso_overall, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&quot;overall_b_iso_masked&quot;] = &#39;---&#39;</span>
<span class="s2">if data.data.unmasked.b_iso_overall is not None:</span>
<span class="s2">    dictOverall2[&quot;overall_b_iso_unmasked&quot;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.unmasked.b_iso_overall, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&quot;overall_b_iso_unmasked&quot;] = &#39;---&#39;</span>
<span class="s2">if data.data.masked.radius_smooth is not None:</span>
<span class="s2">    dictOverall2[&#39;mask_smoothing_radius&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.masked.radius_smooth, 2))</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;mask_smoothing_radius&#39;] = &#39;---&#39;</span>
<span class="s2">          </span>
<span class="s2"># Map statistics</span>
<span class="s2">dictOverall2[&#39;Map_min&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.counts.min_max_mean[0], 2))</span>
<span class="s2">dictOverall2[&#39;Map_max&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.counts.min_max_mean[1], 2))</span>
<span class="s2">dictOverall2[&#39;Map_mean&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.data.counts.min_max_mean[2], 2))</span>
<span class="s2">dictOverall2[&#39;Map_origin&#39;] = data.data.counts.origin</span>
<span class="s2">dictOverall2[&#39;Map_last&#39;] = data.data.counts.last</span>
<span class="s2">dictOverall2[&#39;Map_focus&#39;] = data.data.counts.focus</span>
<span class="s2">dictOverall2[&#39;Map_all&#39;] = data.data.counts.all</span>
<span class="s2">min = round(data.data.counts.min_max_mean[0], 3)</span>
<span class="s2">max = round(data.data.counts.min_max_mean[1], 3)</span>
<span class="s2">mean = round(data.data.counts.min_max_mean[2], 3)</span>
<span class="s2">dictOverall2[&#39;Map_min_max_mean&#39;] = (&quot;</span><span class="si">%.3f</span><span class="s2">, </span><span class="si">%.3f</span><span class="s2">, </span><span class="si">%.3f</span><span class="s2">&quot;) % (min, max, mean)</span>
<span class="s2">Map_value = []</span>
<span class="s2">for item in data.data.histograms.h_map.slot_centers():</span>
<span class="s2">    Map_value.append(item)</span>
<span class="s2">dictOverall2[&#39;Map_value&#39;] = Map_value   </span>
<span class="s2">Map_count = []</span>
<span class="s2">for item in data.data.histograms.h_map.slots():</span>
<span class="s2">    Map_count.append(item)</span>
<span class="s2">dictOverall2[&#39;Map_count&#39;] = Map_count</span>
<span class="s2">dictOverall2[&#39;Map_slots&#39;] = data.data.histograms.h_map.as_str() </span>
<span class="s2">if data.data.histograms.h_half_map_1 is not None:</span>
<span class="s2">    HalfMap1_count = []</span>
<span class="s2">    for item in data.data.histograms.h_half_map_1.slots():</span>
<span class="s2">        HalfMap1_count.append(item)</span>
<span class="s2">    dictOverall2[&#39;HalfMap1_count&#39;] = HalfMap1_count</span>
<span class="s2">if data.data.histograms.h_half_map_2 is not None:    </span>
<span class="s2">    HalfMap2_count = []</span>
<span class="s2">    for item in data.data.histograms.h_half_map_2.slots():</span>
<span class="s2">        HalfMap2_count.append(item)</span>
<span class="s2">    dictOverall2[&#39;HalfMap2_count&#39;] = HalfMap2_count</span>
<span class="s2">if data.data.histograms.half_map_histogram_cc is not None:</span>
<span class="s2">    dictOverall2[&quot;HalfMapCC&quot;] = data.data.histograms.half_map_histogram_cc</span>

<span class="s2"># FSC (Half-maps)</span>
<span class="s2">if data.data.masked.fsc_curve is not None:</span>
<span class="s2">    fsc_masked = []</span>
<span class="s2">    d_inv_masked = []</span>
<span class="s2">    for item in data.data.masked.fsc_curve.fsc.fsc:</span>
<span class="s2">        fsc_masked.append(item)</span>
<span class="s2">    dictOverall2[&#39;FSC_Masked&#39;] = fsc_masked</span>
<span class="s2">    for item in data.data.masked.fsc_curve.fsc.d_inv:</span>
<span class="s2">        d_inv_masked.append(item)</span>
<span class="s2">    dictOverall2[&#39;d_inv_Masked&#39;] = d_inv_masked</span>
<span class="s2">if data.data.unmasked.fsc_curve is not None:</span>
<span class="s2">    fsc_unmasked = []</span>
<span class="s2">    d_inv_unmasked = []</span>
<span class="s2">    for item in data.data.unmasked.fsc_curve.fsc.fsc:</span>
<span class="s2">        fsc_unmasked.append(item)</span>
<span class="s2">    dictOverall2[&#39;FSC_Unmasked&#39;] = fsc_unmasked</span>
<span class="s2">    for item in data.data.unmasked.fsc_curve.fsc.d_inv:</span>
<span class="s2">        d_inv_unmasked.append(item)</span>
<span class="s2">    dictOverall2[&#39;d_inv_Unmasked&#39;] = d_inv_unmasked</span>
<span class="s2">    </span>
<span class="s2"># FSC (Model-map)</span>
<span class="s2">if data.data.masked.fsc_curve_model.fsc is not None:</span>
<span class="s2">    fsc_model_map_masked = []</span>
<span class="s2">    d_inv_model_map_masked = []</span>
<span class="s2">    for item in data.data.masked.fsc_curve_model.fsc:</span>
<span class="s2">        fsc_model_map_masked.append(item)</span>
<span class="s2">    dictOverall2[&#39;FSC_Model_Map_Masked&#39;] = fsc_model_map_masked</span>
<span class="s2">    for item in data.data.masked.fsc_curve_model.d_inv:</span>
<span class="s2">        d_inv_model_map_masked.append(item)</span>
<span class="s2">    dictOverall2[&#39;d_inv_Model_Map_Masked&#39;] = d_inv_model_map_masked</span>
<span class="s2">if data.data.unmasked.fsc_curve_model.fsc is not None:</span>
<span class="s2">    fsc_model_map_unmasked = []</span>
<span class="s2">    d_inv_model_map_unmasked = []</span>
<span class="s2">    for item in data.data.unmasked.fsc_curve_model.fsc:</span>
<span class="s2">        fsc_model_map_unmasked.append(item)</span>
<span class="s2">    dictOverall2[&#39;FSC_Model_Map_Unmasked&#39;] = fsc_model_map_unmasked</span>
<span class="s2">    for item in data.data.unmasked.fsc_curve_model.d_inv:</span>
<span class="s2">        d_inv_model_map_unmasked.append(item)</span>
<span class="s2">    dictOverall2[&#39;d_inv_Model_Map_Unmasked&#39;] = d_inv_model_map_unmasked</span>
<span class="s2">               </span>
<span class="s2"># Model vs. Data</span>
<span class="s2">dictOverall2[&#39;CC_mask&#39;] = round(data.model_vs_data.cc.cc_mask, 2)</span>
<span class="s2">dictOverall2[&#39;CC_box&#39;] = round(data.model_vs_data.cc.cc_box, 2)</span>
<span class="s2">dictOverall2[&#39;CC_peaks&#39;] = round(data.model_vs_data.cc.cc_peaks, 2)</span>
<span class="s2">dictOverall2[&#39;CC_volume&#39;] = round(data.model_vs_data.cc.cc_volume, 2)</span>
<span class="s2">dictOverall2[&#39;CC_main_chain&#39;] = round(data.model_vs_data.cc.cc_main_chain.cc, 2)</span>
<span class="s2">try:  # skip if chain has no sidechains</span>
<span class="s2">    dictOverall2[&#39;CC_side_chain&#39;]= round(data.model_vs_data.cc.cc_side_chain.cc, 2)</span>
<span class="s2">except:</span>
<span class="s2">   pass</span>

<span class="s2"># Model structure</span>
<span class="s2">Chain_list = []</span>
<span class="s2">chain_names = []</span>
<span class="s2">for item in data.model_vs_data.cc.cc_per_chain:</span>
<span class="s2">    if item.chain_id not in chain_names:</span>
<span class="s2">        chain_names.append(item.chain_id)</span>
<span class="s2">        Chain_list.append((item.chain_id, item.cc))</span>
<span class="s2">        dictOverall2[&#39;Chain_list&#39;] = Chain_list</span>
<span class="s2">Residue_list = []</span>
<span class="s2">for item in data.model_vs_data.cc.cc_per_residue:</span>
<span class="s2">    Residue_list.append((item.model_id, item.chain_id, item.resseq, item.resname, item.cc))</span>
<span class="s2">    dictOverall2[&#39;Residue_list&#39;] = Residue_list</span>
<span class="s2">IUPAC_aminoacids_list = [&quot;ALA&quot;, &quot;CYS&quot;, &quot;ASP&quot;, &quot;GLU&quot;, &quot;PHE&quot;, &quot;GLY&quot;, &quot;HIS&quot;, &quot;ILE&quot;, &quot;LYS&quot;,</span>
<span class="s2">&quot;LEU&quot;, &quot;MET&quot;, &quot;ASN&quot;, &quot;PRO&quot;, &quot;GLN&quot;, &quot;ARG&quot;, &quot;SER&quot;, &quot;THR&quot;, &quot;VAL&quot;, &quot;TRP&quot;, &quot;TYR&quot;]</span>
<span class="s2">IUPAC_dna_list = [&quot;DA&quot;, &quot;DC&quot;, &quot;DG&quot;, &quot;DT&quot;]</span>
<span class="s2">IUPAC_rna_list = [&quot;A&quot;, &quot;C&quot;, &quot;G&quot;, &quot;U&quot;]</span>
<span class="s2">Ligand_CC = []</span>
<span class="s2">for item in data.model_vs_data.cc.cc_per_residue:</span>
<span class="s2">    if item.resname.strip() not in IUPAC_aminoacids_list:</span>
<span class="s2">        if item.resname.strip() not in IUPAC_dna_list:</span>
<span class="s2">            if item.resname.strip() not in IUPAC_rna_list:</span>
<span class="s2">                Ligand_CC.append(item.cc)</span>
<span class="s2">if len(Ligand_CC) &gt; 0:</span>
<span class="s2">    dictOverall2[&#39;Ligand_CC&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; </span><span class="si">% r</span><span class="s2">ound(sum(Ligand_CC)/len(Ligand_CC), 2)</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall2[&#39;Ligand_CC&#39;] = &quot;---&quot;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">VALIDATIONCRYOEMPKLFILENAME</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">VALIDATIONCRYOEMPKLFILENAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="n">PHENIXVERSION18</span><span class="p">:</span>
            <span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Rama-Z (Ramachandran plot Z-score, RMSD))</span>
<span class="s2">if data.model.geometry.rama_z is not None:</span>
<span class="s2">    dictOverall2[&#39;Rama_Z_whole_n&#39;] = &quot;</span><span class="si">%d</span><span class="s2">&quot; % (data.model.geometry.rama_z.whole.n)</span>
<span class="s2">    if data.model.geometry.rama_z.whole.n != 0:</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_whole_value&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; </span><span class="si">% a</span><span class="s2">bs(round(data.model.geometry.rama_z.whole.value, 2))</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_whole_std&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.rama_z.whole.std, 2))</span>
<span class="s2">    else:</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_whole_value&#39;] = &#39;---&#39;</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_whole_std&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;Rama_Z_helix_n&#39;] = &quot;</span><span class="si">%d</span><span class="s2">&quot; % (data.model.geometry.rama_z.helix.n)</span>
<span class="s2">    if data.model.geometry.rama_z.helix.n != 0:</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_helix_value&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; </span><span class="si">% a</span><span class="s2">bs(round(data.model.geometry.rama_z.helix.value, 2))</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_helix_std&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.rama_z.helix.std, 2))</span>
<span class="s2">    else:</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_sheet_n&#39;] = &#39;---&#39;</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_sheet_value&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;Rama_Z_sheet_n&#39;] = &quot;</span><span class="si">%d</span><span class="s2">&quot; % (data.model.geometry.rama_z.sheet.n)</span>
<span class="s2">    if data.model.geometry.rama_z.sheet.n != 0:</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_sheet_value&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; </span><span class="si">% a</span><span class="s2">bs(round(data.model.geometry.rama_z.sheet.value, 2))</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_sheet_std&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.rama_z.sheet.std, 2))</span>
<span class="s2">    else:</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_sheet_value&#39;] = &#39;---&#39;</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_sheet_std&#39;] = &#39;---&#39;</span>
<span class="s2">    dictOverall2[&#39;Rama_Z_loop_n&#39;] = &quot;</span><span class="si">%d</span><span class="s2">&quot; % (data.model.geometry.rama_z.loop.n)</span>
<span class="s2">    if data.model.geometry.rama_z.loop.n != 0:</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_loop_value&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; </span><span class="si">% a</span><span class="s2">bs(round(data.model.geometry.rama_z.loop.value, 2))</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_loop_std&#39;] = &quot;</span><span class="si">%.2f</span><span class="s2">&quot; % (round(data.model.geometry.rama_z.loop.std, 2))</span>
<span class="s2">    else:</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_loop_value&#39;] = &#39;---&#39;</span>
<span class="s2">        dictOverall2[&#39;Rama_Z_loop_value&#39;] = &#39;---&#39;</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;with open(&#39;</span><span class="si">%s</span><span class="s2">&#39;,&quot;w&quot;) as f:</span>
<span class="s2">    f.write(json.dumps(dictOverall2))</span>
<span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">VALIDATIONTMPFILENAME</span><span class="p">)</span>

        <span class="n">pythonFileName</span> <span class="o">=</span> <span class="n">VALIDATIONTMPFILENAME</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="c1"># write script file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pythonFileName</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="c1"># execute file with phenix.python</span>
        <span class="n">Plugin</span><span class="o">.</span><span class="n">runPhenixProgram</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">pythonFileName</span><span class="p">)</span>

        <span class="c1"># read file in scipion python</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">VALIDATIONTMPFILENAME</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="c1"># self.dataDict = json.loads(f.read())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_store</span><span class="p">()</span></div>








</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: release-3.0.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../../dependabot_pip_babel-2.9.1/index.html">dependabot/pip/babel-2.9.1</a></dd>
            <dd><a href="../../../../gh-pages/index.html">gh-pages</a></dd>
            <dd><a href="../../../../release-2.0.0/index.html">release-2.0.0</a></dd>
            <dd><a href="viewer_validation_cryoem.html">release-3.0.0</a></dd>
            <dd><a href="../../../../rsanchezgarc-patch-1/index.html">rsanchezgarc-patch-1</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>