.. _`compareInitialModel`:

Comparison of ModelAngelo generated models with the published traced atomic structure
=====================================================================================

In this section we are going to overlap the TACAN ModelAngelo derived structure with the structure already published and traced (`PDB 7F3U <https://www.rcsb.org/structure/7F3U>`_)
to interpret the same map (`EMD-31441 <https://www.ebi.ac.uk/emdb/EMD-31441>`_). Two different protocols can be used to overlap and visualize structures, **chimerax-operate** 
(Appendix :ref:`CHIMERA Operate <app:chimeraOperate>`), and **phenix-superpose pdbs** (Appendix :ref:`PHENIX Superpose PDBs <app:superposePdbsProtocol>`). Using these protocols we will cover 
steps 6, 7 and 8 of the general workflow (:numref:`model_building_modelangelo_fig1_workflow`), although the previous and common step 5 is required to import the atomic structure 7F3U.

To import in *Scipion* the atomic structure, open the protocol **import atomic structure** (Appendix :ref:`Import atomic structure <app:importAtomicStructure>`)  and complete 
the form including the PDB ID as indicated in :numref:`model_building_modelangelo_import_structure` (1).

  .. figure:: Images/Fig9_import_structure.svg
      :alt: Completing protocol **import atomic structure** with PDB ID (workflow step 5; :numref:`model_building_modelangelo_fig1_workflow`).
      :name: model_building_modelangelo_import_structure
      :align: center
      :width: 100.0%

      Completing protocol **import atomic structure** with PDB ID (workflow step 5; :numref:`model_building_modelangelo_fig1_workflow`).


Overlapping models in *ChimeraX* 
--------------------------------

Open the protocol **chimerax-operate** (Appendix :ref:`CHIMERA Operate <app:chimeraOperate>`) and fill in the form as indicated in 
:numref:`model_building_modelangelo_operate_1`. Complete the form with the atomic structure recently downloaded in *Scipion* (1) and a structure 
generated with ModelAngelo (2). In this case we have selected the pruned one obtained in step 3 of the general workflow 
(:numref:`model_building_modelangelo_fig1_workflow`). Then execute the protocol.

   .. figure:: Images/Fig10_chimerax_operate_1.svg
      :alt: Filling in the Scipion protocol **chimerax-operate** (workflow steps 6 and 7; :numref:`model_building_modelangelo_fig1_workflow`). 
      :name: model_building_modelangelo_operate_1
      :align: center
      :width: 100.0%

      Filling in the Scipion protocol **chimerax-operate** (workflow steps 6 and 7; :numref:`model_building_modelangelo_fig1_workflow`). 

*ChimeraX* :cite:p:`Goddard2018` GUI will open to show both atomic structures overlapped as shown in :numref:`model_building_modelangelo_operate_2`, C. 

   .. figure:: Images/Fig11_chimerax_operate_results_1.svg
      :alt: Atomic structures from PDB ID 7F3U (**A**), pruned ModelAngelo generated model in :numref:`model_building_modelangelo_results_1` (F) (**B**),
       and both models overlapped (**C**).
      :name: model_building_modelangelo_operate_2
      :align: center
      :width: 100.0%

      Atomic structures from PDB ID 7F3U (**A**), pruned ModelAngelo generated model in :numref:`model_building_modelangelo_results_1` (F) (**B**),
      and both models overlapped (**C**).

*ChimeraX* models #2 and #3 are the publised structure 7F3U and the pruned model generated by ModelAngelo, respectively. First, we can color model #3 
according to the values of the B-factor column using *AlphaFold* criteria writing in *ChimeraX* command line:

         ::

              color bfactor #3 palette alphafold

Although both structures are quite close, a perfect matching can be obtained writing in *ChimeraX* command line:

         ::

              mmaker #3 to #2

`mmaker <https://www.cgl.ucsf.edu/chimerax/docs/user/commands/matchmaker.html>`_ superimposes proteins or nuceic acids by fitting aligned residue 
pairs using one atom per residue. Then, model #3, sligthly moved to fit to model #2, can be saved in *Scipion* with the *ChimeraX* command line:

         ::

              scipionwrite #3 prefix modelangelo_structure_

With this superposition of structures we can inspect similarities and differences between the previously traced structure and the one predicted by ModelAngelo, 
in a similar way as we have done in :numref:`model_building_modelangelo_results_4`.

Overlapping models in *Phenix* 
------------------------------

**phenix-superpose pdbs** protocol (Appendix :ref:`PHENIX Superpose PDBs <app:superposePdbsProtocol>`) also allows superposing atomic structures 
using the *Phenix* function `superpose_pdbs <https://phenix-online.org/documentation/reference/superpose_pdbs.html>`_.

Open the protocol **phenix-superpose pdbs** and fill in the form as indicated in :numref:`model_building_modelangelo_superpose`. Complete the form with the atomic structure recently downloaded in *Scipion* (1) and a structure 
generated with ModelAngelo (2). In this case we have selected the pruned one obtained in step 3 of the general workflow 
(:numref:`model_building_modelangelo_fig1_workflow`). Remark that in this case the first structure will remain fixed and only the second one will move to fit to the first one. Then execute the protocol.

   .. figure:: Images/Fig12_phenix_superpose_pdbs.svg
      :alt: Filling in the *Scipion* protocol **phenix-superpose pdbs** (workflow step 8; :numref:`model_building_modelangelo_fig1_workflow`). 
      :name: model_building_modelangelo_superpose
      :align: center
      :width: 95.0%

      Filling in the *Scipion* protocol **phenix-superpose pdbs** (workflow step 8; :numref:`model_building_modelangelo_fig1_workflow`). 

After executing the protocol, output result can be visualized clicking **Analyze Results**. *ChimeraX* viewer will open and three overlapping models can be observed 
(:numref:`model_building_modelangelo_superpose_results`, A, E): The published atomic structure `7F3U <https://www.rcsb.org/structure/7F3U>`_, in blue, the pruned ModelAngelo generated structure, in purple, 
and the protocol output superposed structure, in orange.
   
   .. figure:: Images/Fig13_phenix_superpose_results.svg
      :alt: Output result from *Scipion* protocol **phenix-superpose pdbs**. **A**: Overlapped models 7F3U, pruned ModelAngelo prediction and superposed struture. **B**: 
       Overlapped models pruned ModelAngelo prediction and superposed struture. **C**: Pruned ModelAngelo prediction.  
       **D**: Ouput protocol superpose model. 
       **E**: *ChimeraX* Models panels. 
       **F**: Protocol summary detailing RMSD between fixed and moving atoms.
      :name: model_building_modelangelo_superpose_results
      :align: center
      :width: 100.0%

      Output result from *Scipion* protocol **phenix-superpose pdbs**. **A**: Overlapped models 7F3U, pruned ModelAngelo prediction and superposed struture. **B**: 
      Overlapped models pruned ModelAngelo prediction and superposed struture. **C**: Pruned ModelAngelo prediction.  
      **D**: Ouput protocol superpose model. 
      **E**: *ChimeraX* Models panels. 
      **F**: Protocol summary detailing RMSD between fixed and moving atoms.

Comparing the input pruned ModelAngelo prediction model and the output superposed one (:numref:`model_building_modelangelo_superpose_results`, C, D) we can observe 
that the superposed structure has been rotated 180 degrees regarding a vertical axis to get a fitting involving a higher number of residues. The correlation improvement
is detailed also in the protocol Summary (:numref:`model_building_modelangelo_superpose_results`, F).