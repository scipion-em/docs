

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>12. Structure validation and comparison &mdash; Scipion 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="13. Building the asymmetric unit" href="110-unitcell.html" />
    <link rel="prev" title="11. Refinement: Flexible fitting" href="090-flexibleFit.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/how-to-install.html">Installing Scipion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/host-configuration.html">Host configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user-documentation.html#tutorials">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../user-documentation.html#single-particle-tutorials">Single particle tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user-documentation.html#tomography-tutorials">Tomography tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../user-documentation.html#model-building">Model Building</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Model Building Tutorial</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="index.html#contents">Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#appendices">Appendices</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user-documentation.html#processing-how-to-s">Processing How To’s</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/facilities.html">On-the-fly processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/customize-report.html">Summary Reports</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/scipion-API.html">Scipion API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/plugins-API.html">Plugins API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/xmipp-API.html">Xmipp API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/contact-us.html">Contact Us</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Licences</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">Licenses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../user-documentation.html">Graphical interface manuals</a> &raquo;</li>
        
          <li><a href="index.html">Model Building Tutorial</a> &raquo;</li>
        
      <li><span class="section-number">12. </span>Structure validation and comparison</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/docs/user/tutorials/modelBuilding/100-validation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="structure-validation-and-comparison">
<span id="seq-structurevalidation"></span><h1><span class="section-number">12. </span>Structure validation and comparison<a class="headerlink" href="#structure-validation-and-comparison" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line">At the end of the refinement process of <em>metHgb</em> <span class="math">\alpha</span>
subunit (a similar one would be required for <span class="math">\beta</span> subunit),
we need to assess the geometry of our <em>model</em> regarding the
starting volume to detect <em>model</em> controversial elements or
<em>model</em> parameters that disagree with the map. Although each
refinement program has their own tools to assess the progress of
refinement (<em>Coot Validate</em> menu; <em>PHENIX real space refine</em> real space
correlations; <em>Refmac R factor</em> and <em>Rms BondLength</em>), in this tutorial
section, three assessment tools will be described to obtain
comparative validation values after using any protocol in the
workflow: Protocols <em>EMRinger</em> (<strong>phenix-emringer</strong>, Appendix <a class="reference internal" href="a120-emRingerProtocol.html#app-emringerprotocol"><span class="std std-ref">PHENIX EMRinger</span></a> <span id="id1">[<a class="reference internal" href="z010-references.html#id18" title="B. A. Barad, N. Echols, R. Y. Wang, Y. Cheng, F. DiMaio, P. D. Adams, and J. S. Fraser. EMRinger: side chain-directed model and map validation for 3D cryo-electron microscopy. Nat. Methods, 12(10):943–946, Oct 2015.">Barad <em>et al.</em>, 2015</a>]</span>), <em>MolProbity</em> (<strong>phenix-molprobity</strong>, Appendix <a class="reference internal" href="a130-molprobityProtocol.html#app-molprobityprotocol"><span class="std std-ref">PHENIX MolProbity</span></a> <span id="id2">[<a class="reference internal" href="z010-references.html#id19" title="I. W. Davis, L. W. Murray, J. S. Richardson, and D. C. Richardson. MOLPROBITY: structure validation and all-atom contact analysis for nucleic acids and their complexes. Nucleic Acids Res., 32(Web Server issue):W615–619, Jul 2004.">Davis <em>et al.</em>, 2004</a>]</span>), and <em>Validation CryoEM</em> (<strong>phenix-validation cryoem</strong>, Appendix <a class="reference internal" href="a131-valCryoEMProtocol.html#app-valcryoemprotocol"><span class="std std-ref">PHENIX Validation CryoEM</span></a> <span id="id3">[<a class="reference internal" href="z010-references.html#id20" title="P. V. Afonine, B. P. Klaholz, N. W. Moriarty, B. K. Poon, O. V. Sobolev, T. C. Terwilliger, P. D. Adams, and A. Urzhumtsev. New tools for the analysis and validation of cryo-EM maps and atomic models. Acta Crystallogr D Struct Biol, 74(Pt 9):814–840, Sep 2018.">Afonine <em>et al.</em>, 2018</a>]</span>). <em>Validation CryoEM</em> protocol will show <em>MolProbity</em> validation
values as well as correlation coefficients in real space. Old versions
of <em>PHENIX</em> (v. 1.13) do not include this tool. Correlation values in real
space will thus be computed if a map is provided in <em>MolProbity</em> protocol.
Additionally, we are going to introduce the protocol <strong>phenix-superpose pdbs</strong> (Appendix <a class="reference internal" href="a150-superposePdbsProtocol.html#app-superposepdbsprotocol"><span class="std std-ref">PHENIX Superpose PDBs</span></a> <span id="id4">[<a class="reference internal" href="z010-references.html#id21" title="P. Zwart, P. Afonine, and R.W. Grosse-Kunstleve. Superimposing two PDB files with superpose_pdbs. 2017. \url https://www.phenix-online.org/documentation/reference/superpose_pdbs.html, Accessed: 2018-10-31.">Zwart <em>et al.</em>, 2017</a>]</span>) useful to compare visually the geometry
of two atomic structures.</div>
</div>
<div class="line-block">
<div class="line">Observe the first validation steps in the modeling <em>Scipion</em> workflow in <a class="reference internal" href="#model-building-scipion-workflow-validation"><span class="std std-numref">Fig. 12.1</span></a>
starting from output <em>models</em> generated by <em>PHENIX real space refine</em> and <em>Refmac</em>.</div>
</div>
<div class="figure align-center" id="model-building-scipion-workflow-validation">
<a class="reference internal image-reference" href="../../../../_images/Fig69.svg"><img alt="*Scipion* framework detailing the workflow to validate the model of the human *Hgb* :math:`\alpha` subunit." src="../../../../_images/Fig69.svg" width="100.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 12.1 </span><span class="caption-text"><em>Scipion</em> framework detailing the workflow to validate the model of the human <em>Hgb</em> <span class="math">\alpha</span> subunit.</span><a class="headerlink" href="#model-building-scipion-workflow-validation" title="Permalink to this image">¶</a></p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">NOTE:</span></code> Structure validation is a model building step that you have to
perform recursively during the refinement process to assess if you are
improving your structure or not. Once you finish the refinement process
you’ll obtain the final assessment values. These values should be in a
certain range if you want to submit the atomic structure to databases.
These final validation scores should be computed regarding the density
map that you submit as main map, although during the recursive process
you might have used the sharpened maps for refinement/validation.</p>
<div class="section" id="emringer">
<span id="requestion4"></span><h2><span class="section-number">12.1. </span><em>EMRinger</em><a class="headerlink" href="#emringer" title="Permalink to this headline">¶</a></h2>
<p>Specifically designed for cryo-EM data, <em>EMRinger</em> tool assesses the appropriate
fitting of a model to a map, validating high-resolution features such as
side chain arrangements. The placement of side chains regarding the
molecule skeleton depends on the <span class="math">\chi_{1}</span> dihedral angle (a
dihedral angle is the angle between two intersecting planes), which is
determined by atomic positions of (<em>N</em>, <em>C</em><span class="math">\alpha</span>,
<em>C</em><span class="math">\beta</span>) and (<em>C</em><span class="math">\alpha</span>, <em>C</em><span class="math">\beta</span>,
<em>C</em><span class="math">\gamma</span>) (see <a class="reference internal" href="#model-building-emringer-chi1"><span class="std std-numref">Fig. 12.2</span></a>). The side chain dihedral angles tend to
cluster near <span class="math">180^\circ</span> and <span class="math">\pm60^\circ</span>. The lower
deviations regarding these values, the better <em>model</em>, and the <em>EMRinger</em>
higher value.</p>
<div class="figure align-center" id="model-building-emringer-chi1">
<a class="reference internal image-reference" href="../../../../_images/sidechains.svg"><img alt="Naming convention in side chains explained in a lysine-tyrosine strand. Note that these two residues are within a protein and thus have no terminal region." src="../../../../_images/sidechains.svg" width="65.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 12.2 </span><span class="caption-text">Naming convention in side chains explained in a lysine-tyrosine
strand. Note that these two residues are within a protein and thus
have no terminal region.</span><a class="headerlink" href="#model-building-emringer-chi1" title="Permalink to this image">¶</a></p>
</div>
<p>We can start assessing with <em>EMRinger</em> the <em>metHgb</em> <span class="math">\alpha</span> subunit
<em>models</em> that we have generated along the modeling workflow. In
each case, open the protocol <strong>phenix-emringer</strong> (<a class="reference internal" href="#model-building-emringer-protocol"><span class="std std-numref">Fig. 12.3</span></a> (1)), load the extracted map asymmetric
unit (initial or saved with <em>Coot</em>) (2) and the atomic structure that you’d
like to validate in relation to the map (3), execute the program (4) and
analyze results (5). A menu to check results in detail will be opened
(bar <em>EMRinger results</em>). <em>Phenix EMRinger</em> plots with density
thresholds, with rolling window for each chain, as well as dihedral
angles for each residue are shown here. The most relevant results,
especially the <em>EMRinger</em> score, will also be written in the protocol <em>SUMMARY</em>
(6).</p>
<div class="figure align-center" id="model-building-emringer-protocol">
<a class="reference internal image-reference" href="../../../../_images/Fig34.svg"><img alt="Completing *EMRinger* protocol form." src="../../../../_images/Fig34.svg" width="85.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 12.3 </span><span class="caption-text">Completing <em>EMRinger</em> protocol form.</span><a class="headerlink" href="#model-building-emringer-protocol" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line">Run <em>EMringer</em> protocol and determine the respective score after running <em>ChimeraX rigid
fit</em>, <em>Coot</em> refinement, <em>PHENIX real space refine</em> (form parameters indicated in <a class="reference internal" href="090-flexibleFit.html#model-building-phenix-real-space-refine-protocol"><span class="std std-numref">Fig. 11.9</span></a>)
after <em>Coot</em>, and <em>Refmac</em> refinement with MASK before and after <em>PHENIX real space refine</em>.
Considering <em>EMRinger score</em>, does our <em>metHgb</em> <span class="math">\alpha</span> subunit
<em>models</em> seem to be OK or, at least, did they improve? (Answers
in appendix <a class="reference internal" href="a010-answers.html#app-solutions"><span class="std std-ref">Solutions</span></a>; <a class="reference internal" href="a010-answers.html#question8"><span class="std std-ref">Question8</span></a>). Try the same validation with <span class="math">\beta</span> subunit <em>models</em>.</div>
</div>
</div>
<div class="section" id="molprobity">
<h2><span class="section-number">12.2. </span><em>MolProbity</em><a class="headerlink" href="#molprobity" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">The atomic structure validation web service <em>MolProbity</em>, with better reference
data has been implemented in the open-source CCTBX portion of PHENIX <span id="id5">[<a class="reference internal" href="z010-references.html#id22" title="C. J. Williams, J. J. Headd, N. W. Moriarty, M. G. Prisant, L. L. Videau, L. N. Deis, V. Verma, D. A. Keedy, B. J. Hintze, V. B. Chen, S. Jain, S. M. Lewis, W. B. Arendall, J. Snoeyink, P. D. Adams, S. C. Lovell, J. S. Richardson, and D. C. Richardson. MolProbity: More and better reference data for improved all-atom structure validation. Protein Sci., 27(1):293–315, 01 2018.">Williams <em>et al.</em>, 2018</a>]</span>. This widely used tool assesses <em>model</em> geometry and quality at both global and local levels.
Originally designed to evaluate structures coming from X-Ray
diffraction and NMR, it does not take into account the quality of the
fitting with a 3D density map. The implementation of <em>MolProbity</em> in <em>PHENIX</em>,
nevertheless, includes the possibility of adding a volume and
assessing the correlation in the real space.</div>
</div>
<div class="line-block">
<div class="line">The assessment process that we have carried out with <em>EMRinger</em> can also be done
with <em>MolProbity</em> in <em>Scipion</em>. We are going to validate the geometry of <em>metHgb</em>
<span class="math">\alpha</span> subunit <em>models</em> that we have generated along the
modeling workflow. In each case, open the <strong>phenix-molprobity</strong> protocol (<a class="reference internal" href="#model-building-molprobity-protocol"><span class="std std-numref">Fig. 12.4</span></a> (1)), load the
extracted unit cell volume (initial or generated by <em>Coot</em>) (2) with its
resolution (3) only if your <em>PHENIX</em> version is 1.13 and you want to have real
space correlation between map and <em>model</em>. For <em>PHENIX</em> versions higher
than 1.13 simply load the <em>model</em> atomic structure (4) and
execute the protocol (5). With <em>Analyze results</em> (6) menu bars are
shown. <em>MolProbity</em> results bar include validation statistics. Protocol <em>SUMMARY</em>
emphasizes the most relevant ones (7).</div>
</div>
<div class="figure align-center" id="model-building-molprobity-protocol">
<a class="reference internal image-reference" href="../../../../_images/Fig35.svg"><img alt="Completing *MolProbity* protocol form." src="../../../../_images/Fig35.svg" width="85.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 12.4 </span><span class="caption-text">Completing <em>MolProbity</em> protocol form.</span><a class="headerlink" href="#model-building-molprobity-protocol" title="Permalink to this image">¶</a></p>
</div>
<p>Run <em>MolProbity</em> protocol to obtain its statistics after running <em>ChimeraX rigid fit</em>, <em>Coot refinement</em>, <em>PHENIX real space refine</em> (form parameters indicated in <a class="reference internal" href="090-flexibleFit.html#model-building-phenix-real-space-refine-protocol"><span class="std std-numref">Fig. 11.9</span></a>) after <em>Coot</em>,
and <em>Refmac</em> refinement with MASK before and after <em>PHENIX real space refine</em>.</p>
</div>
<div class="section" id="validation-cryoem">
<span id="requestion5"></span><h2><span class="section-number">12.3. </span><em>Validation CryoEM</em><a class="headerlink" href="#validation-cryoem" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><em>PHENIX</em> versions higher than 1.13 combine multiple tools for validating
cryo-EM maps and models into the single tool called <em>Validation CryoEM</em> <span id="id6">[<a class="reference internal" href="z010-references.html#id20" title="P. V. Afonine, B. P. Klaholz, N. W. Moriarty, B. K. Poon, O. V. Sobolev, T. C. Terwilliger, P. D. Adams, and A. Urzhumtsev. New tools for the analysis and validation of cryo-EM maps and atomic models. Acta Crystallogr D Struct Biol, 74(Pt 9):814–840, Sep 2018.">Afonine <em>et al.</em>, 2018</a>]</span>. This tool has been implemented in <em>PHENIX</em>
versions higher than 1.13.</div>
</div>
<div class="line-block">
<div class="line">To carry out the global validation of maps and models obtained from
cryo-EM data, open the protocol <strong>phenix-validation cryoem</strong> in <em>Scipion</em> (<a class="reference internal" href="#model-building-validationcryoem-protocol"><span class="std std-numref">Fig. 12.5</span></a> (1)), load the <em>map</em> (initial or
generated by <em>Coot</em>) (2) with its resolution (3), load the <em>model</em>
atomic structure (4) and execute the protocol (5). <em>Analyze results</em> (6) shows the same menu bars available in results section of <em>PHENIX real space refine</em> protocol. <em>MolProbity</em> results bar include validation statistics.
Protocol <em>SUMMARY</em> (7) emphasizes the most relevant ones.</div>
</div>
<div class="figure align-center" id="model-building-validationcryoem-protocol">
<a class="reference internal image-reference" href="../../../../_images/Fig60.svg"><img alt="Filling in *PHENIX Validation CryoEM* protocol form." src="../../../../_images/Fig60.svg" width="90.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 12.5 </span><span class="caption-text">Filling in <em>PHENIX Validation CryoEM</em> protocol form.</span><a class="headerlink" href="#model-building-validationcryoem-protocol" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line">In order to compare validation results of :<em>models</em> obtained
along the modeling workflow, fill in the next table (<em>Table 2</em>) including, in
addition to <em>MolProbity</em> statistics, <em>EMRinger</em> scores and <em>CC(mask)</em> values obtained before. (Answers in
appendix <a class="reference internal" href="a010-answers.html#app-solutions"><span class="std std-ref">Solutions</span></a>; <a class="reference internal" href="a010-answers.html#question9"><span class="std std-ref">Question9</span></a>). The same table (<em>Table 2</em>) can be completed for <em>metHgb</em> <span class="math">\beta</span> subunit (Appendix <a class="reference internal" href="a010-answers.html#app-solutions"><span class="std std-ref">Solutions</span></a>; <a class="reference internal" href="a010-answers.html#question10"><span class="std std-ref">Question10</span></a>)</div>
</div>
<div class="figure align-center" id="model-building-table2">
<a class="reference internal image-reference" href="../../../../_images/Table2.svg"><img alt="Table2: Validation statistics of human *metHgb* :math:`\alpha` subunit *model*. *RSRAC* stands for *Real Space Refine* after *Coot*. *Rama* stands for *Ramachandran*." src="../../../../_images/Table2.svg" width="100.0%" /></a>
</div>
<div class="line-block">
<div class="line">Results compiled in this table indicate that statistics are
uncorrelated. From the point of view of correlation in real space, the
best <em>model</em> was obtained from <em>PHENIX real space refine</em> after <em>Coot</em>.
Considering <em>EMRinger score</em>, the best <em>model</em> derives from the whole
workflow <em>Coot-&gt; PHENIX real space refine</em>. With <em>MolProbity Overall score</em> as validation
rule, the last step in the workflow could be suppressed because the
best value was obtained after <em>Coot -&gt; PHENIX real space refine</em> (last
modification of parameters). We’d like to select the best
<em>model</em> and continue refining it in order to improve it as much
as possible. Assuming that no one <em>model</em> is perfect, how can we
select the best one?</div>
</div>
</div>
<div class="section" id="model-comparison">
<h2><span class="section-number">12.4. </span><em>Model</em> Comparison<a class="headerlink" href="#model-comparison" title="Permalink to this headline">¶</a></h2>
<p>The question posed in the previous item does not have an easy answer in
the real world, in which we do not know the final atomic structure. In
this tutorial, nevertheless, we know the atomic structure already
published for this cryo-EM map and we may wonder how far we are from it.
The question can be answered by comparing a) validation statistics that
we have obtained for our <em>models</em> with the statistics computed for
the available <span class="math">\alpha</span> subunit in <em>PDB</em> structure <em>5NI1</em>, and b)
the atomic structures themselves by overlapping.</p>
<div class="section" id="comparison-of-validation-statistics">
<h3><span class="section-number">12.4.1. </span>Comparison of validation statistics<a class="headerlink" href="#comparison-of-validation-statistics" title="Permalink to this headline">¶</a></h3>
<p>Validation statistics of <em>metHgb</em> <span class="math">\alpha</span> subunit of <em>PDB</em>
structure <em>5NI1</em> should be obtained as first step to compare them with
validation statistics of our <em>models</em>. With this aim we are going
to follow the workflow remarked in <a class="reference internal" href="#model-building-scipion-workflow-validation-2"><span class="std std-numref">Fig. 12.6</span></a>:</p>
<div class="figure align-center" id="model-building-scipion-workflow-validation-2">
<a class="reference internal image-reference" href="../../../../_images/Fig72.svg"><img alt="*Scipion* framework detailing the last part of the validation workflow." src="../../../../_images/Fig72.svg" width="100.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 12.6 </span><span class="caption-text"><em>Scipion</em> framework detailing the last part of the validation workflow.</span><a class="headerlink" href="#model-building-scipion-workflow-validation-2" title="Permalink to this image">¶</a></p>
</div>
<ul>
<li><div class="line-block">
<div class="line">Protocol <strong>import atomic structure</strong>:</div>
<div class="line">Download from <em>PDB</em> structure <em>5NI1</em></div>
</div>
</li>
<li><div class="line-block">
<div class="line">Protocol <strong>chimerax-operate</strong> (Appendix <a class="reference internal" href="a020-chimeraOperate.html#app-chimeraoperate"><span class="std std-ref">CHIMERAX operate</span></a>):</div>
<div class="line">Similar to <em>ChimeraX rigid fit</em>, <em>ChimeraX operate</em> protocol allows to perform
operations with atomic structures. We are going to use this
protocol to save independently in <em>Scipion</em> the <em>metHgb</em> <span class="math">\alpha</span>
subunit. Open the protocol (<a class="reference internal" href="#model-building-chimera-operate-protocol"><span class="std std-numref">Fig. 12.7</span></a> (1)), complete the parameter
<em>PDBx/mmCIF</em> including the atomic structure <em>5NI1</em> previously
imported (2), and execute the protocol (3).</div>
</div>
<div class="figure align-center" id="model-building-chimera-operate-protocol">
<a class="reference internal image-reference" href="../../../../_images/Fig36.svg"><img alt="Filling in **chimerax-operate** protocol form." src="../../../../_images/Fig36.svg" width="90.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 12.7 </span><span class="caption-text">Filling in <strong>chimerax-operate</strong> protocol form.</span><a class="headerlink" href="#model-building-chimera-operate-protocol" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line">The <em>ChimeraX</em> graphics window will be opened with the structure <em>5NI1</em> as
model number <em>#2</em>. To save independently the structure of human
<em>metHgb</em> <span class="math">\alpha</span> subunit (chain A), write in <em>ChimeraX</em> command line:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="c1">#2/A</span>
<span class="n">save</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="mi">5</span><span class="n">ni1_chainA</span><span class="o">.</span><span class="n">cif</span> <span class="nb">format</span> <span class="n">mmcif</span> <span class="n">models</span> <span class="c1">#2 selectedOnly true</span>
<span class="nb">open</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="mi">5</span><span class="n">ni1_chainA</span><span class="o">.</span><span class="n">cif</span>
<span class="n">scipionwrite</span> <span class="c1">#3 prefix 5ni1_chainA_</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">Remark that the model saved in <em>ChimeraX</em> command line includes both the
aminoacid chain and the <em>HEME</em> group. In case you are interested in
extracting only the aminoacid chain, you can use the protocol <strong>atomstructutils-operator</strong>,
specifically designed to extract/add individual chains from/to an
atomic structure (Appendix <a class="reference internal" href="a011-atomStructUtilsOperatorProtocol.html#app-atomstructutilsoperatorprotocol"><span class="std std-ref">Atomic Structure Chain Operator</span></a>).
Compare the results of protocols <em>ChimeraX operate</em> and Atomic Structure
Chain Operator in <a class="reference internal" href="#model-building-chimera-operate-protocol-2"><span class="std std-numref">Fig. 12.8</span></a>. The red arrow points at <em>HEME</em> group.</div>
</div>
<div class="figure align-center" id="model-building-chimera-operate-protocol-2">
<a class="reference internal image-reference" href="../../../../_images/Fig70.svg"><img alt="Comparison of results obtained with the protocols **chimerax-operate** (left) and **atomstructutils-operator** (right)." src="../../../../_images/Fig70.svg" width="75.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 12.8 </span><span class="caption-text">Comparison of results obtained with the protocols <strong>chimerax-operate</strong> (left) and <strong>atomstructutils-operator</strong> (right).</span><a class="headerlink" href="#model-building-chimera-operate-protocol-2" title="Permalink to this image">¶</a></p>
</div>
</li>
<li><p>Protocol <strong>phenix-dock in map</strong>:</p>
<div class="line-block">
<div class="line">Open <em>PHENIX dock in map</em> protocol and follow the instructions above
indicated. The structure saved in <em>ChimeraX operate</em> will replace this time
our previous <em>model</em>. Results can be observed in <a class="reference internal" href="#model-building-chimera-operate-protocol-3"><span class="std std-numref">Fig. 12.9</span></a>.</div>
</div>
<div class="figure align-center" id="model-building-chimera-operate-protocol-3">
<a class="reference internal image-reference" href="../../../../_images/Fig71.svg"><img alt="Results view of **phenix-dock in map** protocol." src="../../../../_images/Fig71.svg" width="70.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 12.9 </span><span class="caption-text">Results view of <strong>phenix-dock in map</strong> protocol.</span><a class="headerlink" href="#model-building-chimera-operate-protocol-3" title="Permalink to this image">¶</a></p>
</div>
</li>
<li><div class="line-block">
<div class="line">Protocol <strong>chimerax-rigid fit</strong>: Open again <em>ChimeraX rigid fit</em> protocol and, following the
already indicated instructions, include this time the atomic
structure <em>placed_model.cif</em> generated in the previous step. To fit
the <em>metHgb</em> <span class="math">\alpha</span> subunit from 5NI1 structure in the
extracted asymmetric unit and save the fitting write in <em>ChimeraX</em> command
line:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fitmap</span> <span class="c1">#3 inMap #2</span>
<span class="n">scipionwrite</span> <span class="c1">#3 prefix 5ni1_chainA_fitted_</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Validation protocols <strong>phenix-emringer</strong> and <strong>phenix-validation_cryoem</strong>:</p>
<p>Compute validation statistics with these two protocols for <em>metHgb</em>
<span class="math">\alpha</span> subunit from <em>PDB</em> structure <em>5NI1</em>, write respective
values in the previous table (Table 2), and compare them with the statistics
of our <em>models</em>.</p>
<div class="line-block">
<div class="line">Considering results shown in appendix <a class="reference internal" href="a010-answers.html#app-solutions"><span class="std std-ref">Solutions</span></a>; <a class="reference internal" href="a010-answers.html#question9"><span class="std std-ref">Question9</span></a>) for <em>metHgb</em> <span class="math">\alpha</span> subunit, we can conclude that published
structures are not perfect and we are not very far from this
published one. In fact, we have overcome every statistic except <em>CC(mask)</em>.
Nevertheless, the different <em>models</em> generated after <em>Coot</em>
refinement can still be improved by iterative refinement processes.
Validation statistics thus allow to follow the quality improvement
of atomic models.</div>
</div>
<p class="unnumbered rubric" id="comparison-of-atomic-structures">Comparison of atomic structures</p>
<p><em>PHENIX</em> protocol <strong>phenix-superpose pdbs</strong> allows to compare two atomic structures by overlapping them.
Root mean square deviation (RMSD) between the fixed structure (the
published one) and one of our <em>models</em> supports the
classification of <em>models</em> according to its similarity to the
published model. Open <em>PHENIX superpose pdbs</em> protocol form (<a class="reference internal" href="#model-building-superpose-pdbs-protocol"><span class="std std-numref">Fig. 12.10</span></a> (1)), include
the published structure of the <em>metHgb</em> <span class="math">\alpha</span> subunit as
fixed structure (2), each one of the <em>models</em> generated along
the worflow (3), execute the protocol (4) and check results by
pressing <em>Analyze results</em> (5). Arrows of <a class="reference internal" href="#model-building-superpose-pdbs-chimera"><span class="std std-numref">Fig. 12.11</span></a> remark differing parts between the atomic structure of the <em>metHgb</em> <span class="math">\alpha</span> subunit
from <em>PDB</em> structure <em>5NI1</em> (green) and our <em>model</em> generated
by automatic refinement with <em>PHENIX real space refine</em> protocol (pink). By opening these
structures in you can see the differences between them. Finally,
complete the Table 2 with the value of <em>RMSD (final)</em> (6) obtained for each
<em>model</em>. (Answers in appendix <a class="reference internal" href="a010-answers.html#app-solutions"><span class="std std-ref">Solutions</span></a>; <a class="reference internal" href="a010-answers.html#question9"><span class="std std-ref">Question9</span></a>).</p>
<div class="figure align-center" id="model-building-superpose-pdbs-protocol">
<a class="reference internal image-reference" href="../../../../_images/Fig37.svg"><img alt="Completing **phenix-superpose pdbs** protocol form." src="../../../../_images/Fig37.svg" width="90.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 12.10 </span><span class="caption-text">Completing <strong>phenix-superpose pdbs</strong> protocol form.</span><a class="headerlink" href="#model-building-superpose-pdbs-protocol" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="model-building-superpose-pdbs-chimera">
<a class="reference internal image-reference" href="../../../../_images/Fig38.svg"><img alt="*Model* generated for *metHgb* :math:`\alpha` subunit superposed to the published :math:`\alpha` chain of *5NI1* structure." src="../../../../_images/Fig38.svg" width="50.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 12.11 </span><span class="caption-text"><em>Model</em> generated for <em>metHgb</em> <span class="math">\alpha</span> subunit superposed to the published <span class="math">\alpha</span> chain of <em>5NI1</em> structure.</span><a class="headerlink" href="#model-building-superpose-pdbs-chimera" title="Permalink to this image">¶</a></p>
</div>
</li>
</ul>
<div class="line-block">
<div class="line">A <em>model</em> for <em>metHgb</em> <span class="math">\alpha</span> subunit has to be selected
at the end of the validation process. According to the statistics of Table 6
(Appendix <a class="reference internal" href="a010-answers.html#app-solutions"><span class="std std-ref">Solutions</span></a>; <a class="reference internal" href="a010-answers.html#question9"><span class="std std-ref">Question9</span></a>), select the <em>model</em> obtained in modeling workflow showing the smallest RMSD
value, high value of <em>EMRinger score</em>, quite high value of <em>CC(mask)</em> and acceptable <em>MolProbity</em>
statistics. Follow a similar process to validate and select the <em>model</em> generated for <em>metHgb</em> <span class="math">\beta</span> subunit. Appendix <a class="reference internal" href="a010-answers.html#app-solutions"><span class="std std-ref">Solutions</span></a>; <a class="reference internal" href="a010-answers.html#question10"><span class="std std-ref">Question10</span></a> contains a statistics table for <em>metHgb</em> <span class="math">\beta</span> subunit, similar to that obtained for <em>metHgb</em> <span class="math">\alpha</span> subunit.</div>
</div>
<div class="line-block">
<div class="line">In the real world the selected <em>models</em> usually are the starting
point to improve specific validation parameters by additional
refinement. Since the improvement of certain parameters normally
implies worsening of other parameters, a final compromise solution has
to be taken.</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="110-unitcell.html" class="btn btn-neutral float-right" title="13. Building the asymmetric unit" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="090-flexibleFit.html" class="btn btn-neutral float-left" title="11. Refinement: Flexible fitting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: release-3.0.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../../gh-pages/index.html">gh-pages</a></dd>
            <dd><a href="../../../../release-2.0.0/index.html">release-2.0.0</a></dd>
            <dd><a href="../../../../release-3.0.0/docs/user/tutorials/modelBuilding/100-validation.html">release-3.0.0</a></dd>
            <dd><a href="../../../../rm_model_building/docs/user/tutorials/modelBuilding/100-validation.html">rm_model_building</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>