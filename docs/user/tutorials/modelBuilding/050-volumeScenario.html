

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>7. 3D Map preprocessing &mdash; Scipion 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="8. Structure Prediction by Sequence Homology. Searching for Homologues" href="060-sequenceScenario.html" />
    <link rel="prev" title="6. Import Input data" href="040-importInputData.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/how-to-install.html">Installing Scipion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/host-configuration.html">Host configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user-documentation.html#tutorials">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../user-documentation.html#single-particle-tutorials">Single particle tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user-documentation.html#tomography-tutorials">Tomography tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../user-documentation.html#model-building">Model Building</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Model Building Tutorial</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="index.html#this-tutorial-is-work-in-progress">THIS TUTORIAL Is WORK IN PROGRESS</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html#contents">Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#appendices">Appendices</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user-documentation.html#processing-how-to-s">Processing How To’s</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/facilities.html">On-the-fly processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/customize-report.html">Summary Reports</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/scipion-API.html">Scipion API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/plugins-API.html">Plugins API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/xmipp-API.html">Xmipp API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/contact-us.html">Contact Us</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Licences</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">Licenses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../user-documentation.html">Graphical interface manuals</a> &raquo;</li>
        
          <li><a href="index.html">Model Building Tutorial</a> &raquo;</li>
        
      <li><span class="section-number">7. </span>3D Map preprocessing</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/docs/user/tutorials/modelBuilding/050-volumeScenario.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="d-map-preprocessing">
<h1><span class="section-number">7. </span>3D Map preprocessing<a class="headerlink" href="#d-map-preprocessing" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#model-building-scipion-workflow-import-2"><span class="std std-numref">Fig. 7.1</span></a> shows the workflow that we are going to detail in this section.</p>
<div class="figure align-center" id="model-building-scipion-workflow-import-2">
<a class="reference internal image-reference" href="../../../../_images/Fig62.svg"><img alt="*Scipion* framework detailing the workflow generated after 3D map preprocessing." src="../../../../_images/Fig62.svg" width="95.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.1 </span><span class="caption-text"><em>Scipion</em> framework detailing the workflow generated after 3D map
preprocessing.</span><a class="headerlink" href="#model-building-scipion-workflow-import-2" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="map-sharpening">
<h2><span class="section-number">7.1. </span>Map sharpening<a class="headerlink" href="#map-sharpening" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">As we have indicated before, since map sharpening contributes to
increase signal at medium/high resolution, we recommend to perform
this map preprocessing step before tracing the atomic model of cryo-EM
3D maps <span id="id1">[<a class="reference internal" href="z010-references.html#id7" title="Erney Ramírez-Aportela, Jose Luis Vilas, Roberto Melero, Pablo Conesa, Marta Martínez, David Maluenda, Javier Mota, Amaya Jiménez, Javier Vargas, Roberto Marabini, Jose Maria Carazo, and Carlos Oscar S. Sorzano. Automatic local resolution-based sharpening of cryo-em maps. bioRxiv, 2018. URL: https://www.biorxiv.org/content/early/2018/10/02/433284, arXiv:https://www.biorxiv.org/content/early/2018/10/02/433284.full.pdf, doi:10.1101/433284.">Ramírez-Aportela <em>et al.</em>, 2018</a>]</span>. To accomplish this task a
couple of automatic alternatives are available in : a) local
sharpening method independent of initial model, based on local
resolution estimation (<span id="id2">[<a class="reference internal" href="z010-references.html#id7" title="Erney Ramírez-Aportela, Jose Luis Vilas, Roberto Melero, Pablo Conesa, Marta Martínez, David Maluenda, Javier Mota, Amaya Jiménez, Javier Vargas, Roberto Marabini, Jose Maria Carazo, and Carlos Oscar S. Sorzano. Automatic local resolution-based sharpening of cryo-em maps. bioRxiv, 2018. URL: https://www.biorxiv.org/content/early/2018/10/02/433284, arXiv:https://www.biorxiv.org/content/early/2018/10/02/433284.full.pdf, doi:10.1101/433284.">Ramírez-Aportela <em>et al.</em>, 2018</a>]</span> (Appendix <a class="reference internal" href="a101-localDeblurSharpening.html#app-localdeblursharpening"><span class="std std-ref">Local Deblur</span></a>)), b)
deep learning-based sharpening approach (<span id="id3">[<a class="reference internal" href="z010-references.html#id6" title="R Sanchez-Garcia, J Gomez-Blanco, A Cuervo, JM Carazo, COS Sorzano, and J Vargas. Deepemhancer: a deep learning solution for cryo-em volume post-processing. bioRxiv, 2020. URL: https://www.biorxiv.org/content/early/2020/08/17/2020.06.12.148296, arXiv:https://www.biorxiv.org/content/early/2020/08/17/2020.06.12.148296.full.pdf, doi:10.1101/2020.06.12.148296.">Sanchez-Garcia <em>et al.</em>, 2020</a>]</span> (Appendix
<a class="reference internal" href="a062-deepEMhancerSharpening.html#app-deepemhancersharpening"><span class="std std-ref">DeepEMhancer</span></a>)).
Although both sharpening methods display good results, these are not
identical but complementary since <em>LocalDeblur</em> maximizes
specially details like the secondary structure, whereas
<em>DeepEMhancer</em> maximizes connectivity, favoring the fair tracing
of the molecule skeleton.</div>
<div class="line">Although the common first rule in both sharpening strategies is
counting on half maps to get the best performance of the methods, or
the average raw map otherwise, exceptionally in this case, to
illustrate the procedure we are going to use the final postprocessed
map deposited in the database, where no half maps have been submitted
together with the final map.</div>
</div>
<div class="section" id="a-sharpening-with-localdeblur">
<h3><span class="section-number">7.1.1. </span>a) Sharpening with <span class="math">LocalDeblur</span><a class="headerlink" href="#a-sharpening-with-localdeblur" title="Permalink to this headline">¶</a></h3>
<div class="line-block">
<div class="line">Since <span class="math">LocalDeblur</span> takes advantage of map local resolution to
increase the signal, we have to compute this local resolution as first
step to apply the <span class="math">LocalDeblur</span> sharpening method. Although
different algorithms could be used to compute local resolution, we
have selected <span class="math">MonoRes</span> <span id="id4">[<a class="reference internal" href="z010-references.html#id5" title="Jose Luis Vilas, Josué Gómez-Blanco, Pablo Conesa, Roberto Melero, José Miguel de la Rosa-Trevín, Joaquin Otón, Jesús Cuenca, Roberto Marabini, José María Carazo, Javier Vargas, and others. Monores: automatic and accurate estimation of local resolution for electron microscopy maps. Structure, 26(2):337–344, 2018.">Vilas <em>et al.</em>, 2018</a>]</span>,
implemented in in the protocol <strong>xmipp-local MonoRes</strong> (Appendix <a class="reference internal" href="a102-localMonoRes.html#app-localmonores"><span class="std std-ref">Local MonoRes</span></a>).</div>
<div class="line">Since a map binary mask has optionally to be included as a parameter
in this protocol, we will build a mask by using the <em>Scipion</em> protocol <strong>xmipp-create 3d mask</strong> (Appendix <a class="reference internal" href="a061-create3DMask.html#app-create3dmask"><span class="std std-ref">Create 3D mask</span></a>) as starting step in the
local resolution estimation process. Open the protocol form (<a class="reference internal" href="#model-building-create3dmask-1"><span class="std std-numref">Fig. 7.2</span></a> (1)) and
fill in the tap <em>Mask generation</em> (2) with the input volume (3) and the density
threshold (4). By default, the level value observed in <em>ChimeraX</em> main graphics
window (<a class="reference internal" href="040-importInputData.html#model-building-visualization-volume"><span class="std std-numref">Fig. 6.3</span></a>) <em>Tools →  Volume Data → Volume Viewer → Level</em> can be selected as threshold. In the <em>Postprocessing</em> tap (<a class="reference internal" href="#model-building-create3dmask-1"><span class="std std-numref">Fig. 7.2</span></a> (5)), select <em>Yes</em> in <em>Apply morphological operation</em> (6) and maintain the rest of options by default. After executing this
protocol (<a class="reference internal" href="#model-building-create3dmask-1"><span class="std std-numref">Fig. 7.2</span></a> (7)), the morphology of the mask generated can be checked
in slices by clicking <em>Analyze Results</em> (8).</div>
</div>
<div class="figure align-center" id="model-building-create3dmask-1">
<a class="reference internal image-reference" href="../../../../_images/Fig53.svg"><img alt="Filling in the protocol to create a mask of the initial volume." src="../../../../_images/Fig53.svg" width="95.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.2 </span><span class="caption-text">Filling in the protocol to create a mask of the initial volume.</span><a class="headerlink" href="#model-building-create3dmask-1" title="Permalink to this image">¶</a></p>
</div>
<p><span class="math">ShowJ</span>, the default viewer, allows visualize the mask with shape
similar to the starting volume (<a class="reference internal" href="#model-building-create3dmask-2"><span class="std std-numref">Fig. 7.3</span></a>).</p>
<div class="figure align-center" id="model-building-create3dmask-2">
<a class="reference internal image-reference" href="../../../../_images/Fig54.svg"><img alt="Visualizing the mask of the initial volume." src="../../../../_images/Fig54.svg" width="60.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.3 </span><span class="caption-text">Visualizing the mask of the initial volume.</span><a class="headerlink" href="#model-building-create3dmask-2" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">NOTE:</span></code> In case you would like to use a previous computed mask, you can do
it simply by importing it using the protocol <strong>import mask</strong> (Appendix <a class="reference internal" href="a091-importMask.html#app-importmask"><span class="std std-ref">Import mask</span></a>).</div>
</div>
<div class="line-block">
<div class="line">Once the mask of the starting map has been created, the protocol of <strong>xmipp-local MonoRes</strong>
can be completed to get the estimation of local resolution. Open the
protocol (<a class="reference internal" href="#model-building-localmonores-1"><span class="std std-numref">Fig. 7.4</span></a> (1)) and include the starting map (2), as well as the
binary mask (3). Finally, based on the map resolution (3.2 Å), select
the default resolution range between <em>0.0</em> and <em>6.0</em> Å (4).</div>
</div>
<div class="figure align-center" id="model-building-localmonores-1">
<a class="reference internal image-reference" href="../../../../_images/Fig55.svg"><img alt="Completing the protocol to estimate the local resolution of the map." src="../../../../_images/Fig55.svg" width="100.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.4 </span><span class="caption-text">Completing the protocol to estimate the local resolution of the <em>metHgb</em> map.</span><a class="headerlink" href="#model-building-localmonores-1" title="Permalink to this image">¶</a></p>
</div>
<p>Execute this protocol (<a class="reference internal" href="#model-building-localmonores-1"><span class="std std-numref">Fig. 7.4</span></a> (5)) and analyze the results (6). The menu of
results (<a class="reference internal" href="#model-building-localmonores-2"><span class="std std-numref">Fig. 7.5</span></a> (A)), among other views, shows the histogram of local
resolutions (1) and the resolution map in (2). The histogram of
resolutions, which displays the number of map voxels showing a certain
resolution, allows to conclude that the majority of voxels evidence a
resolution between 3.2 and 3.5 Å, quite close to the published map
resolution (3.2 Å). The resolution map shown by <em>ChimeraX</em> details the resolution of
each voxel (<a class="reference internal" href="#model-building-localmonores-3"><span class="std std-numref">Fig. 7.6</span></a>). The bar on the left indicates the color code for
resolution values.</p>
<div class="figure align-center" id="model-building-localmonores-2">
<a class="reference internal image-reference" href="../../../../_images/Fig56.svg"><img alt="**xmipp3-local MonoRes** menu of results (A) and histogram of resolutions (B)." src="../../../../_images/Fig56.svg" width="80.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.5 </span><span class="caption-text"><strong>xmipp3-local MonoRes</strong> menu of results (A) and histogram of resolutions (B).</span><a class="headerlink" href="#model-building-localmonores-2" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-center" id="model-building-localmonores-3">
<a class="reference internal image-reference" href="../../../../_images/Fig57.svg"><img alt="Resolution map in *ChimeraX*." src="../../../../_images/Fig57.svg" width="70.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.6 </span><span class="caption-text">Resolution map in <em>ChimeraX</em>.</span><a class="headerlink" href="#model-building-localmonores-3" title="Permalink to this image">¶</a></p>
</div>
<p>Local resolution values of the input map allow to compute the sharpened
map by the <strong>xmipp3-localdeblur sharpening</strong> protocol, which implements an iterative steep descending
method that doesn’t require initial model. To accomplish this step, open
the protocol (<a class="reference internal" href="#model-building-localdeblur-1"><span class="std std-numref">Fig. 7.7</span></a> (1)) and include the starting map (2) and the map of
resolution values (3), maintaining the default values for the rest of
parameters (4, 5).</p>
<div class="figure align-center" id="model-building-localdeblur-1">
<a class="reference internal image-reference" href="../../../../_images/Fig58.svg"><img alt="Filling in the protocol to compute the sharpened map." src="../../../../_images/Fig58.svg" width="100.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.7 </span><span class="caption-text">Filling in the protocol to compute the sharpened map.</span><a class="headerlink" href="#model-building-localdeblur-1" title="Permalink to this image">¶</a></p>
</div>
<p>After two iterations, the sharpening algorithm reached the convergence
criterion, <em>i.e.</em> a difference between two successive iterations
lower than 1%, and stopped. The two maps obtained in the respective
iterations can be observed with <span class="math">ShowJ</span> by clicking the black
arrow shown in <a class="reference internal" href="#model-building-localdeblur-1"><span class="std std-numref">Fig. 7.7</span></a> (7) with the right mouse botton and selecting <em>Open with DataViewer</em>. Resulting
map for each iteration will be shown, as indicated in <a class="reference internal" href="#model-building-localdeblur-2"><span class="std std-numref">Fig. 7.8</span></a>. Visualization in <em>ChimeraX</em> is also possible selecting <em>Open</em> in the menu option <em>File</em> (<a class="reference internal" href="#model-building-localdeblur-2"><span class="std std-numref">Fig. 7.8</span></a> (1)).</p>
<div class="figure align-center" id="model-building-localdeblur-2">
<a class="reference internal image-reference" href="../../../../_images/Fig59.svg"><img alt="Sharpened maps generated after two iterations." src="../../../../_images/Fig59.svg" width="65.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.8 </span><span class="caption-text">Sharpened maps generated after two iterations.</span><a class="headerlink" href="#model-building-localdeblur-2" title="Permalink to this image">¶</a></p>
</div>
<p>Additionally, by clicking <em>Analyze Results</em> (<a class="reference internal" href="#model-building-localdeblur-1"><span class="std std-numref">Fig. 7.7</span></a> (6)) the sharpened map obtained after the
second iteration, <em>i.e.</em> the <em>last</em> map, can be also visualized and
compared with the initial one in <em>ChimeraX</em> (<a class="reference internal" href="#model-building-localdeblur-3"><span class="std std-numref">Fig. 7.9</span></a>).</p>
<div class="figure align-center" id="model-building-localdeblur-3">
<a class="reference internal image-reference" href="../../../../_images/Fig64.svg"><img alt=":math:`LocalDeblur` iteration sharpened map (yellow surface) and input map (grey mesh) in ." src="../../../../_images/Fig64.svg" width="65.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.9 </span><span class="caption-text"><span class="math">LocalDeblur</span> <em>last</em> iteration sharpened map (yellow surface) and
input map (grey mesh) in <em>ChimeraX</em>.</span><a class="headerlink" href="#model-building-localdeblur-3" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="b-sharpening-with-deepemhancer">
<h3><span class="section-number">7.1.2. </span>b) Sharpening with <span class="math">DeepEMhancer</span><a class="headerlink" href="#b-sharpening-with-deepemhancer" title="Permalink to this headline">¶</a></h3>
<p><span class="math">DeepEMhancer</span> is an alternative automatic sharpening method based
on deep learning <span id="id5">[<a class="reference internal" href="z010-references.html#id6" title="R Sanchez-Garcia, J Gomez-Blanco, A Cuervo, JM Carazo, COS Sorzano, and J Vargas. Deepemhancer: a deep learning solution for cryo-em volume post-processing. bioRxiv, 2020. URL: https://www.biorxiv.org/content/early/2020/08/17/2020.06.12.148296, arXiv:https://www.biorxiv.org/content/early/2020/08/17/2020.06.12.148296.full.pdf, doi:10.1101/2020.06.12.148296.">Sanchez-Garcia <em>et al.</em>, 2020</a>]</span>, implemented in <em>Scipion</em> in the protocol <strong>xmipp3-deepEMhancer</strong> (Appendix <a class="reference internal" href="a062-deepEMhancerSharpening.html#app-deepemhancersharpening"><span class="std std-ref">DeepEMhancer</span></a>). Open
this protocol (<a class="reference internal" href="#model-building-deepemhancer-1"><span class="std std-numref">Fig. 7.10</span></a> (1)) and complete it as indicated. Since only the
refined map is available, we are not going to use half maps (2). Include
your map (3), the type of normalization desired (4) and the deep
learning mode to use (5), in this particular case <em>highRes</em> due to the map high
resolution.</p>
<div class="figure align-center" id="model-building-deepemhancer-1">
<a class="reference internal image-reference" href="../../../../_images/Fig63.svg"><img alt="Filling in the protocol to generate a sharpened map with :math:`DeepEMhancer`." src="../../../../_images/Fig63.svg" width="95.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.10 </span><span class="caption-text">Filling in the protocol to generate a sharpened map with <span class="math">DeepEMhancer</span>.</span><a class="headerlink" href="#model-building-deepemhancer-1" title="Permalink to this image">¶</a></p>
</div>
<p>After executing the protocol (<a class="reference internal" href="#model-building-deepemhancer-1"><span class="std std-numref">Fig. 7.10</span></a> (6)), we can check the results (7). <em>ChimeraX</em> viewer will open and show the sharpened map compared with the initial
one (<a class="reference internal" href="#model-building-deepemhancer-2"><span class="std std-numref">Fig. 7.11</span></a>).</p>
<div class="figure align-center" id="model-building-deepemhancer-2">
<a class="reference internal image-reference" href="../../../../_images/Fig65.svg"><img alt=":math:`DeepEMhancer` sharpened map (yellow surface) and input map (grey mesh) in *ChimeraX*." src="../../../../_images/Fig65.svg" width="65.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.11 </span><span class="caption-text"><span class="math">DeepEMhancer</span> sharpened map (yellow surface) and input map
(grey mesh) in <em>ChimeraX</em>.</span><a class="headerlink" href="#model-building-deepemhancer-2" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="comparison-of-maps">
<h2><span class="section-number">7.2. </span>Comparison of maps<a class="headerlink" href="#comparison-of-maps" title="Permalink to this headline">¶</a></h2>
<p>Realize that at this point we have generated two optimized maps derived
from the initial one. Additionally, some other maps could have been
obtained using other map optimization methods. A comparison among them
would be interesting to consider which one(s) of them should be used as
input in next steps of modeling workflow. The ideal map for tracing the
atomic structure should include as many details and connections as
possible and, at the same time, preserve the density areas of the
initial map. In other words, we can use the best sharpened map (with
higher resolution) corroborating that it does not make up new densities,
absent in the starting map. Nevertheless, choose “the best” sharpened
map could be difficult sometimes, especially if the map is very big or
there are some regions optimized in one of the sharpened maps and other
areas optimized in the other one. In that case, you can use several maps
at the same time, having all of them perfectly aligned according to the
same origin of coordinates.</p>
<p>In the tiny example shown in this tutorial we are working with a high
resolution map and there are almost no differences in resolution between
the starting map and the two derived sharpened maps, although this is
not usually the case in real life. In this quite uncommon case the
initial unsharpened map would be enough to trace the atomic structure.
However, in order to detail the method, the starting map and their two
sharpened ones will be used simultaneously.</p>
</div>
<div class="section" id="extraction-of-the-asymmetric-unit-map">
<h2><span class="section-number">7.3. </span>Extraction of the asymmetric unit map<a class="headerlink" href="#extraction-of-the-asymmetric-unit-map" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">Since smaller volumes usually include lower number of individual
structural elements, making easier fitting models in maps and
simplifying modeling process, the part of the map chosen to work with
will always be the smaller asymmetrical subunit of the starting loaded
map, also known as asymmetric unit (ASU). The size of the ASU thus
depends on the symmetry order of the initial volume. The higher the
symmetry order, the smaller the ASU. The atomic structure of the whole
volume will be obtained straight forward by simply repetition of the
ASU structure according to the symmetry order. Then, the first step to
simplify the complexity of the initial volume is extracting the ASU.
This task can be accomplished by using the <em>Scipion</em> protocol <strong>xmipp3-extract unit cell</strong> that extracts the
geometrical ASU of the map (Appendix <a class="reference internal" href="a070-extractUnitCell.html#app-extractunitcell"><span class="std std-ref">Extract unit cell</span></a>).</div>
</div>
<div class="line-block">
<div class="line"><a class="reference internal" href="#model-building-extract-unit-cell"><span class="std std-numref">Fig. 7.12</span></a> shows how to fill in this protocol form (1). Consider that in this
particular case the protocol will be run three times, one with each
map (the initial one and the two sharpened derived ones). Include each
map in a protocol form parallel to that shown in <a class="reference internal" href="#model-building-extract-unit-cell"><span class="std std-numref">Fig. 7.12</span></a> (2). Since <em>metHgb</em>
macromolecule shows symmetry C2, we have selected cyclic symmetry (Cn)
as type of symmetry (3), and 2 as symmetry order (4). The angle offset
selected (5) turns -45º around the Z axis the mask used to create the
ASU. The two wizards on the right (6, 7) help you to select the radii
to delimit a fraction of the map comprised between the coordinate
origin (inner radius 0.0) and the maximum radius (outer radius 50.0).
The final extracted volume will be slightly higher than the ASU due to
the expand factor 0.2 (8). The respective tutorial appendix <a class="reference internal" href="a070-extractUnitCell.html#app-extractunitcell"><span class="std std-ref">Extract unit cell</span></a>
includes a comprehensive explanation of the meaning of parameters.</div>
</div>
<div class="figure align-center" id="model-building-extract-unit-cell">
<a class="reference internal image-reference" href="../../../../_images/Fig7.svg"><img alt="Extracting the map asymmetric unit (ASU)." src="../../../../_images/Fig7.svg" width="100.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.12 </span><span class="caption-text">Extracting the map asymmetric unit (ASU).</span><a class="headerlink" href="#model-building-extract-unit-cell" title="Permalink to this image">¶</a></p>
</div>
<p>After executing the protocol (<a class="reference internal" href="#model-building-extract-unit-cell"><span class="std std-numref">Fig. 7.12</span></a> (9)), the resulting expanded ASU can be
observed (10) with <em>ChimeraX</em> (<a class="reference internal" href="#model-building-chimera-visualization-unit-cell"><span class="std std-numref">Fig. 7.13</span></a>). Note the additional expanded volume of the ASU on the left side of the figure. The ASU itself, on the right side,
constitutes the half volume. Since the total volume contains the
structure of four proteins, we can anticipate that this smaller
asymmetrical subunit of the initial volume contains two proteins, one
<span class="math">\alpha</span> and one <span class="math">\beta</span> subunit. Then, the respective
structures of these two proteins could be fitted in the map ASU
simultaneously or in successive modeling workflow steps.</p>
<div class="figure align-center" id="model-building-chimera-visualization-unit-cell">
<a class="reference internal image-reference" href="../../../../_images/Fig8.svg"><img alt="Expanded ASU (yellow-green-blue) and initial volume (gray) visualized with :math:`ChimeraX`. The purple broken line on the right delimits the ASU (right) and its expanded volume (left)." src="../../../../_images/Fig8.svg" width="80.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 7.13 </span><span class="caption-text">Expanded ASU (yellow-green-blue) and initial volume (gray) visualized
with <span class="math">ChimeraX</span>. The purple broken line delimits
the ASU (right) and the expanded volume (left).</span><a class="headerlink" href="#model-building-chimera-visualization-unit-cell" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="060-sequenceScenario.html" class="btn btn-neutral float-right" title="8. Structure Prediction by Sequence Homology. Searching for Homologues" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="040-importInputData.html" class="btn btn-neutral float-left" title="6. Import Input data" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: release-3.0.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../../gh-pages/index.html">gh-pages</a></dd>
            <dd><a href="../../../../release-2.0.0/index.html">release-2.0.0</a></dd>
            <dd><a href="../../../../release-3.0.0/docs/user/tutorials/modelBuilding/050-volumeScenario.html">release-3.0.0</a></dd>
            <dd><a href="../../../../rm_model_building/docs/user/tutorials/modelBuilding/050-volumeScenario.html">rm_model_building</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>