

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>14. The whole macromolecule &mdash; Scipion 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="15. Summary of results and submission" href="121-submissionResults.html" />
    <link rel="prev" title="13. Building the asymmetric unit" href="110-unitcell.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../scipion-modes/how-to-install.html">Installing Scipion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../scipion-modes/host-configuration.html">Host configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../user-documentation.html#tutorials">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../user-documentation.html#single-particle-tutorials">Single particle tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user-documentation.html#tomography-tutorials">Tomography tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../user-documentation.html#model-building">Model Building</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Model Building by Homology</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="index.html#contents">Contents</a></li>
<li class="toctree-l4"><a class="reference internal" href="index.html#appendices">Appendices</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../Alphafold/index.html">Build initial model with Alphafold</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../user-documentation.html#processing-how-to-s">Processing How To’s</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../facilities/facilities.html">On-the-fly processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../facilities/customize-report.html">Summary Reports</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/scipion-API.html">Scipion API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/plugins-API.html">Plugins API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/xmipp-API.html">Xmipp API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../misc/contact-us.html">Contact Us</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Licences</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">Licenses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../user-documentation.html">Graphical interface manuals</a> &raquo;</li>
        
          <li><a href="index.html">Model Building Tutorial</a> &raquo;</li>
        
      <li><span class="section-number">14. </span>The whole macromolecule</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../../_sources/docs/user/tutorials/modelBuilding/Homology/120-macromolecule.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-whole-macromolecule">
<span id="wholemacromolecule"></span><h1><span class="section-number">14. </span>The whole macromolecule<a class="headerlink" href="#the-whole-macromolecule" title="Permalink to this headline">¶</a></h1>
<p>To regenerate the whole human <em>metHgb</em> macromolecule, we are going to
follow basically the schema shown in <a class="reference internal" href="110-unitcell.html#model-building-scipion-workflow-whole-reconstruction"><span class="std std-numref">Fig. 13.1</span></a>. Starting from the symmetric unit, <em>ChimeraX operate</em> protocol allows to generate the whole molecule by symmetry. As
in the previous step, validation programs drive to selection of the best <em>model</em> of the whole molecule after one or several rounds of assessment - refinement -assessment. A final validation step will be
accomplished with <em>ChimeraX map subtraction</em> protocol to assess the volume
density occupancy of the new macromolecule generated.</p>
<ul>
<li><div class="line-block">
<div class="line">Protocol <strong>chimerax-operate</strong> to generate the whole molecule of human <em>Hgb</em>:</div>
</div>
<div class="line-block">
<div class="line">Following previous instructions, open <em>ChimeraX operate</em> protocol (<a class="reference internal" href="100-validation.html#model-building-chimera-operate-protocol"><span class="std std-numref">Fig. 12.7</span></a> (1)),
load the selected atomic structure <em>model</em> of <em>metHgb</em>
asymmetric unit (2), and execute the protocol (3). <em>ChimeraX</em> graphics
interface will show you the <em>model</em> of <em>metHgb</em> asymmetric
unit. Considering the C2 symmetry of the whole molecule, write in <em>ChimeraX</em>
command line to re-generate the whole molecule:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="c1">#3 C2 copies true</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">A symmetric image of the input <em>model</em> (<a class="reference internal" href="#model-building-chimera-operate-sym"><span class="std std-numref">Fig. 14.1</span></a>; <em>model</em> <em>#3</em>) will be generated. The <em>model</em> <em>#4</em> contains both the
input (<a class="reference internal" href="#model-building-chimera-operate-sym"><span class="std std-numref">Fig. 14.1</span></a>, <em>model</em> <em>#4.1</em>) and the symmetric unit (<em>model</em> <em>#4.2</em>).</div>
</div>
<div class="figure align-center" id="model-building-chimera-operate-sym">
<a class="reference internal image-reference" href="../../../../../_images/Fig41.svg"><img alt=":math:`Model` generated by symmetry for the whole human *metHgb*." src="../../../../../_images/Fig41.svg" width="50.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 14.1 </span><span class="caption-text"><em>Model</em> generated by symmetry for the whole human <em>metHgb</em>.</span><a class="headerlink" href="#model-building-chimera-operate-sym" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line">Although the whole structure can be saved by writing in <em>ChimeraX</em> command
line <em>scipionwrite #4 prefix whole_model_</em>, in order to have only
one <em>model</em> and not a group of two <em>models</em>, we will write in
command line:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">save</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">chains_C_D</span><span class="o">.</span><span class="n">cif</span> <span class="nb">format</span> <span class="n">mmcif</span> <span class="n">models</span> <span class="c1">#4.2</span>
<span class="nb">open</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">chains_C_D</span><span class="o">.</span><span class="n">cif</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">Old <em>ChimeraX</em> versions:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">setattr</span> <span class="c1">#5/A c chain_id C</span>
<span class="nb">setattr</span> <span class="c1">#5/A r chain_id C</span>
<span class="nb">setattr</span> <span class="c1">#5/B c chain_id D</span>
<span class="nb">setattr</span> <span class="c1">#5/B r chain_id D</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">New version of <em>ChimeraX</em>:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scipioncombine</span> <span class="c1">#3,5</span>
<span class="n">scipionwrite</span> <span class="c1">#6 prefix whole_model_</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">Remark that we have changed the <em>ids</em> of symmetric chains <em>A</em> and
<em>B</em> by <em>C</em> and <em>D</em>, respectively.</div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">NOTE:</span></code> In this small example selected for modeling it doesn’t
matter if we model the map asymmetric unit or the whole molecule.
In real life, however, to model the whole molecule doesn’t make
sense because of its huge size. In that case, we will limit our
modeling to the map asymmetric unit. The right modeling of this
part of the molecule will require to add the adjacent asymmetric
units in order to perform the appropriate modeling of the
overlapping areas, avoiding steric classes in the reconstruction by
symmetry of the whole molecule. In that case, the command lines
would be:</div>
</div>
<ul>
<li><div class="line-block">
<div class="line">To generate the symmetry copies:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sym</span> <span class="c1">#3 C2 copies true</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><div class="line-block">
<div class="line">To remove in the new <em>model</em> <em>#4</em> the symmetry copies with
centers within a certain range of distance <em>d</em> of the center of
the molecule input <em>model</em>:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">delete</span> <span class="c1">#4 &amp; #3 #&gt;d</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<div class="line-block">
<div class="line">At this point we will continue with the refinement process of this
asymmetric unit plus neighbors. The validation will focus only on the
asymmetric unit, which will be recovered by removing the remaining
adjacent asymmetric units. This cleaning or removing of the neighbor
units can be performed with the protocol <em>ChimeraX operate</em> each time we would like to validate the structure.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Protocols to refine the new combined structure generated:</div>
</div>
<div class="line-block">
<div class="line">As we said in the previous chapter regarding the building of the
asymmetric unit, refinements should cover specially the overlapping
areas, in this case between the two asymmetric units. Help yourself
with <em>Coot</em> tools of <em>Validate</em> in the main menu, as well as the
visualization tools of <em>PHENIX real space refine</em> protocol.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Validation protocols to select the best <em>model</em> of the whole
human <em>Hgb</em>:</div>
</div>
<div class="line-block">
<div class="line"><em>EMRinger</em> and <em>Validation CryoEM (MolProbity)</em> statistics have to be
computed for the new <em>model</em> of the whole human <em>metHgb</em>
obtained by using <em>ChimeraX operate</em> protocol (see results Table 9 in Appendix <a class="reference internal" href="a010-answers.html#app-solutions"><span class="std std-ref">Solutions</span></a>; <a class="reference internal" href="a010-answers.html#question12"><span class="std std-ref">Question12</span></a>). Because of
high values of <em>CC(mask)</em> and <em>EMRinger score</em>, as well as acceptable <em>MolProbity</em> statistics,
<em>model</em> generated by <em>ChimeraX operate</em> protocol is selected as
<em>model</em> of the whole human <em>metHgb</em>. Additional refinement
steps with <em>PHENIX real space refine</em> and <em>Refmac</em> do not seem to improve the
result significantly. In this case, the RMSD value of the selected
atomic structure <em>model</em>, regarding the published structure,
yields an intermediate value between the best and the worst one.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Protocol <strong>chimerax-map subtraction</strong> to assess volume density occupancy:</div>
</div>
<div class="line-block">
<div class="line">We perform this analysis in order to identify parts of the density
map that were not modeled previously, maybe unknown parts of the
complex, although areas where the <em>model</em> doesn’t fit the map can
be also identified. Sometimes the density level or the resolution
in these areas differ from the rest of the map and commonly are
more blurry, which makes them much more difficult to identify and
trace. Ideally, we would like to remove the map density associated
to the already traced atomic structure to facilitate the modeling
of the remnant density. Obviously, there are some limitations in
this process because the structure-derived map might not be
absolutely identical to the reconstructed map. As one possible
aproximation, we will run a protocol based on <em>ChimeraX</em> (see Appendix <a class="reference internal" href="a013-chimeraMapSubtraction.html#app-chimeramapsubtraction"><span class="std std-ref">CHIMERAX Map subtraction</span></a> with use cases) to subtract the modeled part of the map from the whole
map.</div>
</div>
<p>First, open <em>ChimeraX map subtraction</em> protocol (<a class="reference internal" href="#model-building-chimera-map-subtract"><span class="std std-numref">Fig. 14.2</span></a> (1)), load both the initial map obtained from the reconstruction process (2) and its resolution. Although in this case we are going to consider the nominal map resolution, in real life you should test different
resolution values among which the half value of the resolution
obtained by FSC is recommended. Include also the refined atomic
structure <em>model</em> of the whole human <em>metHgb</em> (3). As a control
of the subtraction process we are going to remove 7 residues of the
chain <em>A</em>. With this aim, use the two wizards on the right (4) to
select that chain and residues located between positions <em>22</em> and
<em>28</em>, both included. Since we are interested in observing differences
in the whole map, the default option <em>No</em> will be maintained
regarding the selection of a map fraction around the atomic structure
(5). Then, execute the protocol (6).</p>
<div class="figure align-center" id="model-building-chimera-map-subtract">
<a class="reference internal image-reference" href="../../../../../_images/Fig42.svg"><img alt="Completing the protocol **chimerax-map subtraction**." src="../../../../../_images/Fig42.svg" width="100.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 14.2 </span><span class="caption-text">Completing the protocol <strong>chimerax-map subtraction</strong>.</span><a class="headerlink" href="#model-building-chimera-map-subtract" title="Permalink to this image">¶</a></p>
</div>
<p><em>ChimeraX</em> graphics window will open and the commands driving the subtraction
process will be applied. The <a class="reference internal" href="#model-building-chimera-map-subtract-2"><span class="std std-numref">Fig. 14.3</span></a> shows in blue the map resulting from subtracting the <em>model</em>-derived map from the starting map <em>EMD-3488</em>
after applying a Gaussian filter. Three main map bodies can be
observed moving the density threshold of this map (model <em>#9</em> in the
<em>Models</em> panel). The red arrow number <em>1</em> points to the control map
derived from removing 7 residues of the chain <em>A</em> of the atomic
structure. The other two red arrows (number <em>2</em>) point to two
unexpected remnant densities.</p>
<div class="figure align-center" id="model-building-chimera-map-subtract-2">
<a class="reference internal image-reference" href="../../../../../_images/Fig43.svg"><img alt="Filtered subtraction map (blue bodies) and refined atomic structure (pink) of the whole human *Hgb*." src="../../../../../_images/Fig43.svg" width="90.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 14.3 </span><span class="caption-text">Filtered subtraction map (blue bodies) and refined atomic structure (pink) of the whole human <em>Hgb</em>.</span><a class="headerlink" href="#model-building-chimera-map-subtract-2" title="Permalink to this image">¶</a></p>
</div>
<p>The two additional bodies of density should not appear with an
appropriate modeling of the human <em>Hgb</em> showing acceptable validation
scores. However, in this final <em>model</em> of the whole human <em>Hgb</em> we
didn’t refine on purpose the C-terminal ends of chain <em>A</em> and its
symmetric chain <em>C</em>. The <em>ARG</em> residues don’t fit to the map density
and the remnant densities identified in the subtraction protocol
correspond to the C-terminal ends of chains <em>A</em> and <em>C</em>. A fair
tracing of those parts of the molecule would avoid remnant densities
others than the control. To check the right tracing of the human
<em>Hgb</em> we have overlapped the above mentioned published atomic
structure of the human <em>Hgb</em> (<em>PDB ID 5NI1</em>), in green in <a class="reference internal" href="#model-building-chimera-map-subtract-3"><span class="std std-numref">Fig. 14.4</span></a>, and
our final <em>model</em>, depicted in pink. The zoom in details the
C-terminal end of our <em>model</em> (red arrow) and the published one
(green arrow), which perfectly fits the body of density.</p>
<div class="figure align-center" id="model-building-chimera-map-subtract-3">
<a class="reference internal image-reference" href="../../../../../_images/Fig44.svg"><img alt="Overlapping structures of the models built (pink) and published (green) of the whole human *Hgb*. Zoom in to detail the C-terminal end of the chain *C*." src="../../../../../_images/Fig44.svg" width="90.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 14.4 </span><span class="caption-text">Overlapping structures of the models built (pink) and published (green) of the whole human <em>Hgb</em>. Zoom in to detail the C-terminal end of the chain <em>C</em>.</span><a class="headerlink" href="#model-building-chimera-map-subtract-3" title="Permalink to this image">¶</a></p>
</div>
<p>As a conclusion, if you do not have additional densities with the
example of this tutorial, except the control one, you’d have
performed a good modeling and you could use your atomic structure to
perform other types of analyses and to publish it. Otherwise, you
should still refine your <em>model</em>.</p>
</li>
</ul>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="121-submissionResults.html" class="btn btn-neutral float-right" title="15. Summary of results and submission" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="110-unitcell.html" class="btn btn-neutral float-left" title="13. Building the asymmetric unit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: release-3.0.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../../../gh-pages/index.html">gh-pages</a></dd>
            <dd><a href="../../../../../release-2.0.0/index.html">release-2.0.0</a></dd>
            <dd><a href="../../../../../release-3.0.0/docs/user/tutorials/modelBuilding/Homology/120-macromolecule.html">release-3.0.0</a></dd>
            <dd><a href="../../../../../rm_model_building/index.html">rm_model_building</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>