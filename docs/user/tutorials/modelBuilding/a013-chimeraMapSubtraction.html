

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>4. ChimeraX Map Subtraction protocol &mdash; Scipion 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="5. ChimeraX Operate protocol" href="a020-chimeraOperate.html" />
    <link rel="prev" title="3. ChimeraX Contacts protocol" href="a012-chimeraContacts.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/how-to-install.html">Installing Scipion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../scipion-modes/host-configuration.html">Host configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../user-documentation.html#tutorials">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../user-documentation.html#single-particle-tutorials">Single particle tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../user-documentation.html#tomography-tutorials">Tomography tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../user-documentation.html#model-building">Model Building</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Model Building Tutorial</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="index.html#contents">Contents</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html#appendices">Appendices</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../user-documentation.html#processing-how-to-s">Processing How To’s</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/facilities.html">On-the-fly processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../facilities/customize-report.html">Summary Reports</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../api/scipion-API.html">Scipion API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/plugins-API.html">Plugins API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/xmipp-API.html">Xmipp API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../misc/contact-us.html">Contact Us</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Licences</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">Licenses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../user-documentation.html">Graphical interface manuals</a> &raquo;</li>
        
          <li><a href="index.html">Model Building Tutorial</a> &raquo;</li>
        
      <li><span class="section-number">4. </span>ChimeraX Map Subtraction protocol</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/docs/user/tutorials/modelBuilding/a013-chimeraMapSubtraction.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="chimerax-map-subtraction-protocol">
<span id="app-chimeramapsubtraction"></span><h1><span class="section-number">4. </span>ChimeraX Map Subtraction protocol<a class="headerlink" href="#chimerax-map-subtraction-protocol" title="Permalink to this headline">¶</a></h1>
<p><em>ChimeraX</em>-based protocol designed to subtract two maps. These two maps can be two
density maps experimentally obtained or derived from different
computations, including the generation of a density map from an atomic
structure. In the context of the modeling workflow this protocol helps
to find out unmodeled densities in a map as a whole or in a specific
part of it. In addition, wrong modeled regions can be also identified
with this protocol since the atomic structure could doesn’t fit to the
density map.</p>
<ul>
<li><div class="line-block">
<div class="line">Requirements to run this protocol and visualize results:</div>
</div>
<ul>
<li><div class="line-block">
<div class="line"><em>Scipion</em> plugin: <strong>scipion-em</strong></div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>Scipion</em> plugin: <strong>scipion-em-chimera</strong></div>
</div>
</li>
</ul>
</li>
<li><div class="line-block">
<div class="line"><em>Scipion</em> menu: <em>Model building -&gt; Tools-Calculators</em> (<a class="reference internal" href="#model-building-app-protocol-map-subtract-1"><span class="std std-numref">Fig. 4.1</span></a> (A))</div>
</div>
<div class="figure align-center" id="model-building-app-protocol-map-subtract-1">
<a class="reference internal image-reference" href="../../../../_images/Fig309.svg"><img alt="Protocol **chimerax-map subtraction**. A: Protocol location in *Scipion* menu. B: Protocol form to subtract two maps. C: Param option *Mask*. D: Protocol form to subtract an atomic structure from a map. All possible params are shown." src="../../../../_images/Fig309.svg" width="85.0%" /></a>
<p class="caption"><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Protocol <strong>chimerax-map subtraction</strong>. A: Protocol location in <em>Scipion</em> menu. B: Protocol form to subtract two maps. C: Param option <em>Mask</em>. D: Protocol form to subtract an atomic structure from a map. All possible params are shown.</span><a class="headerlink" href="#model-building-app-protocol-map-subtract-1" title="Permalink to this image">¶</a></p>
</div>
</li>
<li><div class="line-block">
<div class="line">Protocol form parameters (<a class="reference internal" href="#model-building-app-protocol-map-subtract-1"><span class="std std-numref">Fig. 4.1</span></a> (B,C,D)):</div>
</div>
<div class="line-block">
<div class="line"><em>Input</em> section:</div>
</div>
<ul>
<li><div class="line-block">
<div class="line"><em>Input 3D Map</em>: Include here any map previously downloaded or generated in <em>Scipion</em> that you would like to use as minuend of the subtraction operation.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>Select the operation to perform</em>: Two possibilities are allowed:</div>
</div>
<ul>
<li><div class="line-block">
<div class="line"><em>Subtraction</em>: Between minuend and subtrahend maps, and you’ll obtain the difference. <code class="docutils literal notranslate"><span class="pre">WARNING:</span></code> Both maps have to be perfectly aligned.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>Mask</em>: The voxel region of the subtrahend greater than a certain level will be masked (<a class="reference internal" href="#model-building-app-protocol-map-subtract-1"><span class="std std-numref">Fig. 4.1</span></a> (C)). The default level is <em>0.001</em> although can be modified with the <em>Advanced</em> param <em>Contour level (subtrahend)</em>. If no level is supplied, <em>ChimeraX</em> will compute that level value.</div>
</div>
</li>
</ul>
</li>
<li><div class="line-block">
<div class="line"><em>Subtraction/Mask of</em>: Select the subtrahend of the subtraction operation. Two possibilities are allowed:</div>
</div>
<ul>
<li><div class="line-block">
<div class="line"><em>3D map</em>: Any map previously downloaded or generated in <em>Scipion</em>.</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">WARNING:</span></code> The sampling rate of this map should be identical to the subtrahend’s.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>atomic structure</em>: Previously downloaded or generated in <em>scipion</em>. By selecting this option many new params will interrogate about the structure-derived map that you would like to generate (<a class="reference internal" href="#model-building-app-protocol-map-subtract-1"><span class="std std-numref">Fig. 4.1</span></a> (D)).</div>
</div>
<ul>
<li><div class="line-block">
<div class="line"><em>Map resolution (Å)</em>: This is a tricky param and a uniform rule cannot be followed since, although its value is related with the minuend map resolution obtained by computing the <em>FSC</em> in the reconstruction process, local variations of this resolution seem to be involved. As a general rule, start with a resolution value half of the one obtained by the <em>FSC</em> and check your results. Then test other resolution values closer to the one computed by the <em>FSC</em> and compare the results with the previous one. At the end select the resolution that maximizes the difference between the minuend and the subtrahend.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>Atomic structure</em>: Select the atomic structure in the workflow to generate the called <em>molmap_Map</em>.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>Select a specific chain?</em>: In case you are interested in generate the sustrahend <em>3D map</em> from the input atomic structure as a whole, answer <em>No</em> to this question. However, answer <em>Yes</em> if you want to derive that map from a specific chain of the atomic structure. If this is the case, a new param (<em>Chain of the atomic structure</em>) will interrogate you about the specific chain that you can select with the help of the wizard on the right.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>Remove residues from the atomic structure?</em>: Select <em>Yes</em>
to answer this question in case you’d like to count on a
control of density levels to identify the differential
density. The aim of this control is to identify the density
of the removed residues in the differential map. However,
be cautious about discarding other densities that could
appear in lower resolution areas and have density levels
slightly different to the control one. After running the
program, the <em>ChimeraX</em> graphics window will open and the atomic
structure won’t show the removed residues. To make easier
the localization of this area, ten residues both upstream
and downstream of the removed aminoacids will be
highlighted.</div>
</div>
<div class="line-block">
<div class="line">Additional params to interrogate about the residues to be
removed are <em>Chain</em>, <em>First residue to remove</em> and <em>Last
residue to remove</em>. A wizard on the right helps to select
this three elements. <code class="docutils literal notranslate"><span class="pre">WARNING:</span></code> In case you have already
selected a specific chain of the structure to generate the
<em>3D Map</em>, this chain will appear by default in the param
<em>Chain</em> since the selection of a different chain wouldn’t
make sense.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>Apply symmetry to the atomic structure</em>: In case your input atomic structure to derive the subtrahend <em>3D map</em> corresponds to the asymmetric unit and you’d like to have the whole atomic structure or at least several adjacent asymmetric units together with the input one, select the option <em>Yes</em>. Otherwise, the subtrahend derived map will only correspond to the asymmetric unit. All <em>ChimeraX</em> <a class="reference external" href="https://www.cgl.ucsf.edu/chimerax/docs/user/commands/sym.html">symmetries</a> will be available. In case you select symmetries cyclic or dihedral, an additional param will interrogate you about the <em>Symmetry Order</em>. Pay attention to the param <em>Range of distance</em>, set to <em>100</em> by default. This is the distance (in Å) from the center of the input asymmetric unit to the center of additional allowed asymmetric units, in order to select only the closer ones. You should probably modify the default value to regenerate big maps by applying symmetry.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>Map fraction around the atomic structure?</em>: Select the option <em>Yes</em> if you want to limit the input minuend <em>3D Map</em> to a certain area around the atomic structure. This is the option recommended if you have a big starting map and you’d like to substract a much smaller subtrahend structure-derived map since the visualization of results will be much easier. An additional param, <em>Atom radius (Å)</em> asks you about the distance around the input structure used to crop the input <em>3D Map</em>. <em>15</em> is the default value. The <em>ChimeraX</em>-generated map is called <em>zone_Map</em>.</div>
</div>
</li>
</ul>
</li>
<li><div class="line-block">
<div class="line"><em>Other atomic structures</em>: Additional atomic structures previously downloaded or obtained in <em>Scipion</em> can be included here to help you identify particular areas of the map or structure. Then, those structures are only informative and won’t be used to generate the subtrahend map.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>Filter to apply to the differential map</em>: <em>Advanced</em> parameter to clean the background of the differential map by applying a filter in order to maximize the differences between the minuend and the subtrahend maps, since the differential map usually results quite blurry. This <em>filtered_Map</em> will always appear together with the <em>difference_Map</em> when the <em>ChimeraX</em> graphics window opens. To filter the differential map you can choose between two different filters, <em>Gaussian</em> (with variable width) and based on the <em>Fourier Transform</em>.</div>
</div>
</li>
</ul>
</li>
</ul>
</li>
<li><div class="line-block">
<div class="line">Protocol execution:</div>
</div>
<div class="line-block">
<div class="line">Adding specific volume label is recommended in <em>Run name</em> section,
at the form top. To add the label, open the protocol form, press
the pencil symbol at the right side of <em>Run name</em> box, complete the
label in the new opened window, press OK, and finally, close the
protocol. This label will be shown in the output summary content
(see below). If you want to run again this protocol, do not forget
to set to <em>Restart</em> the <em>Run mode</em>.</div>
</div>
<div class="line-block">
<div class="line">Press the <em>Execute</em> red button at the form bottom.</div>
</div>
<div class="line-block">
<div class="line">After executing the protocol the <em>ChimeraX</em> graphics window will open and show
the different inputs (maps and atomic structures), as well as the
maps generated by the <em>ChimeraX</em> commands such as <em>molmap_Map</em>, <em>zone_Map</em>,
<em>difference_Map</em> and <em>filtered_Map</em>. Most of the outputs are
already saved in <em>Scipion</em>, however you can perform any operation of your
preference and save the new results before closing <em>ChimeraX</em>. Common
commands of <em>ChimeraX</em>-<em>Scipion</em> communication are allowed in this case:
<em>scipionwrite</em>, <em>scipionss</em> and <em>scipioncombine</em>.</div>
</div>
</li>
<li><p>Visualization of protocol results:</p>
<div class="line-block">
<div class="line">After exiting the protocol, press <em>Analyze Results</em> and the
<em>ChimeraX</em> graphics window will open with every saved
elements, inputs and outputs, which might be distinct acording to
the inputs. In addition to items mentioned in the previous
paragraph, the atomic structure without the removed residues used
as a control, called <em>mutated_Atom_structure</em> will be also shown
overlapping the input structure.</div>
</div>
<div class="line-block">
<div class="line">By pressing the left black arrow shown in the <em>Summary Output</em> the
saved maps can be also opened with <span class="math">ShowJ</span>, the default <em>Scipion</em>
viewer that shows each map’s <em>slices</em>
(<a class="reference external" href="https://github.com/I2PC/scipion/wiki/ShowJ">ShowJ</a>).</div>
</div>
</li>
<li><p>Summary content:</p>
<ul>
<li><div class="line-block">
<div class="line">Protocol output (below <em>Scipion</em> framework):</div>
<div class="line">For each map: <em>chimerax - map subtraction -&gt; ouput map name</em>;</div>
<div class="line"><em>Volume (x, y, and z dimensions, sampling rate)</em>.</div>
<div class="line">For each atomic structure: <em>chimerax - map subtraction -&gt; output
atomic structure name</em>;</div>
<div class="line"><em>AtomStruct (pseudoatoms=False, volume=False</em>).</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>SUMMARY</em> box:</div>
<div class="line"><em>Produced files</em>:</div>
<div class="line">List of output map names</div>
<div class="line"><em>we have some result</em></div>
</div>
</li>
</ul>
</li>
</ul>
<div class="section" id="use-cases">
<h2><span class="section-number">4.1. </span>USE CASES<a class="headerlink" href="#use-cases" title="Permalink to this headline">¶</a></h2>
<ul>
<li><div class="line-block">
<div class="line"><em>Use Case 1: Detection of remnant density in the penton region of
the human adenovirus HAdV-F41 density map (EMDB ID EMD-10768</em>, <span id="id1">[<a class="reference internal" href="z010-references.html#id23" title="M. Pérez-Illana, M. Martínez, G. N. Condezo, M. Hernando-Pérez, C. Mangroo, M. Brown, R. Marabini, and C. San Martín. Cryo-EM structure of enteric adenovirus HAdV-F41 highlights structural variations among human adenoviruses. Sci Adv, 02 2021.">Pérez-Illana <em>et al.</em>, 2021</a>]</span>)</div>
</div>
<div class="line-block">
<div class="line">Aim: Run the workflow depicted in <a class="reference internal" href="#model-building-app-usecase-mapsubtract-1"><span class="std std-numref">Fig. 4.2</span></a> (A). The output of protocols 1, 2 and 3 can be seen in the <em>ChimeraX</em> viewer by pressing <em>Analyze Results</em>.</div>
</div>
<ul>
<li><div class="line-block">
<div class="line">In <a class="reference internal" href="#model-building-app-usecase-mapsubtract-1"><span class="std std-numref">Fig. 4.2</span></a> (B) appears the whole adenovirus map, output of protocol 1. To visualize this map write in <em>ChimeraX</em> command line:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">volume</span> <span class="c1">#2 region all showOutline false</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">and adjust level densities according to level indicated in the <em>Volume Viewer</em> shown.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">In <a class="reference internal" href="#model-building-app-usecase-mapsubtract-1"><span class="std std-numref">Fig. 4.2</span></a> (C) the extracted asymmetric unit is shown, overlapped to
the whole map, as output of protocol 2. To visualize these maps,
in addition to the previous <em>ChimeraX</em> command line and the adjustment of
map levels indicated below, modify the transparency of the whole
map writing:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">volume</span> <span class="c1">#2 transparency 0.8</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><div class="line-block">
<div class="line">Finally, <a class="reference internal" href="#model-building-app-usecase-mapsubtract-1"><span class="std std-numref">Fig. 4.2</span></a> (D) details the atomic structure of the biological
asymmetric unit obtained by modeling as output of protocol 3
(<em>PDB ID 6YBA</em>). Select <em>Atoms -&gt; Hide</em> and <em>Cartoons -&gt; Show</em>
to change to ribbons the view of the structure. The overlapping
of this structure to the geometrical map asymmetric unit allows
to observe the area (5, dotted blue circle) where the penton is
located and we will try to see a remnant density. To visualize
the map, write in the command line:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">volume</span> <span class="c1">#2 transparency 0.9</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<div class="figure align-center" id="model-building-app-usecase-mapsubtract-1">
<img alt="(A) *Scipion* workflow showing protocols 1, 2, 3 and 4. (B) Adenovirus HAdV-F41 map image. (C) Map geometrical asymmetric unit extracted from the adenovirus map. (D) Adenovirus atomic structure of the biological asymmetric unit overlapped to the geometrical map unit." src="../../../../_images/Fig310.svg" /><p class="caption"><span class="caption-number">Fig. 4.2 </span><span class="caption-text"><em>(A) Scipion</em> workflow showing protocols 1, 2, 3 and 4. (B) Adenovirus HAdV-F41 map image. (C) Map geometrical asymmetric unit extracted from the adenovirus map. (D) Adenovirus atomic structure of the biological asymmetric unit overlapped to the geometrical map unit.</span><a class="headerlink" href="#model-building-app-usecase-mapsubtract-1" title="Permalink to this image">¶</a></p>
</div>
<p>To look for remnant densities in the penton area we have to complete
the protocol with the indicated params (<a class="reference internal" href="#model-building-app-usecase-mapsubtract-2"><span class="std std-numref">Fig. 4.3</span></a>). Remark that in this case we
have selected half of input <em>3D Map</em> resolution (4 Å) although other
values could be tested. The only chain of the penton in the atomic
structure of the asymmetric structure is the chain <em>M</em>, inside the
dotted blue circle of <a class="reference internal" href="#model-building-app-usecase-mapsubtract-1"><span class="std std-numref">Fig. 4.2</span></a> (D), and 8 residues will be removed as a
control of density levels. In addition, icosahedral <em>I222r</em> symmetry
will be applied to the selected chain in order to complete the five
units of the penton. In order to visualize better the map difference,
a map fraction around the atomic structure is selected.</p>
<div class="figure align-center" id="model-building-app-usecase-mapsubtract-2">
<img alt="Completing the protocol **chimerax-subtraction** to find renmant densities in the penton area of the adenovirus map." src="../../../../_images/Fig311.svg" /><p class="caption"><span class="caption-number">Fig. 4.3 </span><span class="caption-text">Completing the protocol <strong>chimerax-subtraction</strong> to find renmant densities in the penton area of the adenovirus map.</span><a class="headerlink" href="#model-building-app-usecase-mapsubtract-2" title="Permalink to this image">¶</a></p>
</div>
<p>Protocol execution: Follow the general procedure shown above
(Protocol execution section) and <em>ChimeraX</em> graphics window will open. At
this point several maps and atomic structures will be shown, as the
<em>Models</em> panel indicates (<a class="reference internal" href="#model-building-app-usecase-mapsubtract-3"><span class="std std-numref">Fig. 4.4</span></a> (C, top)). Have a look to each map and
structure to identify them and play with the density levels to
maximize the differences between the input <em>3D Map</em> restricted to the
penton area (<em>zone_Map</em>) and the penton atomic structure-derived map
(<em>molmap_chainM_Map</em>). The <a class="reference internal" href="#model-building-app-usecase-mapsubtract-3"><span class="std std-numref">Fig. 4.4</span></a> images A and B show the difference
<em>filtered_Map</em> in the penton side (A) and upper (B) views,
respectively, according to the density level observed on the <em>Volume
Viewer</em> panel (C, middle). Red arrows point at the densities
associated to the removed residues used as a density control. The
adjacent ten residues to the removed ones upstream and downstream are
green-highlighted. The penton upper view (B) was obtained opening the
main menu (<em>Tools -&gt; General -&gt; Side View</em> and setting the view as
indicated (C, botton). From these results we can conclude that a
remnant density in the upper part of the penton, if exits, it is not
so evident.</p>
<div class="figure align-center" id="model-building-app-usecase-mapsubtract-3">
<img alt="(A) Side view of the adenovirus penton atomic structure (magenta) and the gaussian filtered difference map (grey). (B) Upper view. (C) From top to bottom, *ChimeraX Models* panel, *Volume Viewer* panel, specified for the gaussian filtered difference map, and *Side View* panel, respectively." src="../../../../_images/Fig312.svg" /><p class="caption"><span class="caption-number">Fig. 4.4 </span><span class="caption-text"><em>(A)</em> Side view of the adenovirus penton atomic structure (magenta) and the gaussian filtered difference map (grey). (B) Upper view. (C) From top to bottom, <em>ChimeraX Models</em> panel, <em>Volume Viewer</em> panel, specified for the gaussian filtered difference map, and <em>Side View</em> panel, respectively.</span><a class="headerlink" href="#model-building-app-usecase-mapsubtract-3" title="Permalink to this image">¶</a></p>
</div>
<p>With the exception of the input adenovirus biological asymmetric unit
atomic structure, the rest of elements shown in <em>ChimeraX</em> graphics window
will also appear in the <em>ChimeraX</em> viewer that opens pressing <em>Analyze results</em>.
Consider then the possibility of performing additional operations and
saving them with the <em>scipionwrite</em> command before closing the
graphics window. After exiting the protocol you can visualize your
results.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
</li>
<li><div class="line-block">
<div class="line"><em>Use Case 2: Since the asymmetric unit of the human adenovirus
HAdV-C5 atomic structure contains a small chain called X (PDB ID
6B1T), we’d like to check if there is a remnant density in the
previous human adenovirus HAdV-F41 density map (EMDB ID EMD-10768)
that could be interpreted as the HAdV-C5’s chain X.</em></div>
</div>
<div class="line-block">
<div class="line">Aim: Run the workflow depicted in <a class="reference internal" href="#model-building-app-usecase-mapsubtract-4"><span class="std std-numref">Fig. 4.5</span></a> (A) to inspect for remnant
densities around the area covered by the hexons in the biological
asymmetric unit area of the adenovirus map (A, 6). The output of
all protocols can be seen in <em>ChimeraX</em> viewer by pressing <em>Analyze
Results</em>.</div>
</div>
<ul>
<li><div class="line-block">
<div class="line">In <a class="reference internal" href="#model-building-app-usecase-mapsubtract-1"><span class="std std-numref">Fig. 4.2</span></a> (B, C, D) you also have the output of protocols 1, 2 and 3.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">The output of the protocol 4 shows the atomic structure of human
adenovirus HAdV-C5. Select <em>Atoms -&gt; Hide</em> and <em>Cartoons -&gt;
Show</em> to change to ribbons the view of the structure. This
structure was fitted to the map asymmetric unit of adenovirus
HAdV-F41 by using the protocol <strong>chimerax-operator</strong> (6) and the result of this
oputput, overlapped to the geometrical map asymmetric unit, is
shown in <a class="reference internal" href="#model-building-app-usecase-mapsubtract-4"><span class="std std-numref">Fig. 4.5</span></a> (B). To visualize this map write in the command line:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">volume</span> <span class="c1">#2 transparency 0.8</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">and adjust level densities according to level indicated in the
shown <em>Volume Viewer</em> (<a class="reference internal" href="#model-building-app-usecase-mapsubtract-4"><span class="std std-numref">Fig. 4.5</span></a> (D)). Select <em>Atoms -&gt; Hide</em> and
<em>Cartoons -&gt; Show</em> to change to ribbons the view of the
structure.</div>
</div>
</li>
<li><p>The output of protocol 5 details some small chains of <em>ALA</em>
residues previously traced in the remnant density of the
adenovirus HAdV-F41. They are used as a control to be sure that we
identify new densities previously unmodeled. Since they are very
small we have depicted them selecting <em>Styles -&gt; Stick</em> and
overlapped to the geometrical map asymmetric unit (<a class="reference internal" href="#model-building-app-usecase-mapsubtract-4"><span class="std std-numref">Fig. 4.5</span></a> (C) with the
same transparency and map adjustment shown in (B).</p></li>
</ul>
<div class="figure align-center" id="model-building-app-usecase-mapsubtract-4">
<img alt="(A) *Scipion* workflow showing protocols 1-7. (B) HAdV-F41 adenovirus geometrical map asymmetric unit (grey) and, fitted to it, the atomic structure of the biological asymmetric unit atomic structure of HAdV-C5 adenovirus (colored). (C) HAdV-F41 adenovirus geometrical map asymmetric unit (grey) and some small aminoacid chains previously traced in the remnant density, imported in the protocol 5 (colored). (D) Level of density selected to visualize the map in B and C." src="../../../../_images/Fig314.svg" /><p class="caption"><span class="caption-number">Fig. 4.5 </span><span class="caption-text"><em>(A) Scipion</em> workflow showing protocols 1-7. (B) HAdV-F41 adenovirus geometrical map asymmetric unit (grey) and, fitted to it, the atomic structure of the biological asymmetric unit atomic structure of HAdV-C5 adenovirus (colored). (C) HAdV-F41 adenovirus geometrical map asymmetric unit (grey) and some small aminoacid chains previously traced in the remnant density, imported in the protocol 5 (colored). (D) Level of density selected to visualize the map in B and C.</span><a class="headerlink" href="#model-building-app-usecase-mapsubtract-4" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line">To look for remnant densities in the area of hexons we have to
complete the <strong>chimerax-subtraction</strong> protocol with the indicated params (<a class="reference internal" href="#model-building-app-usecase-mapsubtract-5"><span class="std std-numref">Fig. 4.6</span></a>). As in the
previous use case, we have selected half of input <em>3D Map</em>
resolution (4 Å) although other values could be tested.</div>
</div>
<div class="line-block">
<div class="line">Taking into account that the remnant densitities could be quite
inconspicuous we are going to use two different controls this time.
One of them will be, as in the previous use case, the deletion of 5
residues of hexon chain <em>D</em>, in a region presumed to be quite close
to the remnant density that we are looking for. The second control
will be some small aminoacid chains previously traced in the
remnant density since we’d like to discriminate between this
density and other new one and unmodeled density. These extra small chains
have to be included in the form param <em>Other atomic structures</em>.</div>
</div>
<div class="line-block">
<div class="line">Although this time we do not have to consider a specific chain or
applying symmetry, since we have to look for a chain similar to
HAdV-C5 adenovirus chain <em>X</em>, it is quite recommendable to include
in the form param <em>Other atomic structures</em> the structure 6B1T
fitted to the geometrical map asymmetric unit, as shown in <a class="reference internal" href="#model-building-app-usecase-mapsubtract-4"><span class="std std-numref">Fig. 4.5</span></a> (B), and
obtained from protocol 6 (A).</div>
</div>
<div class="figure align-center" id="model-building-app-usecase-mapsubtract-5">
<img alt="Completing the protocol **chimerax-subtraction** to find renmant densities in the biological asymmetric unit area of the adenovirus map." src="../../../../_images/Fig313.svg" /><p class="caption"><span class="caption-number">Fig. 4.6 </span><span class="caption-text">Completing the protocol <strong>chimerax-subtraction</strong> to find renmant densities in the biological asymmetric unit area of the adenovirus map.</span><a class="headerlink" href="#model-building-app-usecase-mapsubtract-5" title="Permalink to this image">¶</a></p>
</div>
<div class="line-block">
<div class="line">Protocol execution: Follow the general procedure shown above
(Protocol execution section) and <em>ChimeraX</em> graphics window will open. At
this point several maps and atomic structures will be shown, as the
<em>Models</em> panel indicates (<a class="reference internal" href="#model-building-app-usecase-mapsubtract-6"><span class="std std-numref">Fig. 4.7</span></a> (A, bottom)), except the <em>model</em> <em>#6</em>.
Have a look to each map and structure to identify them and play
with the density levels to maximize the differences between the
input <em>3D Map</em> (<em>output_volume.mrc</em>) and the <em>6YBA</em> atomic
structure-derived map (<em>molmap_Map</em>). <a class="reference internal" href="#model-building-app-usecase-mapsubtract-6"><span class="std std-numref">Fig. 4.7</span></a> (A) shows the difference
<em>filtered_Map</em> obtained. The zoom in on the framed area displays in
detail the difference considering two different map levels (B and
C). To have this view, besides select the molecules to show
according to the <em>Models</em> panel (A, bottom), write in <em>ChimeraX</em> command line:</div>
</div>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">volume</span> <span class="c1">#2 transparency 0.8</span>
<span class="n">select</span> <span class="c1">#4/X</span>
<span class="n">save</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="mi">6</span><span class="n">b1t_chainX</span><span class="o">.</span><span class="n">cif</span> <span class="nb">format</span> <span class="n">mmcif</span> <span class="n">models</span> <span class="c1">#4 selectedOnly true</span>
<span class="nb">open</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="mi">6</span><span class="n">b1t_chainX</span><span class="o">.</span><span class="n">cif</span>
</pre></div>
</div>
</div></blockquote>
<div class="line-block">
<div class="line">HAdV-C5 adenovirus chain <em>X</em> can be visualized as <em>model</em> <em>#6</em>.</div>
</div>
<p>The result, described in <a class="reference internal" href="#model-building-app-usecase-mapsubtract-6"><span class="std std-numref">Fig. 4.7</span></a>, doesn’t demonstrate a clear continuous
density in the proximity of the HAdV-C5 adenovirus chain <em>X</em>.
Although not very evident, it could be there. Then we cannot conclude
that it doesn’t exit, only that we were unable to identify it.</p>
<div class="figure align-center" id="model-building-app-usecase-mapsubtract-6">
<img alt="(A) Gaussian filtered difference map (grey) of adenovirus HAdV-F41 asymmetric unit (top) and *Models* panel of items loaded in *ChimeraX* including the *model* *#6* (bottom). (B) Zoom in on the subtracted area with the map density level indicated in the *Volume Viewer* below . (C) Idem with a higher cleaning of the background. The red arrow points at the control density. The green arrow points at the HAdV-C5 adenovirus chain *X*. The purple arrow points at one of the adenovirus HAdV-F41 small chains previously traced." src="../../../../_images/Fig315.svg" /><p class="caption"><span class="caption-number">Fig. 4.7 </span><span class="caption-text"><em>(A)</em> Gaussian filtered difference map (grey) of adenovirus HAdV-F41 asymmetric unit (top) and <em>Models</em> panel of items loaded in <em>ChimeraX</em> including the <em>model</em> <em>#6</em> (bottom). (B) Zoom in on the subtracted area with the map density level indicated in the <em>Volume Viewer</em> below . (C) Idem with a higher cleaning of the background. The red arrow points at the control density. The green arrow points at the HAdV-C5 adenovirus chain <em>X</em>. The purple arrow points at one of the adenovirus HAdV-F41 small chains previously traced.</span><a class="headerlink" href="#model-building-app-usecase-mapsubtract-6" title="Permalink to this image">¶</a></p>
</div>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="a020-chimeraOperate.html" class="btn btn-neutral float-right" title="5. ChimeraX Operate protocol" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="a012-chimeraContacts.html" class="btn btn-neutral float-left" title="3. ChimeraX Contacts protocol" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: release-3.0.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../../gh-pages/index.html">gh-pages</a></dd>
            <dd><a href="../../../../release-2.0.0/index.html">release-2.0.0</a></dd>
            <dd><a href="../../../../release-3.0.0/docs/user/tutorials/modelBuilding/a013-chimeraMapSubtraction.html">release-3.0.0</a></dd>
            <dd><a href="../../../../rm_model_building/docs/user/tutorials/modelBuilding/a013-chimeraMapSubtraction.html">rm_model_building</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>