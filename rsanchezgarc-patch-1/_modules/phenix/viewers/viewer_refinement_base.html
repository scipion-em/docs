

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>phenix.viewers.viewer_refinement_base &mdash; Scipion 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/scipion-modes/how-to-install.html">Installing Scipion v3.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/scipion-modes/host-configuration.html">Host configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/user-documentation.html#tutorials">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/user-documentation.html#processing-how-to-s">Processing How Toâ€™s</a></li>
</ul>
<p class="caption"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/facilities/facilities.html">On-the-fly processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/facilities/customize-report.html">Summary Reports</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/api/scipion-API.html">Scipion API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/api/plugins-API.html">Plugins API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/api/xmipp-API.html">Xmipp API</a></li>
</ul>
<p class="caption"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/misc/contact-us.html">Contact Us</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../phenix.html">phenix</a> &raquo;</li>
        
      <li>phenix.viewers.viewer_refinement_base</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for phenix.viewers.viewer_refinement_base</h1><div class="highlight"><pre>
<span></span><span class="c1"># **************************************************************************</span>
<span class="c1"># *</span>
<span class="c1"># * Authors:     Roberto Marabini (roberto@cnb.csic.es)</span>
<span class="c1"># *              Marta Martinez (mmmtnez@cnb.csic.es)</span>
<span class="c1"># *</span>
<span class="c1"># * Unidad de  Bioinformatica of Centro Nacional de Biotecnologia , CSIC</span>
<span class="c1"># *</span>
<span class="c1"># * This program is free software; you can redistribute it and/or modify</span>
<span class="c1"># * it under the terms of the GNU General Public License as published by</span>
<span class="c1"># * the Free Software Foundation; either version 2 of the License, or</span>
<span class="c1"># * (at your option) any later version.</span>
<span class="c1"># *</span>
<span class="c1"># * This program is distributed in the hope that it will be useful,</span>
<span class="c1"># * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># * GNU General Public License for more details.</span>
<span class="c1"># *</span>
<span class="c1"># * You should have received a copy of the GNU General Public License</span>
<span class="c1"># * along with this program; if not, write to the Free Software</span>
<span class="c1"># * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA</span>
<span class="c1"># * 02111-1307  USA</span>
<span class="c1"># *</span>
<span class="c1"># *  All comments concerning this program package may be sent to the</span>
<span class="c1"># *  e-mail address &#39;scipion@cnb.csic.es&#39;</span>
<span class="c1"># *</span>
<span class="c1"># **************************************************************************</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">phenix</span> <span class="kn">import</span> <span class="n">PHENIXVERSION</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">messagebox</span>
<span class="kn">from</span> <span class="nn">pyworkflow.viewer</span> <span class="kn">import</span> <span class="n">DESKTOP_TKINTER</span><span class="p">,</span> <span class="n">WEB_DJANGO</span><span class="p">,</span> <span class="n">ProtocolViewer</span>
<span class="kn">from</span> <span class="nn">pwem.viewers</span> <span class="kn">import</span> <span class="n">TableView</span><span class="p">,</span> <span class="n">Chimera</span>
<span class="kn">from</span> <span class="nn">pyworkflow.protocol.params</span> <span class="kn">import</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">EnumParam</span>
<span class="kn">from</span> <span class="nn">phenix</span> <span class="kn">import</span> <span class="n">Plugin</span>
<span class="kn">from</span> <span class="nn">pyworkflow.tests</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pwem.objects</span> <span class="kn">import</span> <span class="n">String</span>
<span class="kn">from</span> <span class="nn">pwem</span> <span class="kn">import</span> <span class="n">Domain</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">ValuesView</span>

<div class="viewcode-block" id="errorWindow"><a class="viewcode-back" href="../../../api/phenix/phenix.viewers.viewer_refinement_base.html#phenix.viewers.viewer_refinement_base.errorWindow">[docs]</a><span class="k">def</span> <span class="nf">errorWindow</span><span class="p">(</span><span class="n">tkParent</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># if tkRoot is null the error message may be behind</span>
        <span class="c1"># other windows</span>
        <span class="n">messagebox</span><span class="o">.</span><span class="n">showerror</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span>  <span class="c1"># bar title</span>
                              <span class="n">msg</span><span class="p">,</span>  <span class="c1"># message</span>
                              <span class="n">parent</span><span class="o">=</span><span class="n">tkParent</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">((</span><span class="s2">&quot;Error:&quot;</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span></div>


<div class="viewcode-block" id="PhenixProtRefinementBaseViewer"><a class="viewcode-back" href="../../../api/phenix/phenix.viewers.viewer_refinement_base.html#phenix.viewers.viewer_refinement_base.PhenixProtRefinementBaseViewer">[docs]</a><span class="k">class</span> <span class="nc">PhenixProtRefinementBaseViewer</span><span class="p">(</span><span class="n">ProtocolViewer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; base for molprovity and real space refine programs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_environments</span> <span class="o">=</span> <span class="p">[</span><span class="n">DESKTOP_TKINTER</span><span class="p">,</span> <span class="n">WEB_DJANGO</span><span class="p">]</span>

    <span class="n">COOT</span> <span class="o">=</span> <span class="s1">&#39;coot&#39;</span>
    <span class="n">ANALYSISTMPFILE</span> <span class="o">=</span> <span class="s1">&#39;tmpAnalysisFile.txt&#39;</span>
    <span class="n">RAMATMPFILE</span> <span class="o">=</span> <span class="s1">&#39;Ramachandran_write_plot.py&#39;</span>
    <span class="n">ROTATMPFILE</span> <span class="o">=</span> <span class="s2">&quot;Rotamer_write_plot.py&quot;</span>
    <span class="n">MULTICPLOTTMPFILE</span> <span class="o">=</span> <span class="s2">&quot;Multi_criterion_plot.py&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">ProtocolViewer</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">MOLPROBITYOUTFILENAME</span><span class="p">)):</span>
            <span class="n">MOLPROBITYOUTFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">MOLPROBITYOUTFILENAME</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parseFile</span><span class="p">(</span><span class="n">MOLPROBITYOUTFILENAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">==</span> <span class="n">PHENIXVERSION</span> <span class="ow">or</span> \
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">MOLPROBITYPKLFILENAME</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MOLPROBITYPKLFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">MOLPROBITYPKLFILENAME</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_writePickleData</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">,</span>
                                   <span class="n">object_pairs_hook</span><span class="o">=</span><span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_defineParams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">form</span><span class="p">):</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addSection</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Volume and models&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;displayMapModel&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                      <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Volume and models in ChimeraX&quot;</span><span class="p">,</span>
                      <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Display of input volume(s) and atomic structure(s).&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Plugin</span><span class="o">.</span><span class="n">getPhenixVersion</span><span class="p">()</span> <span class="o">==</span> <span class="n">PHENIXVERSION</span> <span class="ow">or</span> \
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">MOLPROBITYPKLFILENAME</span><span class="p">)):</span>
            <span class="n">form</span><span class="o">.</span><span class="n">addSection</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;MolProbity results&#39;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Summary MolProbity&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMolProbityResults&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;MolProbity Basic Statistics&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Validation of protein geometry. Statistics &quot;</span>
                           <span class="s2">&quot;computed by the &quot;</span>
                           <span class="s2">&quot;PHENIX package using the same distributions as &quot;</span>
                           <span class="s2">&quot;the MolProbity web server.&quot;</span>
                           <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Ramachandran outliers: Outlier &quot;</span>
                           <span class="s2">&quot;residues that show an unusual &quot;</span>
                           <span class="s2">&quot;combination of their phi and psi &quot;</span>
                           <span class="s2">&quot;torsion angles. Ramachandran outlier score is &quot;</span>
                           <span class="s2">&quot;computed as the percentage of Ramachandran &quot;</span>
                           <span class="s2">&quot;outliers regarding the total number of residues &quot;</span>
                           <span class="s2">&quot;in the entry showing outlier assessment.&quot;</span>
                           <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Ramachandran &quot;</span>
                           <span class="s2">&quot;favored: Residues that show an normal &quot;</span>
                           <span class="s2">&quot;combination of their phi and psi &quot;</span>
                           <span class="s2">&quot;torsion angles. Ramachandran favored score is &quot;</span>
                           <span class="s2">&quot;computed as the percentage of Ramachandran &quot;</span>
                           <span class="s2">&quot;outliers regarding the total number of residues &quot;</span>
                           <span class="s2">&quot;in the entry showing outlier assessment. Between &quot;</span>
                           <span class="s2">&quot;the favored and outlier regions in the &quot;</span>
                           <span class="s2">&quot;Ramachandran plot, there is a small region of &quot;</span>
                           <span class="s2">&quot;allowed residues.</span><span class="se">\n\n</span><span class="s2">Rotamer outliers: Residues &quot;</span>
                           <span class="s2">&quot;that adopt unusual chi torsion angles &quot;</span>
                           <span class="s2">&quot;(non-rotameric), used to describe &quot;</span>
                           <span class="s2">&quot;the conformation of protein sidechains. The &quot;</span>
                           <span class="s2">&quot;score of rotamer outliers is computed as &quot;</span>
                           <span class="s2">&quot;the percentage of residues with non-rotameric &quot;</span>
                           <span class="s2">&quot;angles.</span><span class="se">\n\n</span><span class="s2">C-beta outliers: Residues that show an &quot;</span>
                           <span class="s2">&quot;unusual deviation (higher than 0.25 A) of the &quot;</span>
                           <span class="s2">&quot;beta carbon from its ideal position. &quot;</span>
                           <span class="s2">&quot;This deviation of beta carbon &quot;</span>
                           <span class="s2">&quot;indicates incompatibilities between sidechain and &quot;</span>
                           <span class="s2">&quot;backbone.</span><span class="se">\n\n</span><span class="s2">Clashscore: Score associated to the &quot;</span>
                           <span class="s2">&quot;number of pairs of non-bonded atoms in the model &quot;</span>
                           <span class="s2">&quot;that are unusually close to each other. These &quot;</span>
                           <span class="s2">&quot;clashing atoms show unfavorable steric overlaps &quot;</span>
                           <span class="s2">&quot;of van der Waals shells. Steric clashes in &quot;</span>
                           <span class="s2">&quot;proteins are defined based on the Van der Waals &quot;</span>
                           <span class="s2">&quot;repulsion energy of the clashing atoms. &quot;</span>
                           <span class="s2">&quot;The clashscore is computed as the &quot;</span>
                           <span class="s2">&quot;number of serious clashes per 1000 atoms. &quot;</span>
                           <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">RMS (bonds): Root-mean-square deviation of &quot;</span>
                           <span class="s2">&quot;macromolecular bond lengths. &quot;</span>
                           <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">RMS (angles): Root-mean-square deviation of &quot;</span>
                           <span class="s2">&quot;macromolecular bond angles. &quot;</span>
                           <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Overall score: Score that represents the &quot;</span>
                           <span class="s2">&quot;experimental resolution expected for a model of &quot;</span>
                           <span class="s2">&quot;this quality; ideally the score should be lower &quot;</span>
                           <span class="s2">&quot;than the actual resolution.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCootOutliers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                            <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Open in Coot&quot;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Interactive visualization of outliers and clashes&quot;</span>
                           <span class="s2">&quot; with Coot:</span><span class="se">\n\n</span><span class="s2">Ramachandran outliers</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;Rotamer outliers</span><span class="se">\n</span><span class="s2">C-beta outliers</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;Severe clashes &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_len_missing_atoms&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMissingAtoms&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Missing atoms&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;For clarity, hydrogen atoms are not included&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Basic Geometry: Bond Length Restraints&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showBLrestraints&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Deviations&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Check here the number of outlier pairs of atoms &quot;</span>
                            <span class="s2">&quot;according to the bond length restraints &quot;</span>
                            <span class="s2">&quot;between pairs of linked atoms.</span><span class="se">\n</span><span class="s2">Warning!!!: &quot;</span>
                            <span class="s2">&quot;Refined structures should not have any outliers&quot;</span>
                            <span class="s2">&quot; except those are obvious in high &quot;</span>
                            <span class="s2">&quot;resolution electron density maps.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictBLRestraints</span><span class="p">[</span><span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showBLoutliers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Outliers&quot;</span><span class="p">,</span>
                               <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List of outlier pairs of atoms (sorted by deviation) &quot;</span>
                                <span class="s2">&quot;according to the bond length restraints.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Basic Geometry: Bond Angle Restraints&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showBArestraints&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Deviations&quot;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Check here the number of outlier triplets of atoms &quot;</span>
                            <span class="s2">&quot;according &quot;</span>
                            <span class="s2">&quot;to the bond angle restraints.</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;Warning!!!: Refined structures should not &quot;</span>
                            <span class="s2">&quot;have any outliers except those are obvious in &quot;</span>
                            <span class="s2">&quot;high resolution electron density maps.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictBARestraints</span><span class="p">[</span><span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showBAoutliers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Outliers&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List of outlier triplets of atoms (sorted by &quot;</span>
                                <span class="s2">&quot;deviation) according to the bond angle &quot;</span>
                                <span class="s2">&quot;restraints&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Basic Geometry: Dihedral Angle Restraints&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showDArestraints&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Deviations&quot;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Check here the number of outlier tetrads of atoms &quot;</span>
                            <span class="s2">&quot;according &quot;</span>
                            <span class="s2">&quot;to the side chain dihedral torsion (chi) angle &quot;</span>
                            <span class="s2">&quot;restraints.</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;Warning!!!: Refined structures should not &quot;</span>
                            <span class="s2">&quot;have any outliers except those are obvious in &quot;</span>
                            <span class="s2">&quot;high resolution electron density maps.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictDARestraints</span><span class="p">[</span><span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showDAoutliers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Outliers&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List of outlier tetrads of atoms (&quot;</span>
                                                  <span class="s2">&quot;sorted by deviation) &quot;</span>
                                                  <span class="s2">&quot;according to the dihedral &quot;</span>
                                                  <span class="s2">&quot;angle restraints&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Basic Geometry: Chirality Restraints&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCHILrestraints&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Deviations&quot;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Check here the number of outlier tetrads of atoms &quot;</span>
                            <span class="s2">&quot;according to the volume chirality &quot;</span>
                            <span class="s2">&quot;restraints.</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;Warning!!!: Refined structures should not &quot;</span>
                            <span class="s2">&quot;have any outliers except those are obvious &quot;</span>
                            <span class="s2">&quot;in high resolution electron density maps.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictChilRestraints</span><span class="p">[</span><span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCHILoutliers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Outliers&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;List of outlier tetrads of atoms (&quot;</span>
                                                  <span class="s2">&quot;sorted by deviation) &quot;</span>
                                                  <span class="s2">&quot;according to the volume &quot;</span>
                                                  <span class="s2">&quot;chirality restraints&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Basic Geometry: Planarity Restraints&#39;</span><span class="p">)</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showPLANARrestraints&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Deviations&quot;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Check here the number of outliers of planar &quot;</span>
                            <span class="s2">&quot;groups, such as aromatic rings,&quot;</span>
                            <span class="s2">&quot;according to the planar &quot;</span>
                            <span class="s2">&quot;restraints.</span><span class="se">\n</span><span class="s2">&quot;</span>
                            <span class="s2">&quot;Warning!!!: Refined structures should not &quot;</span>
                            <span class="s2">&quot;have any outliers except those are obvious &quot;</span>
                            <span class="s2">&quot;in high resolution electron density maps.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictPlanarRestraints</span><span class="p">[</span><span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outliers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showPLANARoutliers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Outliers&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s1">&#39;List of planar group outliers &#39;</span>
                                <span class="s1">&#39;(sorted by deviation)&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_protein&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Protein&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plotList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Ramachandran plot&#39;</span><span class="p">,</span> <span class="s1">&#39;Chi1-Chi2 plot&#39;</span><span class="p">]</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;plotType&#39;</span><span class="p">,</span> <span class="n">EnumParam</span><span class="p">,</span>
                                <span class="n">choices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">plotList</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Select plot:&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Select a plot type. Ramachandran plot is &quot;</span>
                                <span class="s2">&quot;chosen by default. Chi1-Chi2 plot shows &quot;</span>
                                <span class="s2">&quot;rotameric angles</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showPlotType&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">label</span><span class="o">=</span><span class="s2">&quot;View plot&quot;</span><span class="p">,</span>
                           <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_percent_rama_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showRamaOutliersTable&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ramachandran outliers:&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Ramachandran outliers are those aminoacids&quot;</span>
                                         <span class="s2">&quot; with non-favourable dihedral angles. &quot;</span>
                                         <span class="s2">&quot;Most of the time, Ramachandran outliers are &quot;</span>
                                         <span class="s2">&quot;a consequence of mistakes during the data &quot;</span>
                                         <span class="s2">&quot;processing.&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoRamaOutliers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No Ramachandran outliers detected&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_percent_rota_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showRotaOutliersTable&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Rotamer outliers: &quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Although a residue may lie in the &quot;</span>
                                     <span class="s2">&quot;favored regions of the Chi1-Chi2 plot, &quot;</span>
                                     <span class="s2">&quot;outliers are flagged based on the &quot;</span>
                                     <span class="s2">&quot;distribution of all non-branched Chi &quot;</span>
                                     <span class="s2">&quot;angles in a residue.</span><span class="se">\n</span><span class="s2">Zero outliers is &quot;</span>
                                     <span class="s2">&quot;not the goal. Rotamer outliers can be  &quot;</span>
                                     <span class="s2">&quot;justified by sufficiently strong &quot;</span> \
                                     <span class="s2">&quot;electron density, van der Waals &quot;</span>
                                     <span class="s2">&quot;packing, and/or hydrogen bonds.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoRotaOutliers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No Rotamer outliers detected&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_cbeta_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCbetaOutliersTable&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;C-beta outliers:&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;C-beta position outliers (position &quot;</span>
                                     <span class="s2">&quot;deviates from ideal by more than &quot;</span>
                                     <span class="s2">&quot;0.25A).</span><span class="se">\n\n</span><span class="s2">Ideal CB position is &quot;</span>
                                     <span class="s2">&quot;determined from the average of the &quot;</span>
                                     <span class="s2">&quot;ideal C-N-CA-CB and N-C-CA-CB dihedrals.&quot;</span>
                                     <span class="s2">&quot; This measure is more sensitive than&quot;</span>
                                     <span class="s2">&quot; individual measures to both sidechain &quot;</span>
                                     <span class="s2">&quot;and mainchain misfittings.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoCbetaOutliers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No C-beta position outliers detected&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;C-beta position outliers (position &quot;</span>
                                     <span class="s2">&quot;deviates from ideal by more than &quot;</span>
                                     <span class="s2">&quot;0.25A).</span><span class="se">\n\n</span><span class="s2">Ideal CB position is &quot;</span>
                                     <span class="s2">&quot;determined from the average of the &quot;</span>
                                     <span class="s2">&quot;ideal C-N-CA-CB and N-C-CA-CB dihedrals.&quot;</span>
                                     <span class="s2">&quot; This measure is more sensitive than&quot;</span>
                                     <span class="s2">&quot; individual measures to both sidechain &quot;</span>
                                     <span class="s2">&quot;and mainchain misfittings.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_nqh_flips_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showBackAsnGlnHisSidechains&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Recommended Asn/Gln/His sidechain &quot;</span>
                                      <span class="s2">&quot;flips:&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Asn, Gln, and His sidechains are &quot;</span>
                                     <span class="s2">&quot;asymmetric and may require flipping to &quot;</span>
                                     <span class="s2">&quot;form favorable van der Waals contacts &quot;</span>
                                     <span class="s2">&quot;and hydrogen bonding.</span><span class="se">\n\n</span><span class="s2">REDUCE &quot;</span>
                                     <span class="s2">&quot;(phenix.reduce) has been run on your &quot;</span>
                                     <span class="s2">&quot;file to add hydrogens necessary for &quot;</span>
                                     <span class="s2">&quot;identifying clashes and has also &quot;</span>
                                     <span class="s2">&quot;identified the following residues &quot;</span>
                                     <span class="s2">&quot;as needing to be flipped. Note that &quot;</span>
                                     <span class="s2">&quot;phenix.refine will often perform these &quot;</span>
                                     <span class="s2">&quot;flips by default.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoSidechainFlips&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No sidechain flips required&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Asn, Gln, and His sidechains are &quot;</span>
                                     <span class="s2">&quot;asymmetric and may require flipping to &quot;</span>
                                     <span class="s2">&quot;form favorable van der Waals contacts &quot;</span>
                                     <span class="s2">&quot;and hydrogen bonding.</span><span class="se">\n\n</span><span class="s2">REDUCE &quot;</span>
                                     <span class="s2">&quot;(phenix.reduce) has been run on your &quot;</span>
                                     <span class="s2">&quot;file to add hydrogens necessary for &quot;</span>
                                     <span class="s2">&quot;identifying clashes and has also &quot;</span>
                                     <span class="s2">&quot;identified the following residues &quot;</span>
                                     <span class="s2">&quot;as needing to be flipped. Note that &quot;</span>
                                     <span class="s2">&quot;phenix.refine will often perform these &quot;</span>
                                     <span class="s2">&quot;flips by default.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_omega_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCisAndTwistedPeptides&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Cis and Twisted peptides:&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Cis conformations are observed in &quot;</span>
                                     <span class="s2">&quot;about 5</span><span class="si">% o</span><span class="s2">f Prolines.</span><span class="se">\n\n</span><span class="s2">Cis &quot;</span>
                                     <span class="s2">&quot;conformations are observed in about &quot;</span>
                                     <span class="s2">&quot;0.03</span><span class="si">% o</span><span class="s2">f general residues.</span><span class="se">\n\n</span><span class="s2">Twisted &quot;</span>
                                     <span class="s2">&quot;peptides are almost certainly &quot;</span>
                                     <span class="s2">&quot;modeling errors.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoNonTransPeptides&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No non-trans peptides detected&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Cis conformations are observed in &quot;</span>
                                    <span class="s2">&quot;about 5</span><span class="si">% o</span><span class="s2">f Prolines.</span><span class="se">\n\n</span><span class="s2">Cis &quot;</span>
                                    <span class="s2">&quot;conformations are observed in about &quot;</span>
                                    <span class="s2">&quot;0.03</span><span class="si">% o</span><span class="s2">f general residues.</span><span class="se">\n\n</span><span class="s2">Twisted &quot;</span>
                                    <span class="s2">&quot;peptides are almost certainly &quot;</span>
                                    <span class="s2">&quot;modeling errors.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_clashes&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Clashes&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_clashes_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showClashes&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All atom-contact analysis&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;This list summarizes all severe clashes &quot;</span>
                                     <span class="s2">&quot;(more than 0.4 Angstrom non-H-bond &quot;</span>
                                     <span class="s2">&quot;overlap) found by PROBE; you can view &quot;</span>
                                     <span class="s2">&quot;these graphically in Coot. If no &quot;</span>
                                     <span class="s2">&quot;hydrogens were present, REDUCE was &quot;</span>
                                     <span class="s2">&quot;used to add them prior to running &quot;</span>
                                     <span class="s2">&quot;PROBE.&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoClashes&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;No bad contacts (&gt; 0.4A overlap) found.&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;This list summarizes all severe clashes &quot;</span>
                                     <span class="s2">&quot;(more than 0.4 Angstrom non-H-bond &quot;</span>
                                     <span class="s2">&quot;overlap) found by PROBE; you can view &quot;</span>
                                     <span class="s2">&quot;these graphically in Coot. If no &quot;</span>
                                     <span class="s2">&quot;hydrogens were present, REDUCE was &quot;</span>
                                     <span class="s2">&quot;used to add them prior to running &quot;</span>
                                     <span class="s2">&quot;PROBE.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_rna_group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;RNA restraint outliers&#39;</span><span class="p">)</span>
                <span class="c1"># TODO: Describe functions for RNA (Validation.Molprobity.py)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_bonds_rna_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;_showRNABonds&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RNA nucleotides with excessive bond&quot;</span>
                                     <span class="s2">&quot; lengths:&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoBonds&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All bonds within expected limits&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_angles_rna_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;_showRNAAngles&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RNA nucleotides with improper dihedral &quot;</span>
                                     <span class="s2">&quot;angles:&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoAngles&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All dihedral angles within expected &quot;</span>
                                     <span class="s2">&quot;limits&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_puckers_rna_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;_showRNASugarPuckers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RNA nucleotides with improper sugar &quot;</span>
                                     <span class="s2">&quot;puckers:&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoPuckers&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All sugar puckers in appropriate &quot;</span>
                                     <span class="s2">&quot;conformations&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_suites_rna_outliers&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;_showRNASuites&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RNA nucleotides with bad backbone &quot;</span>
                                     <span class="s2">&quot;angles:&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNosuites&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Backbone angles within expected ranges&quot;</span><span class="p">,</span>
                                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_overall_rsc&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">):</span>
                <span class="n">form</span><span class="o">.</span><span class="n">addSection</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real-space correlation&#39;</span><span class="p">)</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Real-space correlation to electron density&#39;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMultiCriterionPlot&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;View Multi-criterion plot&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;This plot shows simultaneously &quot;</span>
                                <span class="s2">&quot;Real-space correlation coefficients &quot;</span>
                                <span class="s2">&quot;and B-factor values for each residue.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showOverallRSCResults&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Correlation Coefficients&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Real-space correlation</span><span class="se">\n\n</span><span class="s2">For a detailed &quot;</span>
                                 <span class="s2">&quot;definition of Mask CC, Volume CC and Peak &quot;</span>
                                 <span class="s2">&quot;CC, see Afonine, P. V., Klaholz, B. K., &quot;</span>
                                 <span class="s2">&quot;Moriarty, N. W., Poon, B. K., Sobolev, &quot;</span>
                                 <span class="s2">&quot;O. V., Terwilliger, T. C., Adams, P. D. &quot;</span>
                                 <span class="s2">&quot;&amp; Urzhumtsev, A. (2018). bioRxiv. &quot;</span>
                                 <span class="s2">&quot;https://doi.org/10.1101/249607.</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                                 <span class="s2">&quot;Mask CC: Model-to-map correlation &quot;</span>
                                 <span class="s2">&quot;coefficient calculated in the map region &quot;</span>
                                 <span class="s2">&quot;around the model, using map values inside &quot;</span>
                                 <span class="s2">&quot;a mask calculated around the macromolecule&quot;</span>
                                 <span class="s2">&quot;.</span><span class="se">\n\n</span><span class="s2">Volume CC and Peak CC compare only &quot;</span>
                                 <span class="s2">&quot;map regions with the highest density values &quot;</span>
                                 <span class="s2">&quot;and regions below a certain contouring &quot;</span>
                                 <span class="s2">&quot;threshold level are ignored.</span><span class="se">\n</span><span class="s2">Volume CC: &quot;</span>
                                 <span class="s2">&quot;The map region considered is defined by &quot;</span>
                                 <span class="s2">&quot;the N highest points inside the molecular &quot;</span>
                                 <span class="s2">&quot;mask.</span><span class="se">\n</span><span class="s2">Peak CC: In this case, calculations &quot;</span>
                                 <span class="s2">&quot;consider the union of regions defined by &quot;</span>
                                 <span class="s2">&quot;the N highest peaks in the model-calculated &quot;</span>
                                 <span class="s2">&quot;map and the N highest peaks in the &quot;</span>
                                 <span class="s2">&quot;experimental map.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">residueTypeList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Protein&#39;</span><span class="p">,</span> <span class="s1">&#39;Other&#39;</span><span class="p">,</span> <span class="s1">&#39;Water&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;Everything&#39;</span><span class="p">]</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;residueType&#39;</span><span class="p">,</span> <span class="n">EnumParam</span><span class="p">,</span>
                                <span class="n">choices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">residueTypeList</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Residue Type:&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Select a residue Type. Protein is chosen by &quot;</span>
                                 <span class="s2">&quot;default.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ccBelowList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0.1&#39;</span><span class="p">,</span> <span class="s1">&#39;0.2&#39;</span><span class="p">,</span> <span class="s1">&#39;0.3&#39;</span><span class="p">,</span> <span class="s1">&#39;0.4&#39;</span><span class="p">,</span> <span class="s1">&#39;0.5&#39;</span><span class="p">,</span> <span class="s1">&#39;0.6&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;0.7&#39;</span><span class="p">,</span> <span class="s1">&#39;0.8&#39;</span><span class="p">,</span> <span class="s1">&#39;0.9&#39;</span><span class="p">,</span> <span class="s1">&#39;1.0&#39;</span><span class="p">]</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;ccIndex&#39;</span><span class="p">,</span> <span class="n">EnumParam</span><span class="p">,</span>
                                <span class="n">choices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ccBelowList</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Show CC below:&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Select a decimal. CC 0.8 is chosen by &quot;</span>
                                 <span class="s2">&quot;default.&quot;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showCCTable&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Table of Real-space correlation &quot;</span>
                                  <span class="s2">&quot;coefficients&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Residue: Protein chain, &quot;</span>
                                 <span class="s2">&quot;aminoacid index, and aminoacid name.</span><span class="se">\n</span><span class="s2">&quot;</span>
                                 <span class="s2">&quot;B_iso: Isotropic B-factor value for &quot;</span>
                                 <span class="s2">&quot;residue (Disorder measure that quantitates &quot;</span>
                                 <span class="s2">&quot;the level of thermal motion).</span><span class="se">\n</span><span class="s2">Occupancy: &quot;</span>
                                 <span class="s2">&quot;Disorder measure to indicate alternate &quot;</span>
                                 <span class="s2">&quot;location of multiple side chain atoms. &quot;</span>
                                 <span class="s2">&quot;Occupancies normally add up to unity. If &quot;</span>
                                 <span class="s2">&quot;no alternates have been observed, the &quot;</span>
                                 <span class="s2">&quot;occupancy equals to 1.00.</span><span class="se">\n</span><span class="s2">2Fo-Fc: Electron &quot;</span>
                                 <span class="s2">&quot;density computed as 2Fo (Fo: structure &quot;</span>
                                 <span class="s2">&quot;factors from the diffraction patterns; &quot;</span>
                                 <span class="s2">&quot;experimental data) minus Fc (structure &quot;</span>
                                 <span class="s2">&quot;factor amplitudes calculated from model &quot;</span>
                                 <span class="s2">&quot;phases).</span><span class="se">\n</span><span class="s2">Fmodel: Model structure factors &quot;</span>
                                 <span class="s2">&quot;including all scales.</span><span class="se">\n</span><span class="s2">CC: Correlation &quot;</span>
                                 <span class="s2">&quot;coefficent between the observed map and &quot;</span>
                                 <span class="s2">&quot;model-derived map in the real space.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Fourier shell correlations&#39;</span><span class="p">)</span>
                <span class="n">_atomRadius</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%0.3f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_atom_radius&#39;</span><span class="p">]</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showAtomRadius&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Atom Mask Radius (Angstroms): &quot;</span> <span class="o">+</span>
                                <span class="nb">str</span><span class="p">(</span><span class="n">_atomRadius</span><span class="p">),</span>
                                <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Radius of the &quot;Fourier Shell&quot;, a spherical &#39;</span>
                                 <span class="s1">&#39;volume mask in Fourier space.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;displayFSCplot&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fourier Shell Correlation plot&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;FSC regarding spatial frequency &quot;</span>
                                 <span class="s2">&quot;(1/Angstroms)&quot;</span><span class="p">)</span>
            <span class="n">form</span><span class="o">.</span><span class="n">addSection</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Atomic properties&#39;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;Occupancies&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_computeOccBFactor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_occ_bf_outliers&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">occupancyList</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showMesgNoOccupancies&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All occupancies okay&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showOccupancies&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Table of occupancies&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The table shows occupancy values lower &quot;</span>
                                 <span class="s2">&quot;than 1.0 for an atom when summed over &quot;</span>
                                 <span class="s2">&quot;alternative conformations (Type = atom) &quot;</span>
                                 <span class="s2">&quot;or for a residue when the occupancies for &quot;</span>
                                 <span class="s2">&quot;the atoms in a residue are not the same (&quot;</span>
                                 <span class="s2">&quot;Type = residue). Please check&quot;</span>
                                 <span class="s2">&quot; that they are correct.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">group</span> <span class="o">=</span> <span class="n">form</span><span class="o">.</span><span class="n">addGroup</span><span class="p">(</span><span class="s1">&#39;B-factor/ADPs&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_aniso_h&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_aniso_h&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)):</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showWarningAnisoH&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span> <span class="n">important</span><span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;WARNING: </span><span class="si">%d</span><span class="s2"> hydrogens have anisotropic &quot;</span>
                                <span class="s2">&quot;B-factors.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_aniso_h&#39;</span><span class="p">])</span>
            <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showIsotropicB&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                            <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Isotropic B:&quot;</span><span class="p">,</span>
                            <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The refinement against the map of B-factors or &quot;</span>
                            <span class="s2">&quot;Atomic Displacement Parameters (ADPs) is &quot;</span>
                            <span class="s2">&quot;performed at the last macro-cycle and using &quot;</span>
                            <span class="s2">&quot;reciprocal space.</span><span class="se">\n\n</span><span class="s2">Isotropic B: Temperature &quot;</span>
                            <span class="s2">&quot;factor or displacement parameter constraining &quot;</span>
                            <span class="s2">&quot;the motion of the atoms so it is the same in &quot;</span>
                            <span class="s2">&quot;all three directions.</span><span class="se">\n</span><span class="s2">Minimum, Maximum and Mean &quot;</span>
                            <span class="s2">&quot;are the statistic values of isotropic B-factor  &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suspiciousBFList</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showSuspiciousBfactors&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Suspicious B-factors&quot;</span><span class="p">,</span>
                                <span class="n">help</span><span class="o">=</span> <span class="s2">&quot;The table of Suspicious B-factors (ADP&quot;</span>
                                      <span class="s2">&quot; outliers) details all isotropic ADPs &quot;</span>
                                      <span class="s2">&quot;with values outside a range of plus &quot;</span>
                                      <span class="s2">&quot;or minus 4 sigmas around the mean &quot;</span>
                                      <span class="s2">&quot;value for the considered atomic &quot;</span>
                                      <span class="s2">&quot;structure. Although these B-factors &quot;</span>
                                      <span class="s2">&quot;are not neccessarily wrong, &quot;</span>
                                      <span class="s2">&quot;it may be worth checking the atomic &quot;</span>
                                      <span class="s2">&quot;positions, occupancies or element &quot;</span>
                                      <span class="s2">&quot;types shown in this table.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_zero_b&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">addParam</span><span class="p">(</span><span class="s1">&#39;showWarningSuspicious&#39;</span><span class="p">,</span> <span class="n">LabelParam</span><span class="p">,</span>
                                   <span class="n">important</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="n">label</span><span class="o">=</span><span class="s2">&quot;WARNING: </span><span class="si">%d</span><span class="s2"> atom(s) have &quot;</span>
                                         <span class="s2">&quot;B-factor(s) of zero, which indicates&quot;</span>
                                         <span class="s2">&quot; that either the occupancy or the &quot;</span>
                                         <span class="s2">&quot;element is incorrect.&quot;</span>
                                         <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_n_zero_b&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_getVisualizeDict</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span><span class="p">{</span>
            <span class="s1">&#39;displayMapModel&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displayMapModel</span><span class="p">,</span>
            <span class="s1">&#39;showMolProbityResults&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_visualizeMolProbityResults</span><span class="p">,</span>
            <span class="s1">&#39;showCootOutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCootOutliers</span><span class="p">,</span>
            <span class="s1">&#39;showMissingAtoms&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showMissingAtoms</span><span class="p">,</span>
            <span class="s1">&#39;showBLrestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBLrestraints</span><span class="p">,</span>
            <span class="s1">&#39;showBLoutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBLoutliers</span><span class="p">,</span>
            <span class="s1">&#39;showBArestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBArestraints</span><span class="p">,</span>
            <span class="s1">&#39;showBAoutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBAoutliers</span><span class="p">,</span>
            <span class="s1">&#39;showDArestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showDArestraints</span><span class="p">,</span>
            <span class="s1">&#39;showDAoutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showDAoutliers</span><span class="p">,</span>
            <span class="s1">&#39;showCHILrestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCHILrestraints</span><span class="p">,</span>
            <span class="s1">&#39;showCHILoutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCHILoutliers</span><span class="p">,</span>
            <span class="s1">&#39;showPLANARrestraints&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showPLANARrestraints</span><span class="p">,</span>
            <span class="s1">&#39;showPLANARoutliers&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showPLANARoutliers</span><span class="p">,</span>
            <span class="s1">&#39;showPlotType&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showPlotType</span><span class="p">,</span>
            <span class="s1">&#39;showRamaOutliersTable&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showRamaOutliersTable</span><span class="p">,</span>
            <span class="s1">&#39;showRotaOutliersTable&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showRotaOutliersTable</span><span class="p">,</span>
            <span class="s1">&#39;showCbetaOutliersTable&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCbetaOutliersTable</span><span class="p">,</span>
            <span class="s1">&#39;showBackAsnGlnHisSidechains&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showBackAsnGlnHisSidechains</span><span class="p">,</span>
            <span class="s1">&#39;showCisAndTwistedPeptides&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCisAndTwistedPeptides</span><span class="p">,</span>
            <span class="s1">&#39;showMultiCriterionPlot&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showMultiCriterionPlot</span><span class="p">,</span>
            <span class="s1">&#39;showOverallRSCResults&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showOverallRSCResults</span><span class="p">,</span>
            <span class="s1">&#39;showClashes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showClashes</span><span class="p">,</span>
            <span class="s1">&#39;showCCTable&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showCCTable</span><span class="p">,</span>
            <span class="s1">&#39;displayFSCplot&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_displayFSCplot</span><span class="p">,</span>
            <span class="s1">&#39;showOccupancies&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showOccupancies</span><span class="p">,</span>
            <span class="s1">&#39;showIsotropicB&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_showIsotropicB</span><span class="p">,</span>
            <span class="s1">&#39;showSuspiciousBfactors&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span> <span class="n">_showSuspiciousBfactors</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_displayMapModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">bildFileName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span><span class="s2">&quot;axis_output.bild&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_inputVol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputVolume</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">_inputVol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputStructure</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">getVolume</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">_inputVol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="n">_inputVol</span><span class="o">.</span><span class="n">getDim</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">sampling</span> <span class="o">=</span> <span class="n">_inputVol</span><span class="o">.</span><span class="n">getSamplingRate</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># To show pdbs only</span>
            <span class="n">dim</span> <span class="o">=</span> <span class="mf">150.</span>
            <span class="n">sampling</span> <span class="o">=</span> <span class="mf">1.</span>

        <span class="n">Chimera</span><span class="o">.</span><span class="n">createCoordinateAxisFile</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span>
                                 <span class="n">bildFileName</span><span class="o">=</span><span class="n">bildFileName</span><span class="p">,</span>
                                 <span class="n">sampling</span><span class="o">=</span><span class="n">sampling</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">fnCmd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span><span class="s2">&quot;chimera_output.cxc&quot;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fnCmd</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="c1"># change to workingDir</span>
        <span class="c1"># If we do not use cd and the project name has an space</span>
        <span class="c1"># the protocol fails even if we pass absolute paths</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;cd </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
        <span class="c1"># reference axis model = 1</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;open </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">bildFileName</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;cofr 0,0,0</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># set center of coordinates</span>

        <span class="c1"># input 3D map</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># 1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getInputVolume</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fnVol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getInputVolume</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">VOLUMEFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">MOLPROBITYFILE</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="s1">&#39;REALSPACEFILE&#39;</span><span class="p">):</span>
                    <span class="n">VOLUMEFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">REALSPACEFILE</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="s1">&#39;VALIDATIONCRYOEMFILE&#39;</span><span class="p">):</span>
                    <span class="n">VOLUMEFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">VALIDATIONCRYOEMFILE</span><span class="p">)</span>

            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;open </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">VOLUMEFILENAME</span><span class="p">)</span>
            <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">fnVol</span><span class="o">.</span><span class="n">getOrigin</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">getShifts</span><span class="p">()</span>
            <span class="n">sampling</span> <span class="o">=</span> <span class="n">fnVol</span><span class="o">.</span><span class="n">getSamplingRate</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;volume #</span><span class="si">%d</span><span class="s2"> style surface voxelSize </span><span class="si">%f</span><span class="se">\n</span><span class="s2">volume #</span><span class="si">%d</span><span class="s2"> origin &quot;</span>
                    <span class="s2">&quot;</span><span class="si">%0.2f</span><span class="s2">,</span><span class="si">%0.2f</span><span class="s2">,</span><span class="si">%0.2f</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="o">%</span> <span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">sampling</span><span class="p">,</span> <span class="n">counter</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fnVol</span><span class="o">.</span><span class="n">getHalfMaps</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">halfMap</span> <span class="ow">in</span> <span class="n">fnVol</span><span class="o">.</span><span class="n">getHalfMaps</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">):</span>
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">halfMap</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.mrc&quot;</span><span class="p">):</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;open </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">halfMap</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.mrc&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;open </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">halfMap</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;volume #</span><span class="si">%d</span><span class="s2"> style surface voxelSize </span><span class="si">%f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span>
                            <span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">sampling</span><span class="p">))</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;volume #</span><span class="si">%d</span><span class="s2"> origin </span><span class="si">%0.2f</span><span class="s2">,</span><span class="si">%0.2f</span><span class="s2">,</span><span class="si">%0.2f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span>
                            <span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">))</span>

        <span class="c1"># input PDB (usually from coot)</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># 2</span>
        <span class="n">pdbFileName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputStructure</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">getFileName</span><span class="p">()</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;open </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pdbFileName</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;style stick</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># refined PDB</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="s1">&#39;outputPdb&#39;</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># 3</span>
            <span class="n">pdbFileName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">outputPdb</span><span class="o">.</span><span class="n">getFileName</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;open </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">pdbFileName</span><span class="p">)</span>

        <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># run in the background</span>
        <span class="n">chimeraPlugin</span> <span class="o">=</span> <span class="n">Domain</span><span class="o">.</span><span class="n">importFromPlugin</span><span class="p">(</span><span class="s1">&#39;chimera&#39;</span><span class="p">,</span> <span class="s1">&#39;Plugin&#39;</span><span class="p">,</span> <span class="n">doRaise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">chimeraPlugin</span><span class="o">.</span><span class="n">runChimeraProgram</span><span class="p">(</span><span class="n">chimeraPlugin</span><span class="o">.</span><span class="n">getProgram</span><span class="p">(),</span> <span class="n">fnCmd</span> <span class="o">+</span> <span class="s2">&quot;&amp;&quot;</span><span class="p">,</span>
                                        <span class="n">cwd</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">_visualizeMolProbityResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictSummary</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.4</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Model Final Statistics&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Final Results Summary&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictX</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showCootOutliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">MOLPROBITYCOOTFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">MOLPROBITYCOOTFILENAME</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">args</span> <span class="o">+=</span> <span class="s2">&quot; --python &quot;</span> <span class="o">+</span> <span class="n">MOLPROBITYCOOTFILENAME</span>

        <span class="c1"># pdb file</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">hasAttribute</span><span class="p">(</span><span class="s1">&#39;outputPdb&#39;</span><span class="p">):</span>
            <span class="n">pdb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">outputPdb</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pdb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputStructure</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

        <span class="n">CootRefine</span> <span class="o">=</span> <span class="n">Domain</span><span class="o">.</span><span class="n">importFromPlugin</span><span class="p">(</span><span class="s1">&#39;ccp4.protocols&#39;</span><span class="p">,</span> <span class="s1">&#39;CootRefine&#39;</span><span class="p">,</span> <span class="n">doRaise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">project</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">getProject</span><span class="p">()</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;pdbFileToBeRefined&#39;</span><span class="p">:</span> <span class="n">pdb</span><span class="p">,</span>
                <span class="s1">&#39;doInteractive&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                <span class="s1">&#39;phythonscript&#39;</span><span class="p">:</span> <span class="n">String</span><span class="p">(</span><span class="n">MOLPROBITYCOOTFILENAME</span><span class="p">),</span>
                <span class="s1">&#39;inputProtocol&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span>
                <span class="p">}</span>

        <span class="c1"># volume</span>
        <span class="n">vol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_getInputVolume</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">vol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;inputVolumes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">vol</span><span class="p">]</span>

        <span class="n">protCoot</span> <span class="o">=</span> <span class="n">project</span><span class="o">.</span><span class="n">newProtocol</span><span class="p">(</span><span class="n">CootRefine</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
        <span class="n">protCoot</span><span class="o">.</span><span class="n">setObjLabel</span><span class="p">(</span><span class="s1">&#39;coot refinement</span><span class="se">\n</span><span class="s1">outliers</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">project</span><span class="o">.</span><span class="n">launchProtocol</span><span class="p">(</span><span class="n">protCoot</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_getInputVolume</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputVolume</span><span class="o">.</span><span class="n">get</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fnVol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputStructure</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">getVolume</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fnVol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">inputVolume</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fnVol</span>

    <span class="k">def</span> <span class="nf">_showMissingAtoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Chain&#39;</span><span class="p">,</span> <span class="s1">&#39;Residue&#39;</span><span class="p">,</span> <span class="s1">&#39;AtLoc&#39;</span><span class="p">,</span> <span class="s1">&#39;Missing atoms&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">chain</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">residue</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">atLoc</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">missingAtoms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_missing_atoms&#39;</span><span class="p">])):</span>
            <span class="n">chain</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_missing_atoms&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">residue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_missing_atoms&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">atLoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_missing_atoms&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">missingAtoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_missing_atoms&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">aL</span><span class="p">,</span> <span class="n">mA</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">chain</span><span class="p">,</span> <span class="n">residue</span><span class="p">,</span> <span class="n">atLoc</span><span class="p">,</span> <span class="n">missingAtoms</span><span class="p">):</span>
            <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">aL</span><span class="p">,</span> <span class="n">mA</span><span class="p">))</span>

        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Missing atoms&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Model missing atoms&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showBLrestraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictBLRestraints</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Bond Length Restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Basic Geometry&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictX</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showBLoutliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Atom1&#39;</span><span class="p">,</span> <span class="s1">&#39;Atom2&#39;</span><span class="p">,</span> <span class="s1">&#39;Ideal value&#39;</span><span class="p">,</span> <span class="s1">&#39;Model value&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;Deviation (sigmas)&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">blDataList</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;List of outliers (sorted by deviation)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Bond Length Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showBArestraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictBARestraints</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Bond Angle Restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Basic Geometry&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictX</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showBAoutliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Atoms&#39;</span><span class="p">,</span> <span class="s1">&#39;Ideal value&#39;</span><span class="p">,</span> <span class="s1">&#39;Model value&#39;</span><span class="p">,</span> <span class="s1">&#39;Deviation (&#39;</span>
                                                             <span class="s1">&#39;sigmas)&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">baDataList</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;List of outliers (sorted by deviation)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Bond Angle Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showDArestraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictDARestraints</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Dihedral Angle Restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Basic Geometry&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictX</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showDAoutliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Atoms&#39;</span><span class="p">,</span> <span class="s1">&#39;Ideal value&#39;</span><span class="p">,</span> <span class="s1">&#39;Model value&#39;</span><span class="p">,</span> <span class="s1">&#39;Deviation (&#39;</span>
                                                             <span class="s1">&#39;sigmas)&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">daDataList</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;List of outliers (sorted by deviation)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Dihedral Angle Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showCHILrestraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictChilRestraints</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Chirality Restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Basic Geometry&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictX</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showCHILoutliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Atoms&#39;</span><span class="p">,</span> <span class="s1">&#39;Ideal value&#39;</span><span class="p">,</span> <span class="s1">&#39;Model value&#39;</span><span class="p">,</span> <span class="s1">&#39;Deviation (&#39;</span>
                                                             <span class="s1">&#39;sigmas)&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chilDataList</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;List of outliers (sorted by deviation)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Chirality Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showPLANARrestraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;measure&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictPlanarRestraints</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Planarity Restraints</span><span class="se">\n</span><span class="s2">(Deviations from ideal values)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;MolProbity: Basic Geometry&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictX</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showPLANARoutliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Atoms&#39;</span><span class="p">,</span> <span class="s1">&#39;Max. delta&#39;</span><span class="p">,</span> <span class="s1">&#39;RMS (delta)&#39;</span><span class="p">,</span> <span class="s1">&#39;Deviation (&#39;</span>
                                                            <span class="s1">&#39;sigmas)&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">planarDataList</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;List of outliers (sorted by deviation)&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Planarity Restraints&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showPlotType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">plot_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotList</span><span class="p">[</span><span class="n">plot_index</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_writeCommand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listName</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">listName</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotList</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TMPFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ROTATMPFILE</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">TMPFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RAMATMPFILE</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TMPFILENAME</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">)</span>
        <span class="c1"># execute file with phenix.python</span>
        <span class="n">Plugin</span><span class="o">.</span><span class="n">runPhenixProgram</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TMPFILENAME</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showRamaOutliersTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_rama_headers&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_rama_outliers&#39;</span><span class="p">]</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Ramachandran outliers&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Ramachandran analysis&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showRotaOutliersTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_rota_headers&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_rota_outliers&#39;</span><span class="p">]</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Rotamer outliers&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Rotamer analysis&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showCbetaOutliersTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_cbeta_headers&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_cbeta_outliers&#39;</span><span class="p">]</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;C-beta position outliers&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;C-beta deviation analysis&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showBackAsnGlnHisSidechains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_nqh_flips_headers&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_nqh_flips_outliers&#39;</span><span class="p">]</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Recommended sidechain flips&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Backwards Asn/Gln/His sidechains&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showCisAndTwistedPeptides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_omega_headers&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_omega_outliers&#39;</span><span class="p">]</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Cis and Twisted peptides&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Cis and Twisted peptides analyis&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showClashes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_clashes_headers&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_clashes_outliers&#39;</span><span class="p">]</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Bad contacts from PROBE: </span><span class="si">%d</span><span class="s2"> overlapping atom pairs&quot;</span> \
               <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataList</span><span class="p">)</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;All atom-contact analyis&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showMultiCriterionPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">listName</span> <span class="o">=</span> <span class="s2">&quot;Multi-criterion plot&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_writeCommand</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">listName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TMPFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MULTICPLOTTMPFILE</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TMPFILENAME</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">command</span><span class="p">)</span>
        <span class="c1"># execute file with phenix.python</span>
        <span class="n">Plugin</span><span class="o">.</span><span class="n">runPhenixProgram</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">TMPFILENAME</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_showOverallRSCResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictX</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.3</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Model Final Statistics&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Real-space correlation: Final Results Summary&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictX</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showCCTable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_computeCCTable</span><span class="p">()</span>

        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_rs_headers&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RSCCList</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Real-space correlation&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Correlation coefficients table&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showOccupancies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_occ_bf_headers&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupancyList</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Occupancies&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Occupancies&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showIsotropicB</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;statistic&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">]</span>
        <span class="n">dictX</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">dictX</span><span class="p">[</span><span class="s1">&#39;Minimun&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_min&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_min_macromolecules&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dictX</span><span class="p">[</span><span class="s1">&#39;Min (macromolecules)&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_min_macromolecules&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_min_ligands&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dictX</span><span class="p">[</span><span class="s1">&#39;Min (ligands)&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_min_ligands&#39;</span><span class="p">]</span>
        <span class="n">dictX</span><span class="p">[</span><span class="s1">&#39;Maximun&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_max&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_max_macromolecules&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dictX</span><span class="p">[</span><span class="s1">&#39;Max (macromolecules)&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_max_macromolecules&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_max_ligands&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dictX</span><span class="p">[</span><span class="s1">&#39;Max (ligands)&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_max_ligands&#39;</span><span class="p">]</span>
        <span class="n">dictX</span><span class="p">[</span><span class="s1">&#39;Mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_mean&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_mean_macromolecules&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dictX</span><span class="p">[</span><span class="s1">&#39;Mean (macromolecules)&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_mean_macromolecules&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_mean_ligands&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dictX</span><span class="p">[</span><span class="s1">&#39;Mean (ligands)&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_b_mean_ligands&#39;</span><span class="p">]</span>
        <span class="n">val</span> <span class="o">=</span> <span class="mf">0.2</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Isotropic B&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;B-factors/ADPs&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showResults</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dictX</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showSuspiciousBfactors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">headerList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_occ_bf_headers&#39;</span><span class="p">]</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">suspiciousBFList</span>
        <span class="n">mesg</span> <span class="o">=</span> <span class="s2">&quot;Suspicious B-factors&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;B-factors/ADPs&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_showOutliers</span><span class="p">(</span><span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showResults</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headerList</span><span class="p">,</span> <span class="n">dictX</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
        <span class="n">dataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">dictX</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;_&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">dataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;%&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;f&quot;</span><span class="p">)</span> <span class="o">%</span> <span class="n">v</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">dataList</span><span class="p">:</span>
            <span class="n">errorWindow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getTkRoot</span><span class="p">(),</span> <span class="s2">&quot;No data available&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">TableView</span><span class="p">(</span><span class="n">headerList</span><span class="o">=</span><span class="n">headerList</span><span class="p">,</span>
                  <span class="n">dataList</span><span class="o">=</span><span class="n">dataList</span><span class="p">,</span>
                  <span class="n">mesg</span><span class="o">=</span><span class="n">mesg</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                  <span class="n">height</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">dataList</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_showOutliers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headerList</span><span class="p">,</span> <span class="n">dataList</span><span class="p">,</span> <span class="n">mesg</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">dataList</span><span class="p">:</span>
            <span class="n">errorWindow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getTkRoot</span><span class="p">(),</span> <span class="s2">&quot;No data available&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">TableView</span><span class="p">(</span><span class="n">headerList</span><span class="o">=</span><span class="n">headerList</span><span class="p">,</span>
                  <span class="n">dataList</span><span class="o">=</span><span class="n">dataList</span><span class="p">,</span>
                  <span class="n">mesg</span><span class="o">=</span><span class="n">mesg</span><span class="p">,</span>
                  <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span>
                  <span class="n">height</span><span class="o">=</span><span class="nb">min</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dataList</span><span class="p">)),</span> <span class="n">width</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_displayFSCplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">xList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_x_fsc&#39;</span><span class="p">]</span>
        <span class="n">yList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_y_fsc&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">xList</span> <span class="ow">or</span> <span class="n">yList</span><span class="p">):</span>
            <span class="n">errorWindow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getTkRoot</span><span class="p">(),</span> <span class="s2">&quot;No data available&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Fourier Shell Correlation (Map vs. Model)&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xList</span><span class="p">,</span> <span class="n">yList</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;1/resolution (1/Angstrom)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;FSC&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_parseFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dictSummary</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dictBLRestraints</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blDataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dictBARestraints</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">baDataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dictDARestraints</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daDataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dictChilRestraints</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chilDataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dictPlanarRestraints</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">planarDataList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="k">while</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Ramachandran&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;outliers&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictSummary</span><span class="p">[</span><span class="s1">&#39;Ramachandran outliers (%)&#39;</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;favored&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;=&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictSummary</span><span class="p">[</span><span class="s1">&#39;Ramachandran favored (%)&#39;</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Rotamer&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;outliers&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictSummary</span><span class="p">[</span><span class="s1">&#39;Rotamer outliers (%)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;C-beta&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;deviations&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictSummary</span><span class="p">[</span><span class="s1">&#39;C-beta outliers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Clashscore&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;=&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictSummary</span><span class="p">[</span><span class="s1">&#39;Clashscore&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RMS(bonds)&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;=&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictSummary</span><span class="p">[</span><span class="s1">&#39;RMS (bonds)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RMS(angles)&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;=&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictSummary</span><span class="p">[</span><span class="s1">&#39;RMS (angles)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MolProbity&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;score&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictSummary</span><span class="p">[</span><span class="s1">&#39;Overall score&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;bond&#39;</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span><span class="s1">&#39;Bond&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictBLRestraints</span><span class="p">[</span><span class="s1">&#39;Number of restraints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictBLRestraints</span><span class="p">[</span><span class="s1">&#39;RMS (deviation)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictBLRestraints</span><span class="p">[</span><span class="s1">&#39;Max deviation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;----------Bond&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span>
                        <span class="s1">&#39;lengths----------&#39;</span><span class="p">):</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;restrained&#39;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">dictBLRestraints</span><span class="p">[</span><span class="s1">&#39;Number of outliers &#39;</span> \
                                                  <span class="s1">&#39;&gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Using&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;conformation-dependent&#39;</span><span class="p">):</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;restrained&#39;</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">dictBLRestraints</span><span class="p">[</span><span class="s1">&#39;Number of outliers &#39;</span> \
                                                      <span class="s1">&#39;&gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atoms&#39;</span><span class="p">):</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_parseFileAtom1Atom2</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">dictBLRestraints</span><span class="p">[</span><span class="s1">&#39;Number of outliers &#39;</span>\
                                                  <span class="s1">&#39;&gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">blDataList</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Atom2</span><span class="p">,</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span><span class="p">,</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span><span class="p">,</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="p">))</span>

                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;angle&#39;</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Angle&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictBARestraints</span><span class="p">[</span><span class="s1">&#39;Number of restraints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictBARestraints</span><span class="p">[</span><span class="s1">&#39;RMS (deviation)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictBARestraints</span><span class="p">[</span><span class="s1">&#39;Max deviation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;----------Bond&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span>
                        <span class="s1">&#39;angles----------&#39;</span><span class="p">):</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;restrained&#39;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">dictBARestraints</span><span class="p">[</span>
                                <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Using&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;conformation-dependent&#39;</span><span class="p">):</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;restrained&#39;</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">dictBARestraints</span><span class="p">[</span>
                                    <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atoms&#39;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_wrapParseFileAtom123</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;dihedral&#39;</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Dihedral&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictDARestraints</span><span class="p">[</span><span class="s1">&#39;Number of restraints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictDARestraints</span><span class="p">[</span><span class="s1">&#39;RMS (deviation)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictDARestraints</span><span class="p">[</span><span class="s1">&#39;Max deviation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;----------Dihedral&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span>
                        <span class="s1">&#39;angles----------&#39;</span><span class="p">):</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;restrained&#39;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">dictDARestraints</span><span class="p">[</span>
                                <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Using&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;conformation-dependent&#39;</span><span class="p">):</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;restrained&#39;</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">dictDARestraints</span><span class="p">[</span>
                                    <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atoms&#39;</span><span class="p">):</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_parseFileAtom1234</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">dictDARestraints</span><span class="p">[</span>
                                <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="p">)</span>

                            <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">mv</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="p">,</span>
                                                                  <span class="bp">self</span><span class="o">.</span><span class="n">Atom2</span><span class="p">,</span>
                                                                  <span class="bp">self</span><span class="o">.</span><span class="n">Atom3</span><span class="p">,</span>
                                                                  <span class="bp">self</span><span class="o">.</span><span class="n">Atom4</span><span class="p">,</span>
                                                                  <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span><span class="p">,</span>
                                                                  <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span><span class="p">,</span>
                                                                  <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="p">):</span>
                                <span class="n">element</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">a2</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">a3</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">a4</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">46</span><span class="p">:</span>
                                    <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">46</span><span class="p">:],</span>
                                                              <span class="s2">&quot;...&quot;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">daDataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">element</span><span class="p">,</span>
                                                       <span class="n">iv</span><span class="p">,</span> <span class="n">mv</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;chirality&#39;</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Chirality&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictChilRestraints</span><span class="p">[</span><span class="s1">&#39;Number of restraints&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictChilRestraints</span><span class="p">[</span><span class="s1">&#39;RMS (deviation)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictChilRestraints</span><span class="p">[</span><span class="s1">&#39;Max deviation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;----------Chiral&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span>
                        <span class="s1">&#39;volumes----------&#39;</span><span class="p">):</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;restrained&#39;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">dictChilRestraints</span><span class="p">[</span>
                                <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Using&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;conformation-dependent&#39;</span><span class="p">):</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;restrained&#39;</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">dictChilRestraints</span><span class="p">[</span>
                                    <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atoms&#39;</span><span class="p">):</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_parseFileAtom1234</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">dictChilRestraints</span><span class="p">[</span>
                                <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="p">)</span>

                            <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">a4</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">mv</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">Atom2</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">Atom3</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">Atom4</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span><span class="p">,</span>
                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="p">):</span>
                                <span class="n">element</span> <span class="o">=</span> <span class="n">a1</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">a2</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">a3</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">a4</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">46</span><span class="p">:</span>
                                    <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">46</span><span class="p">:],</span>
                                                              <span class="s2">&quot;...&quot;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">chilDataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">element</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">mv</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;planarity&#39;</span> <span class="ow">or</span> <span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Planarity&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;:&#39;</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictPlanarRestraints</span><span class="p">[</span><span class="s1">&#39;Number of restraints&#39;</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="nb">int</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictPlanarRestraints</span><span class="p">[</span><span class="s1">&#39;RMS (deviation)&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">dictPlanarRestraints</span><span class="p">[</span><span class="s1">&#39;Max deviation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span>
                            <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;----------Planar&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span>
                        <span class="s1">&#39;groups----------&#39;</span><span class="p">):</span>
                        <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                        <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="k">if</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;restrained&#39;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">dictPlanarRestraints</span><span class="p">[</span>
                                <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Using&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;conformation-dependent&#39;</span><span class="p">):</span>
                            <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                            <span class="k">if</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span> <span class="ow">and</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;restrained&#39;</span><span class="p">):</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">dictPlanarRestraints</span><span class="p">[</span>
                                    <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                        <span class="k">elif</span> <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;atoms&#39;</span><span class="p">):</span>
                            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_parseFileGroups</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">dictPlanarRestraints</span><span class="p">[</span>
                                <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cnt</span><span class="p">)</span>

                            <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">md</span><span class="p">,</span> <span class="n">rd</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="p">,</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">MaxDelta</span><span class="p">,</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">RMSDelta</span><span class="p">,</span>
                                                    <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="p">):</span>
                                <span class="n">element</span> <span class="o">=</span> <span class="nb">str</span><span class="p">()</span>
                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                                    <span class="n">element</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
                                <span class="n">element</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
                                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">35</span><span class="p">:</span>
                                    <span class="n">element</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">element</span><span class="p">[</span><span class="mi">35</span><span class="p">:],</span>
                                                             <span class="s2">&quot;...&quot;</span><span class="p">)</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">planarDataList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                                    <span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">md</span><span class="p">,</span> <span class="n">rd</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_parseFileAtom1Atom2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Atom2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span>
                             <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span>
                             <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Atom2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span>
                             <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Atom2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span>
                             <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_wrapParseFileAtom123</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parseFileAtom123</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dictBARestraints</span><span class="p">[</span>
            <span class="s1">&#39;Number of outliers &gt; 4sigma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a3</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">mv</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">Atom2</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">Atom3</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">baDataList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">a1</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span> <span class="o">+</span> <span class="n">a2</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span>
                                                     <span class="s2">&quot;&quot;</span> <span class="o">+</span>
                                    <span class="n">a3</span><span class="p">,</span> <span class="n">iv</span><span class="p">,</span> <span class="n">mv</span><span class="p">,</span> <span class="n">d</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_parseFileAtom123</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Atom2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Atom3</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Atom123</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Atom2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Atom3</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">Atom123</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">):</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">):</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                    <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_parseFileAtom1234</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Atom2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Atom3</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Atom4</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Atom1234</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Atom1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Atom2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Atom3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Atom4</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">Atom1234</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">10</span><span class="p">):</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">):</span>
                    <span class="n">atom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                                <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">IdealValue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ModelValue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_parseFileGroups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cnt</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">groups</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Atoms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MaxDelta</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RMSDelta</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">Atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                             <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span>
                             <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">Atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                             <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span>
                             <span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">aminoacid</span> <span class="o">=</span> <span class="n">Atoms</span>
                <span class="n">Atoms</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aminoacid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MaxDelta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RMSDelta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">Atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                             <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">words</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cnt</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">Atoms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span>
                             <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">words</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">aminoacid</span> <span class="o">=</span> <span class="n">Atoms</span>
                <span class="n">Atoms</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aminoacid</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">MaxDelta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">RMSDelta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Deviation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">words</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">line</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_writePickleData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ANALYSISTMPFILENAME</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">protocol</span><span class="o">.</span><span class="n">_getExtraPath</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ANALYSISTMPFILE</span><span class="p">)</span>
        <span class="n">command</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;import pickle</span>
<span class="s2">import collections</span>
<span class="s2">import json</span>

<span class="s2">def pickleData(file):</span>
<span class="s2">    with open(file,&quot;r&quot;) as f:</span>
<span class="s2">        return pickle.load(f)</span>

<span class="s2"># process file </span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="s2">data = pickleData(&#39;</span><span class="si">%s</span><span class="s2">&#39;)</span>
<span class="s2">dictOverall = collections.OrderedDict()</span>

<span class="s2"># missing atoms</span>
<span class="s2">if data.missing_atoms is not None:</span>
<span class="s2">    dictOverall[&#39;_missing_atoms&#39;] = data.missing_atoms</span>
<span class="s2">    dictOverall[&#39;_len_missing_atoms&#39;] = len(data.missing_atoms)</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall[&#39;_len_missing_atoms&#39;] = 0</span>

<span class="s2"># Protein group</span>
<span class="s2">if data.ramalyze is None:</span>
<span class="s2">    dictOverall[&#39;_protein&#39;] = False</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall[&#39;_protein&#39;] = True</span>

<span class="s2">    # Ramachandran analysis</span>
<span class="s2">    dictOverall[&#39;_percent_rama_outliers&#39;] = data.ramalyze.percent_outliers</span>
<span class="s2">    dictOverall[&#39;_rama_outliers&#39;] = data.ramalyze.as_gui_table_data()</span>
<span class="s2">    dictOverall[&#39;_rama_headers&#39;] = data.ramalyze.gui_list_headers</span>

<span class="s2">    # Rotamer analysis</span>
<span class="s2">    dictOverall[&#39;_percent_rota_outliers&#39;] = data.rotalyze.percent_outliers</span>
<span class="s2">    dictOverall[&#39;_rota_outliers&#39;] = data.rotalyze.as_gui_table_data()</span>
<span class="s2">    dictOverall[&#39;_rota_headers&#39;] = data.rotalyze.gui_list_headers</span>

<span class="s2">    # C-beta outliers</span>
<span class="s2">    dictOverall[&#39;_n_cbeta_outliers&#39;] = data.cbetadev.n_outliers</span>
<span class="s2">    dictOverall[&#39;_cbeta_outliers&#39;] = data.cbetadev.as_gui_table_data()</span>
<span class="s2">    dictOverall[&#39;_cbeta_headers&#39;] = data.cbetadev.gui_list_headers</span>

<span class="s2">    # Backwards Asn/Gln/His sidechains</span>
<span class="s2">    dictOverall[&#39;_n_nqh_flips_outliers&#39;] = data.nqh_flips.n_outliers</span>
<span class="s2">    dictOverall[&#39;_nqh_flips_outliers&#39;] = data.nqh_flips.as_gui_table_data()</span>
<span class="s2">    dictOverall[&#39;_nqh_flips_headers&#39;] = data.nqh_flips.gui_list_headers</span>

<span class="s2">    # Cis and Twisted peptides</span>
<span class="s2">    dictOverall[&#39;_n_omega_outliers&#39;] = data.omegalyze.n_outliers</span>
<span class="s2">    dictOverall[&#39;_omega_outliers&#39;] = data.omegalyze.as_gui_table_data()</span>
<span class="s2">    dictOverall[&#39;_omega_headers&#39;] = data.omegalyze.gui_list_headers</span>

<span class="s2"># RNA group</span>
<span class="s2">if data.rna is None:</span>
<span class="s2">    dictOverall[&#39;_rna_group&#39;] = False</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall[&#39;_rna_group&#39;] = True</span>
<span class="s2">    dictOverall[&#39;_n_bonds_rna_outliers&#39;] = data.rna.bonds.n_outliers</span>
<span class="s2">    dictOverall[&#39;_n_angles_rna_outliers&#39;] = data.rna.angles.n_outliers</span>
<span class="s2">    dictOverall[&#39;_n_puckers_rna_outliers&#39;] = data.puckers.angles.n_outliers</span>
<span class="s2">    dictOverall[&#39;_n_suites_rna_outliers&#39;] = data.suites.angles.n_outliers</span>

<span class="s2"># Clashes</span>
<span class="s2">if data.clashes is None:</span>
<span class="s2">    dictOverall[&#39;_clashes&#39;] = False</span>
<span class="s2">else:</span>
<span class="s2">    dictOverall[&#39;_clashes&#39;] = True</span>
<span class="s2">    dictOverall[&#39;_n_clashes_outliers&#39;] = data.clashes.n_outliers</span>
<span class="s2">    dictOverall[&#39;_clashes_outliers&#39;] = data.clashes.as_gui_table_data()</span>
<span class="s2">    dictOverall[&#39;_clashes_headers&#39;] = data.clashes.gui_list_headers</span>

<span class="s2"># correlation coefficients</span>
<span class="s2">if data.real_space is None:</span>
<span class="s2">    dictOverall[&#39;_overall_rsc&#39;] = False</span>
<span class="s2">    dictOverall[&#39;_fsc&#39;] = False</span>
<span class="s2">else:</span>
<span class="s2">    if data.real_space.overall_rsc is None:</span>
<span class="s2">        dictOverall[&#39;_overall_rsc&#39;] = False</span>
<span class="s2">    else:</span>
<span class="s2">        dictOverall[&#39;_overall_rsc&#39;] = True</span>
<span class="s2">        dictOverall[&#39;Mask CC&#39;] = data.real_space.overall_rsc[0]</span>
<span class="s2">        dictOverall[&#39;Volume CC&#39;] = data.real_space.overall_rsc[1]</span>
<span class="s2">        dictOverall[&#39;Peak CC&#39;] = data.real_space.overall_rsc[2]</span>

<span class="s2">        # real_space_correlation_coefficients table</span>
<span class="s2">        dictOverall[&#39;_rs_protein&#39;] = []</span>
<span class="s2">        for i in range(len(data.real_space.protein)):</span>
<span class="s2">            dictOverall[&#39;_rs_protein&#39;].append(data.real_space.protein[</span>
<span class="s2">            i].as_table_row_phenix())</span>
<span class="s2">        dictOverall[&#39;_rs_other&#39;] = [] </span>
<span class="s2">        for i in range(len(data.real_space.other)):</span>
<span class="s2">            dictOverall[&#39;_rs_other&#39;].append(data.real_space.other[</span>
<span class="s2">            i].as_table_row_phenix())</span>
<span class="s2">        dictOverall[&#39;_rs_water&#39;] = []</span>
<span class="s2">        for i in range(len(data.real_space.water)):</span>
<span class="s2">            dictOverall[&#39;_rs_water&#39;].append(data.real_space.water[</span>
<span class="s2">            i].as_table_row_phenix())</span>
<span class="s2">        dictOverall[&#39;_rs_everything&#39;] = []</span>
<span class="s2">        for i in range(len(data.real_space.everything)):</span>
<span class="s2">            dictOverall[&#39;_rs_everything&#39;].append(data.real_space.everything[</span>
<span class="s2">            i].as_table_row_phenix())</span>
<span class="s2">        dictOverall[&#39;_rs_headers&#39;] = data.real_space.gui_list_headers</span>

<span class="s2">    # fsc</span>
<span class="s2">    if data.real_space.fsc is None:</span>
<span class="s2">        dictOverall[&#39;_fsc&#39;] = False</span>
<span class="s2">    else:</span>
<span class="s2">        dictOverall[&#39;_fsc&#39;] = True</span>

<span class="s2">        # atom mask radius</span>
<span class="s2">        dictOverall[&#39;_atom_radius&#39;] = data.real_space.fsc.atom_radius</span>

<span class="s2">        # fsc graph data</span>
<span class="s2">        x_elements = []</span>
<span class="s2">        y_elements = []</span>
<span class="s2">        for x in data.real_space.fsc.d_inv:</span>
<span class="s2">            x_elements.append(x)</span>
<span class="s2">        for y in data.real_space.fsc.fsc:</span>
<span class="s2">            y_elements.append(y)</span>
<span class="s2">        dictOverall[&#39;_x_fsc&#39;] = x_elements</span>
<span class="s2">        dictOverall[&#39;_y_fsc&#39;] = y_elements</span>

<span class="s2"># occupancy and suspicious B-factors table</span>
<span class="s2">dictOverall[&#39;_occ_bf_outliers&#39;] = data.model_stats.all.as_gui_table_data()</span>
<span class="s2">dictOverall[&#39;_occ_bf_headers&#39;] = data.model_stats.all.gui_list_headers</span>

<span class="s2"># isotropic B (B-factors/ADPs)</span>
<span class="s2">dictOverall[&#39;_n_aniso_h&#39;] = data.model_stats.all.n_aniso_h</span>
<span class="s2">dictOverall[&#39;_n_zero_b&#39;] = data.model_stats.all.n_zero_b</span>
<span class="s2">dictOverall[&#39;_b_min&#39;] = data.model_stats.all.b_min</span>
<span class="s2">dictOverall[&#39;_b_max&#39;] = data.model_stats.all.b_max</span>
<span class="s2">dictOverall[&#39;_b_mean&#39;] = data.model_stats.all.b_mean</span>
<span class="s2">if data.model_stats.macromolecules is not None:</span>
<span class="s2">    dictOverall[&#39;_b_min_macromolecules&#39;] = data.model_stats.macromolecules.b_min</span>
<span class="s2">    dictOverall[&#39;_b_max_macromolecules&#39;] = data.model_stats.macromolecules.b_max</span>
<span class="s2">    dictOverall[&#39;_b_mean_macromolecules&#39;] = data.model_stats.macromolecules.b_mean</span>
<span class="s2">if data.model_stats.ligands is not None:</span>
<span class="s2">    dictOverall[&#39;_b_min_ligands&#39;] = data.model_stats.ligands.b_min</span>
<span class="s2">    dictOverall[&#39;_b_max_ligands&#39;] = data.model_stats.ligands.b_max</span>
<span class="s2">    dictOverall[&#39;_b_mean_ligands&#39;] = data.model_stats.ligands.b_mean</span>
<span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MOLPROBITYPKLFILENAME</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MOLPROBITYPKLFILENAME</span><span class="p">)</span>

        <span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;with open(&#39;</span><span class="si">%s</span><span class="s2">&#39;,&quot;w&quot;) as f:</span>
<span class="s2">    f.write(json.dumps(dictOverall))</span>
<span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ANALYSISTMPFILENAME</span><span class="p">)</span>

        <span class="n">pythonFileName</span> <span class="o">=</span> <span class="n">ANALYSISTMPFILENAME</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;.py&#39;</span><span class="p">)</span>
        <span class="c1"># write script file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">pythonFileName</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">command</span><span class="p">)</span>

        <span class="c1"># execute file with phenix.python</span>
        <span class="n">Plugin</span><span class="o">.</span><span class="n">runPhenixProgram</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">pythonFileName</span><span class="p">)</span>

        <span class="c1"># read file in scipion python</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">ANALYSISTMPFILENAME</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="c1"># self.dataDict = json.loads(f.read())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_store</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_writeCommand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listName</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span><span class="s2">&quot;&quot;&quot;import pickle</span>
<span class="s2">        </span>
<span class="s2">def pickleData(file):</span>
<span class="s2">    with open(file,&quot;r&quot;) as f:</span>
<span class="s2">        return pickle.load(f)</span>

<span class="s2"># process file </span><span class="si">%s</span><span class="s2">&quot;</span>
<span class="s2">data = pickleData(&#39;</span><span class="si">%s</span><span class="s2">&#39;)</span>
<span class="s2">&quot;&quot;&quot;</span><span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MOLPROBITYPKLFILENAME</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MOLPROBITYPKLFILENAME</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">listName</span> <span class="o">==</span> <span class="s2">&quot;Multi-criterion plot&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;#RSC section</span>
<span class="s2">if data.real_space.overall_rsc is not None:</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;# Protein group</span>
<span class="s2">if data.ramalyze is not None:</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    try :</span>
<span class="s2">        import wxtbx.app</span>
<span class="s2">    except ImportError, e :</span>
<span class="s2">        raise Sorry(&quot;wxPython not available.&quot;)</span>
<span class="s2">    else :</span>
<span class="s2">        app = wxtbx.app.CCTBXApp(0)</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="c1"># TODO:</span>
        <span class="c1"># Get appropriate functioning of data._multi_criterion.display_wx_plots()</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">listName</span> <span class="o">==</span> <span class="s2">&quot;Multi-criterion plot&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        # data._multi_criterion.display_wx_plots() </span>
<span class="s2">        data.display_wx_plots()</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">listName</span> <span class="o">==</span> <span class="s2">&quot;Ramachandran plot&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        data.ramalyze.display_wx_plots()</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">listName</span> <span class="o">==</span> <span class="s2">&quot;Chi1-Chi2 plot&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        data.rotalyze.display_wx_plots()</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">+=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        app.MainLoop()</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_computeOccBFactor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listL</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">suspiciousBFList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occupancyList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">listL</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listL</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">listL</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">suspiciousBFList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">listL</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">occupancyList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">listL</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">_computeCCTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">decimal_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccIndex</span><span class="p">)</span>
        <span class="n">residueType_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residueType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RSCCList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">listL</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">listName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residueTypeList</span><span class="p">[</span><span class="n">residueType_index</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">listName</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">residueTypeList</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="n">listL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_rs_protein&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">listName</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">residueTypeList</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">listL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_rs_other&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">listName</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">residueTypeList</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="n">listL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_rs_water&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">listName</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">residueTypeList</span><span class="p">[</span><span class="mi">3</span><span class="p">]:</span>
            <span class="n">listL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dictOverall</span><span class="p">[</span><span class="s1">&#39;_rs_everything&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">listL</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">listL</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">listL</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ccBelowList</span><span class="p">[</span><span class="n">decimal_index</span><span class="p">]):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">RSCCList</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">str</span><span class="p">(</span><span class="n">listL</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                                          <span class="nb">str</span><span class="p">(</span><span class="n">listL</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span>
                                          <span class="nb">str</span><span class="p">(</span><span class="n">listL</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]),</span>
                                          <span class="nb">str</span><span class="p">(</span><span class="n">listL</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">3</span><span class="p">]),</span>
                                          <span class="nb">str</span><span class="p">(</span><span class="n">listL</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">4</span><span class="p">]),</span>
                                          <span class="nb">str</span><span class="p">(</span><span class="n">listL</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">5</span><span class="p">])))</span></div>




</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: rsanchezgarc-patch-1
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../../gh-pages/index.html">gh-pages</a></dd>
            <dd><a href="../../../../release-2.0.0/index.html">release-2.0.0</a></dd>
            <dd><a href="../../../../release-3.0.0/index.html">release-3.0.0</a></dd>
            <dd><a href="viewer_refinement_base.html">rsanchezgarc-patch-1</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>