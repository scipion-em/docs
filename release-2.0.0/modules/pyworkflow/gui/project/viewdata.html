

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pyworkflow.gui.project.viewdata &mdash; Scipion 2.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../static/jquery.js"></script>
        <script type="text/javascript" src="../../../../static/underscore.js"></script>
        <script type="text/javascript" src="../../../../static/doctools.js"></script>
        <script type="text/javascript" src="../../../../static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../../static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../../../static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/scipion-modes/install-from-sources.html">Installing Scipion v2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/scipion-modes/host-configuration.html">Host configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/user/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/user/user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/user/user-documentation.html#tutorials">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/user/user-documentation.html#processing-how-to-s">Processing How Toâ€™s</a></li>
</ul>
<p class="caption"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/facilities/facilities.html">Streaming Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/facilities/acquisition-simulation.html">Tutorial for Facilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../api/pyworkflow.html">pyworkflow package</a></li>
</ul>
<p class="caption"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../docs/misc/contact-us.html">Contact Us</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>pyworkflow.gui.project.viewdata</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyworkflow.gui.project.viewdata</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># **************************************************************************</span>
<span class="c1"># *</span>
<span class="c1"># * Authors:     J.M. De la Rosa Trevin (delarosatrevin@scilifelab.se) [1]</span>
<span class="c1"># *</span>
<span class="c1"># * [1] SciLifeLab, Stockholm University</span>
<span class="c1"># *</span>
<span class="c1"># * This program is free software: you can redistribute it and/or modify</span>
<span class="c1"># * it under the terms of the GNU General Public License as published by</span>
<span class="c1"># * the Free Software Foundation, either version 3 of the License, or</span>
<span class="c1"># * (at your option) any later version.</span>
<span class="c1"># *</span>
<span class="c1"># * This program is distributed in the hope that it will be useful,</span>
<span class="c1"># * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># * GNU General Public License for more details.</span>
<span class="c1"># *</span>
<span class="c1"># * You should have received a copy of the GNU General Public License</span>
<span class="c1"># * along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>
<span class="c1"># *</span>
<span class="c1"># *  All comments concerning this program package may be sent to the</span>
<span class="c1"># *  e-mail address &#39;scipion@cnb.csic.es&#39;</span>
<span class="c1"># *</span>
<span class="c1"># **************************************************************************</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Data-oriented view of the project objects.</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">import</span> <span class="nn">tkinter.ttk</span> <span class="k">as</span> <span class="nn">ttk</span>
<span class="kn">import</span> <span class="nn">tkinter.font</span> <span class="k">as</span> <span class="nn">tkFont</span>

<span class="kn">import</span> <span class="nn">pyworkflow.utils</span> <span class="k">as</span> <span class="nn">pwutils</span>
<span class="kn">import</span> <span class="nn">pyworkflow.protocol</span> <span class="k">as</span> <span class="nn">pwprot</span>
<span class="kn">import</span> <span class="nn">pyworkflow.viewer</span> <span class="k">as</span> <span class="nn">pwviewer</span>

<span class="kn">import</span> <span class="nn">pyworkflow.gui</span> <span class="k">as</span> <span class="nn">gui</span>
<span class="kn">from</span> <span class="nn">pyworkflow.gui.tree</span> <span class="k">import</span> <span class="n">Tree</span>
<span class="kn">from</span> <span class="nn">pyworkflow.gui.dialog</span> <span class="k">import</span> <span class="n">EditObjectDialog</span>
<span class="kn">from</span> <span class="nn">pyworkflow.gui.text</span> <span class="k">import</span> <span class="n">TaggedText</span>
<span class="kn">from</span> <span class="nn">pyworkflow.gui</span> <span class="k">import</span> <span class="n">Canvas</span><span class="p">,</span> <span class="n">RoundedTextBox</span>
<span class="kn">from</span> <span class="nn">pyworkflow.gui.graph</span> <span class="k">import</span> <span class="n">LevelTree</span>
<span class="kn">from</span> <span class="nn">pyworkflow.gui.form</span> <span class="k">import</span> <span class="n">getObjectLabel</span>
<span class="kn">from</span> <span class="nn">pyworkflow.constants</span> <span class="k">import</span> <span class="n">DATA_TAG</span>

<span class="n">ACTION_EDIT</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_EDIT</span>
<span class="n">ACTION_COPY</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_COPY</span>
<span class="n">ACTION_DELETE</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_DELETE</span>
<span class="n">ACTION_REFRESH</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_REFRESH</span>
<span class="n">ACTION_STEPS</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_BROWSE</span>
<span class="n">ACTION_TREE</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_TREE</span>
<span class="n">ACTION_LIST</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_LIST</span>
<span class="n">ACTION_STOP</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_STOP</span>
<span class="n">ACTION_DEFAULT</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_DEFAULT</span>
<span class="n">ACTION_CONTINUE</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_CONTINUE</span>
<span class="n">ACTION_RESULTS</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_ANALYZE</span>

<span class="n">RUNS_TREE</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">RUNS_TREE</span>
<span class="n">RUNS_LIST</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">RUNS_LIST</span>
 
<span class="n">ActionIcons</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">ACTION_EDIT</span><span class="p">:</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">ACTION_EDIT</span><span class="p">,</span>
    <span class="n">ACTION_COPY</span><span class="p">:</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">ACTION_COPY</span><span class="p">,</span>
    <span class="n">ACTION_DELETE</span><span class="p">:</span>  <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">ACTION_DELETE</span><span class="p">,</span>
    <span class="n">ACTION_REFRESH</span><span class="p">:</span>  <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">ACTION_REFRESH</span><span class="p">,</span>
    <span class="n">ACTION_STEPS</span><span class="p">:</span>  <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">ACTION_STEPS</span><span class="p">,</span>
    <span class="n">ACTION_TREE</span><span class="p">:</span>  <span class="kc">None</span><span class="p">,</span>  <span class="c1"># should be set</span>
    <span class="n">ACTION_LIST</span><span class="p">:</span>  <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">ACTION_LIST</span><span class="p">,</span>
    <span class="n">ACTION_STOP</span><span class="p">:</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">ACTION_STOP</span><span class="p">,</span>
    <span class="n">ACTION_CONTINUE</span><span class="p">:</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">ACTION_CONTINUE</span><span class="p">,</span>
    <span class="n">ACTION_RESULTS</span><span class="p">:</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">ACTION_RESULTS</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">STATUS_COLORS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">pwprot</span><span class="o">.</span><span class="n">STATUS_SAVED</span><span class="p">:</span> <span class="s1">&#39;#D9F1FA&#39;</span><span class="p">,</span>
    <span class="n">pwprot</span><span class="o">.</span><span class="n">STATUS_LAUNCHED</span><span class="p">:</span> <span class="s1">&#39;#D9F1FA&#39;</span><span class="p">,</span>
    <span class="n">pwprot</span><span class="o">.</span><span class="n">STATUS_RUNNING</span><span class="p">:</span> <span class="s1">&#39;#FCCE62&#39;</span><span class="p">,</span>
    <span class="n">pwprot</span><span class="o">.</span><span class="n">STATUS_FINISHED</span><span class="p">:</span> <span class="s1">&#39;#D2F5CB&#39;</span><span class="p">,</span>
    <span class="n">pwprot</span><span class="o">.</span><span class="n">STATUS_FAILED</span><span class="p">:</span> <span class="s1">&#39;#F5CCCB&#39;</span><span class="p">,</span>
    <span class="n">pwprot</span><span class="o">.</span><span class="n">STATUS_INTERACTIVE</span><span class="p">:</span> <span class="s1">&#39;#F3F5CB&#39;</span><span class="p">,</span>
    <span class="n">pwprot</span><span class="o">.</span><span class="n">STATUS_ABORTED</span><span class="p">:</span> <span class="s1">&#39;#F5CCCB&#39;</span><span class="p">,</span>
    <span class="c1"># pwprot.STATUS_SAVED: &#39;#124EB0&#39;,</span>
<span class="p">}</span>


<div class="viewcode-block" id="populateTree"><a class="viewcode-back" href="../../../../api/pyworkflow.gui.project.viewdata.html#pyworkflow.gui.project.viewdata.populateTree">[docs]</a><span class="k">def</span> <span class="nf">populateTree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">elements</span><span class="p">,</span> <span class="n">parentId</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="s1">&#39;count&#39;</span><span class="p">):</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">getName</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
                <span class="n">t</span> <span class="o">+=</span> <span class="s1">&#39; (</span><span class="si">%d</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">node</span><span class="o">.</span><span class="n">count</span>
            <span class="n">node</span><span class="o">.</span><span class="n">nodeId</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">parentId</span><span class="p">,</span> <span class="s1">&#39;end&#39;</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">getName</span><span class="p">(),</span>
                                      <span class="n">text</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">DATA_TAG</span><span class="p">)</span>
            <span class="n">populateTree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">node</span><span class="o">.</span><span class="n">getChilds</span><span class="p">(),</span> <span class="n">node</span><span class="o">.</span><span class="n">nodeId</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
                <span class="n">tree</span><span class="o">.</span><span class="n">see</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">nodeId</span><span class="p">)</span>
                <span class="n">tree</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">nodeId</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;non-empty&#39;</span><span class="p">,</span> <span class="n">DATA_TAG</span><span class="p">))</span></div>

    
<div class="viewcode-block" id="ProjectDataView"><a class="viewcode-back" href="../../../../api/pyworkflow.gui.project.viewdata.html#pyworkflow.gui.project.viewdata.ProjectDataView">[docs]</a><span class="k">class</span> <span class="nc">ProjectDataView</span><span class="p">(</span><span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">windows</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">):</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
        <span class="c1"># Load global configuration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">windows</span> <span class="o">=</span> <span class="n">windows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">windows</span><span class="o">.</span><span class="n">project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">windows</span><span class="o">.</span><span class="n">root</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getImage</span> <span class="o">=</span> <span class="n">windows</span><span class="o">.</span><span class="n">getImage</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">protCfg</span> <span class="o">=</span> <span class="n">windows</span><span class="o">.</span><span class="n">protCfg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">windows</span><span class="o">.</span><span class="n">getSettings</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">showGraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">getRunsView</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Style</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;&lt;F5&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshData</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__autoRefresh</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__autoRefreshCounter</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># start by 3 secs</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_dataGraph</span> <span class="o">=</span> <span class="n">windows</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">getSourceGraph</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_createContent</span><span class="p">()</span>
        
        <span class="n">gui</span><span class="o">.</span><span class="n">configureWeigths</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;news&#39;</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">_createContent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create the Data View for the Project.</span>
<span class="sd">        It has two panes:</span>
<span class="sd">            Left: containing the Protocol classes tree</span>
<span class="sd">            Right: containing the Data list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">PanedWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
        
        <span class="c1"># Left pane, contains Data tree</span>
        <span class="n">leftFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="n">bgColor</span> <span class="o">=</span> <span class="s1">&#39;#eaebec&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_createDataTree</span><span class="p">(</span><span class="n">leftFrame</span><span class="p">,</span> <span class="n">bgColor</span><span class="p">)</span>
        <span class="n">gui</span><span class="o">.</span><span class="n">configureWeigths</span><span class="p">(</span><span class="n">leftFrame</span><span class="p">)</span>
        
        <span class="c1"># Right pane</span>
        <span class="n">rightFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="n">rightFrame</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">rightFrame</span><span class="o">.</span><span class="n">rowconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># rightFrame.rowconfigure(0, minsize=label.winfo_reqheight())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fillRightPane</span><span class="p">(</span><span class="n">rightFrame</span><span class="p">)</span>

        <span class="c1"># Add sub-windows to PanedWindows</span>
        <span class="n">p</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">leftFrame</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">rightFrame</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">paneconfig</span><span class="p">(</span><span class="n">leftFrame</span><span class="p">,</span> <span class="n">minsize</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">paneconfig</span><span class="p">(</span><span class="n">rightFrame</span><span class="p">,</span> <span class="n">minsize</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>        
        
        <span class="k">return</span> <span class="n">p</span>
    
    <span class="k">def</span> <span class="nf">_createDataTree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">bgColor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a tree on the left panel to store how </span>
<span class="sd">        many object are from each type and the hierarchy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">defaultFont</span> <span class="o">=</span> <span class="n">gui</span><span class="o">.</span><span class="n">getDefaultFont</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="s2">&quot;W.Treeview&quot;</span><span class="p">,</span>
                             <span class="n">background</span><span class="o">=</span><span class="n">pwutils</span><span class="o">.</span><span class="n">Color</span><span class="o">.</span><span class="n">LIGHT_GREY_COLOR</span><span class="p">,</span>
                             <span class="n">borderwidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                             <span class="n">rowheight</span><span class="o">=</span><span class="n">defaultFont</span><span class="o">.</span><span class="n">metrics</span><span class="p">()[</span><span class="s1">&#39;linespace&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span> <span class="o">=</span> <span class="n">Tree</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="s1">&#39;tree&#39;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;W.Treeview&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s1">&#39;#0&#39;</span><span class="p">,</span> <span class="n">minwidth</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">tag_configure</span><span class="p">(</span><span class="s1">&#39;protocol&#39;</span><span class="p">,</span>
                                    <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getImage</span><span class="p">(</span><span class="s1">&#39;python_file.gif&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">tag_configure</span><span class="p">(</span><span class="s1">&#39;protocol_base&#39;</span><span class="p">,</span>
                                    <span class="n">image</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getImage</span><span class="p">(</span><span class="s1">&#39;class_obj.gif&#39;</span><span class="p">))</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s1">&#39;helvetica&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">tag_configure</span><span class="p">(</span><span class="s1">&#39;non-empty&#39;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;news&#39;</span><span class="p">)</span>

        <span class="c1"># bind click events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">tag_bind</span><span class="p">(</span><span class="n">DATA_TAG</span><span class="p">,</span> <span class="s1">&#39;&lt;Double-1&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataItemClick</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">tag_bind</span><span class="p">(</span><span class="n">DATA_TAG</span><span class="p">,</span> <span class="s1">&#39;&lt;Return&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataItemClick</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">tag_bind</span><span class="p">(</span><span class="n">DATA_TAG</span><span class="p">,</span> <span class="s1">&#39;&lt;KP_Enter&gt;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataItemClick</span><span class="p">)</span>

        <span class="c1"># Program automatic refresh</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_automaticRefreshData</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">_updateDataTree</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">_updateDataTree</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            
        <span class="k">def</span> <span class="nf">createClassNode</span><span class="p">(</span><span class="n">classObj</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot; Add the object class to hierarchy and </span>
<span class="sd">            any needed subclass. &quot;&quot;&quot;</span>
            <span class="n">className</span> <span class="o">=</span> <span class="n">classObj</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="n">classNode</span> <span class="o">=</span> <span class="n">classesGraph</span><span class="o">.</span><span class="n">getNode</span><span class="p">(</span><span class="n">className</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">classNode</span><span class="p">:</span>
                <span class="n">classNode</span> <span class="o">=</span> <span class="n">classesGraph</span><span class="o">.</span><span class="n">createNode</span><span class="p">(</span><span class="n">className</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">className</span> <span class="o">!=</span> <span class="s1">&#39;EMObject&#39;</span> <span class="ow">and</span> <span class="n">classObj</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">:</span>
                    <span class="n">baseClass</span> <span class="o">=</span> <span class="n">classObj</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">classObj</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;EMObject&#39;</span><span class="p">:</span>
                            <span class="n">baseClass</span> <span class="o">=</span> <span class="n">b</span>
                            <span class="k">break</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">createClassNode</span><span class="p">(</span><span class="n">baseClass</span><span class="p">)</span>
                    <span class="n">parent</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">classNode</span><span class="p">)</span>
                <span class="n">classNode</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
                
            <span class="k">return</span> <span class="n">classNode</span>
            
        <span class="n">classesGraph</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataGraph</span><span class="o">.</span><span class="n">getNodes</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="p">:</span>
                <span class="n">classNode</span> <span class="o">=</span> <span class="n">createClassNode</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">getClass</span><span class="p">())</span>
                <span class="n">classNode</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="n">populateTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="p">,</span> <span class="n">classesGraph</span><span class="o">.</span><span class="n">getRootNodes</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_fillRightPane</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        # Create the right Pane that will be composed by:</span>
<span class="sd">        # a Action Buttons TOOLBAR in the top</span>
<span class="sd">        # and another vertical Pane with:</span>
<span class="sd">        # Runs History (at Top)</span>
<span class="sd">        # Sectected run info (at Bottom)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Create the Action Buttons TOOLBAR</span>
        <span class="n">toolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;news&#39;</span><span class="p">)</span>
        <span class="n">gui</span><span class="o">.</span><span class="n">configureWeigths</span><span class="p">(</span><span class="n">toolbar</span><span class="p">)</span>
        <span class="c1"># toolbar.columnconfigure(0, weight=1)</span>
        <span class="n">toolbar</span><span class="o">.</span><span class="n">columnconfigure</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">runsToolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">toolbar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">runsToolbar</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;sw&#39;</span><span class="p">)</span>
        <span class="c1"># On the left of the toolbar will be other</span>
        <span class="c1"># actions that can be applied to all runs (refresh, graph view...)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allToolbar</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">toolbar</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allToolbar</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;se&#39;</span><span class="p">)</span>
        <span class="c1"># self.createActionToolbar()</span>

        <span class="c1"># Create the Run History tree</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">PanedWindow</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="c1"># runsFrame = ttk.Labelframe(v, text=&#39; History &#39;, width=500, height=500)</span>
        <span class="n">runsFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_createDataGraph</span><span class="p">(</span><span class="n">runsFrame</span><span class="p">)</span>
        <span class="n">gui</span><span class="o">.</span><span class="n">configureWeigths</span><span class="p">(</span><span class="n">runsFrame</span><span class="p">)</span>
        
        <span class="c1"># Create the Selected Run Info</span>
        <span class="n">infoFrame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="n">gui</span><span class="o">.</span><span class="n">configureWeigths</span><span class="p">(</span><span class="n">infoFrame</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_infoText</span> <span class="o">=</span> <span class="n">TaggedText</span><span class="p">(</span><span class="n">infoFrame</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
                                    <span class="n">handlers</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sci-open&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_openProtocolFormFromId</span><span class="p">})</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_infoText</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;news&#39;</span><span class="p">)</span>
        
        <span class="n">v</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">runsFrame</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">v</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">infoFrame</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">v</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;news&#39;</span><span class="p">)</span>

    <span class="c1"># TODO(josemi): check that the call to RoundedTextBox is correct</span>
    <span class="c1"># It looks suspicious because RoundedTextBox() needs 5 arguments, not 3</span>
    <span class="k">def</span> <span class="nf">_createNode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Create Data node to be painted in the graph. &quot;&quot;&quot;</span>
        <span class="n">node</span><span class="o">.</span><span class="n">selected</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">node</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="n">RoundedTextBox</span><span class="p">(</span><span class="n">canvas</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">box</span>

    <span class="k">def</span> <span class="nf">_createDataItem</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">pointer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nodeText</span> <span class="o">=</span> <span class="s2">&quot;Project&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">getObjectLabel</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">mapper</span><span class="p">)</span>
            <span class="n">nodeText</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span><span class="p">[:</span><span class="mi">25</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;...&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">25</span> <span class="k">else</span> <span class="n">label</span>
                
        <span class="n">textColor</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span>
        <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;#ADD8E6&#39;</span>  <span class="c1"># Lightblue</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataCanvas</span><span class="o">.</span><span class="n">createTextbox</span><span class="p">(</span><span class="n">nodeText</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bgColor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                                              <span class="n">textColor</span><span class="o">=</span><span class="n">textColor</span><span class="p">)</span>

        <span class="c1"># Get the dataId</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="o">.</span><span class="n">isRoot</span><span class="p">():</span>
            <span class="n">dataId</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">getObjId</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">dataId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">dataSelection</span><span class="p">:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setSelected</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">item</span>
    
    <span class="k">def</span> <span class="nf">_createDataGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; This will be the upper part of the right panel.</span>
<span class="sd">        It will contain the Data Graph with their relations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataCanvas</span> <span class="o">=</span> <span class="n">Canvas</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataCanvas</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;nsew&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataCanvas</span><span class="o">.</span><span class="n">onClickCallback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onClick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataCanvas</span><span class="o">.</span><span class="n">onDoubleClickCallback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onDoubleClick</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataCanvas</span><span class="o">.</span><span class="n">onRightClickCallback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_onRightClick</span>
       
        <span class="bp">self</span><span class="o">.</span><span class="n">_updateDataGraph</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">_updateDataGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="n">lt</span> <span class="o">=</span> <span class="n">LevelTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataGraph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataCanvas</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">lt</span><span class="o">.</span><span class="n">setCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dataCanvas</span><span class="p">)</span>
        <span class="n">lt</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_createDataItem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataCanvas</span><span class="o">.</span><span class="n">updateScrollRegion</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_dataItemClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Get the tree widget that originated the event</span>
        <span class="c1"># from the left pane data tree</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">widget</span>
        <span class="n">dataClassName</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">getFirst</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">dataClassName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_loopData</span><span class="p">(</span><span class="k">lambda</span> <span class="n">item</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_selectItemByClass</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">dataClassName</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_selectObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pobj</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">pobj</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">objValue</span> <span class="o">=</span> <span class="n">pobj</span><span class="o">.</span><span class="n">getObjValue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_infoText</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_infoText</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;*Label:* &#39;</span> <span class="o">+</span> <span class="n">getObjectLabel</span><span class="p">(</span><span class="n">pobj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">mapper</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_infoText</span><span class="o">.</span><span class="n">addText</span><span class="p">(</span><span class="s1">&#39;*Info:* &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_infoText</span><span class="o">.</span><span class="n">addText</span><span class="p">(</span><span class="s1">&#39;*Created by:*&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_infoText</span><span class="o">.</span><span class="n">addText</span><span class="p">(</span><span class="s1">&#39; - </span><span class="si">%s</span><span class="s1"> (</span><span class="si">%s</span><span class="s1">)&#39;</span>
                               <span class="o">%</span> <span class="p">(</span><span class="n">objValue</span><span class="o">.</span><span class="n">getObjectTag</span><span class="p">(</span><span class="n">objValue</span><span class="p">),</span>
                                  <span class="n">obj</span><span class="o">.</span><span class="n">getObjCreation</span><span class="p">()))</span>

        <span class="c1"># Get the consumers (this will get the data!!)</span>
        <span class="n">derivedData</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">getSourceChilds</span><span class="p">(</span><span class="n">objValue</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">derivedData</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">derivedData</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_infoText</span><span class="o">.</span><span class="n">addText</span><span class="p">(</span><span class="s1">&#39;*Consumed by:*&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">derivedData</span><span class="p">:</span>
                <span class="c1"># Get the protocol</span>
                <span class="n">protocol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">getObjParentId</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_infoText</span><span class="o">.</span><span class="n">addText</span><span class="p">(</span><span class="s1">&#39; - &#39;</span> <span class="o">+</span> <span class="n">protocol</span><span class="o">.</span><span class="n">getObjectTag</span><span class="p">(</span><span class="n">protocol</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">getObjComment</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_infoText</span><span class="o">.</span><span class="n">addText</span><span class="p">(</span><span class="s1">&#39;*Comments:* &#39;</span> <span class="o">+</span> <span class="n">obj</span><span class="o">.</span><span class="n">getObjComment</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_infoText</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">_onClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_deselectAll</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggleItemSelection</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_selectObject</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_invertSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_loopData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_invertAction</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_deselectAll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_loopData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_deselectItemAction</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_selectAll</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_loopData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_selectItemAction</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_selectItemAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggleItemSelection</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_selectItemByClass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">className</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">item</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">isRoot</span><span class="p">():</span>

            <span class="n">data</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toggleItemSelection</span><span class="p">(</span>
                <span class="n">item</span><span class="p">,</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">getObjects</span><span class="p">()[</span><span class="n">className</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">_invertAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggleItemSelection</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="ow">not</span> <span class="n">item</span><span class="o">.</span><span class="n">getSelected</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">_deselectItemAction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toggleItemSelection</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="ProjectDataView.toggleItemSelection"><a class="viewcode-back" href="../../../../api/pyworkflow.gui.project.viewdata.html#pyworkflow.gui.project.viewdata.ProjectDataView.toggleItemSelection">[docs]</a>    <span class="k">def</span> <span class="nf">toggleItemSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">,</span> <span class="n">select</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">isRoot</span><span class="p">():</span>
            <span class="k">return</span>
        <span class="n">selection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">dataSelection</span>
        <span class="n">runSelection</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">runSelection</span>
        <span class="n">dataId</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">getObjId</span><span class="p">()</span>
        <span class="n">protocolId</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="o">.</span><span class="n">getObjValue</span><span class="p">()</span><span class="o">.</span><span class="n">getObjId</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">select</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">dataId</span> <span class="ow">in</span> <span class="n">selection</span><span class="p">:</span>
                    <span class="n">selection</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">dataId</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">protocolId</span> <span class="ow">in</span> <span class="n">runSelection</span><span class="p">:</span>
                    <span class="n">runSelection</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">protocolId</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;id not in selection&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">selection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataId</span><span class="p">)</span>
            <span class="n">runSelection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">protocolId</span><span class="p">)</span>

        <span class="n">item</span><span class="o">.</span><span class="n">setSelected</span><span class="p">(</span><span class="n">select</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_loopData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop through all the items</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dataCanvas</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">action</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">results</span>

    <span class="k">def</span> <span class="nf">_onDoubleClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_selectObject</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_viewObject</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">node</span><span class="o">.</span><span class="n">pointer</span><span class="o">.</span><span class="n">get</span><span class="p">()</span><span class="o">.</span><span class="n">getObjId</span><span class="p">())</span>
            <span class="k">return</span>
            <span class="c1"># self._selectObject(e.node.pointer)</span>
            <span class="c1"># # Graph the first viewer available for this type of object</span>
            <span class="c1"># ViewerClass = findViewers(self._selected.getClassName(), DESKTOP_TKINTER)[0] #</span>
            <span class="c1"># viewer = ViewerClass(project=self.project)</span>
            <span class="c1"># viewer.visualize(self._selected)</span>

    <span class="k">def</span> <span class="nf">_viewObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objId</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Call appropriate viewer for objId. &quot;&quot;&quot;</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">objId</span><span class="p">))</span>
        <span class="n">viewerClasses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">domain</span><span class="o">.</span><span class="n">findViewers</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">getClassName</span><span class="p">(),</span>
                                                <span class="n">pwviewer</span><span class="o">.</span><span class="n">DESKTOP_TKINTER</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">viewerClasses</span><span class="p">:</span>
            <span class="k">return</span>  <span class="c1"># TODO: protest nicely</span>
        <span class="n">viewer</span> <span class="o">=</span> <span class="n">viewerClasses</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">project</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">windows</span><span class="p">)</span>
        <span class="n">viewer</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_openScipionLink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; So far only protocols are coming through links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_openProtocolFormFromId</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_openProtocolFormFromId</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">protId</span><span class="p">):</span>

        <span class="n">prot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">getObject</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">protId</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_openProtocolForm</span><span class="p">(</span><span class="n">prot</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_openProtocolForm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prot</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open the Protocol GUI Form given a Protocol instance&quot;&quot;&quot;</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">TITLE_NAME_RUN</span> <span class="o">+</span> <span class="n">prot</span><span class="o">.</span><span class="n">getClassName</span><span class="p">()</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">gui</span><span class="o">.</span><span class="n">form</span><span class="o">.</span><span class="n">FormWindow</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">prot</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_executeSaveProtocol</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">windows</span><span class="p">,</span>
                                <span class="n">hostList</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">getHostNames</span><span class="p">())</span>
        <span class="n">w</span><span class="o">.</span><span class="n">adjustSize</span><span class="p">()</span>
        <span class="n">w</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_executeSaveProtocol</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prot</span><span class="p">,</span> <span class="n">onlySave</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">onlySave</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">saveProtocol</span><span class="p">(</span><span class="n">prot</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_SAVED_FORM</span>
            <span class="c1">#            msg = &quot;Protocol successfully saved.&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">launchProtocol</span><span class="p">(</span><span class="n">prot</span><span class="p">)</span>
            <span class="c1"># Select the launched protocol to display its summary, methods..etc</span>
            <span class="c1"># self._selection.clear()</span>
            <span class="c1"># self._selection.append(prot.getObjId())</span>
            <span class="c1"># self._updateSelection()</span>
            <span class="c1"># clear lastStatus to force re-load the logs</span>
            <span class="c1"># self._lastStatus = None</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

        <span class="k">return</span> <span class="n">msg</span>

    <span class="k">def</span> <span class="nf">_onRightClick</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">LABEL_EDIT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_editObject</span><span class="p">,</span>
             <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">ACTION_EDIT</span><span class="p">),</span>
            <span class="p">(</span><span class="s1">&#39;Go to protocol&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_goToProtocol</span><span class="p">,</span>
             <span class="n">pwutils</span><span class="o">.</span><span class="n">Icon</span><span class="o">.</span><span class="n">ACTION_SEARCH</span><span class="p">)</span>
        <span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">_editObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Open the Edit GUI Form given an instance&quot;&quot;&quot;</span>
        <span class="n">EditObjectDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pwutils</span><span class="o">.</span><span class="n">Message</span><span class="o">.</span><span class="n">TITLE_EDIT_OBJECT</span><span class="p">,</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">_selected</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">mapper</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_goToProtocol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Switch to protocols view selecting the correspondent protocol&quot;&quot;&quot;</span>

<div class="viewcode-block" id="ProjectDataView.refreshData"><a class="viewcode-back" href="../../../../api/pyworkflow.gui.project.viewdata.html#pyworkflow.gui.project.viewdata.ProjectDataView.refreshData">[docs]</a>    <span class="k">def</span> <span class="nf">refreshData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">initRefreshCounter</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Refresh the status of displayed data.</span>
<span class="sd">         Params:</span>
<span class="sd">            e: Tk event input</span>
<span class="sd">            initRefreshCounter: if True the refresh counter will be set to 3 secs</span>
<span class="sd">             then only case when False is from _automaticRefreshData where the</span>
<span class="sd">             refresh time is doubled each time to avoid refreshing too often.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">_dataGraph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">getSourceGraph</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updateDataTree</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updateDataGraph</span><span class="p">()</span>
 
        <span class="k">if</span> <span class="n">initRefreshCounter</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__autoRefreshCounter</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># start by 3 secs</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__autoRefresh</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">after_cancel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__autoRefresh</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__autoRefresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">after</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">__autoRefreshCounter</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_automaticRefreshData</span><span class="p">)</span></div>
         
    <span class="k">def</span> <span class="nf">_automaticRefreshData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Schedule automatic refresh increasing the time between refreshes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshData</span><span class="p">(</span><span class="n">initRefreshCounter</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">secs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__autoRefreshCounter</span>
        <span class="c1"># double the number of seconds up to 30 min</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__autoRefreshCounter</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">secs</span><span class="p">,</span> <span class="mi">1800</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__autoRefresh</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataTree</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">secs</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span>
                                                 <span class="bp">self</span><span class="o">.</span><span class="n">_automaticRefreshData</span><span class="p">)</span></div>
                
                
<div class="viewcode-block" id="DataTextBox"><a class="viewcode-back" href="../../../../api/pyworkflow.gui.project.viewdata.html#pyworkflow.gui.project.viewdata.DataTextBox">[docs]</a><span class="k">class</span> <span class="nc">DataTextBox</span><span class="p">(</span><span class="n">RoundedTextBox</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bgColor</span><span class="p">,</span> <span class="n">textColor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">):</span>
        <span class="n">RoundedTextBox</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">bgColor</span><span class="p">,</span> <span class="n">textColor</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: release-2.0.0
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../../../gh-pages/index.html">gh-pages</a></dd>
            <dd><a href="viewdata.html">release-2.0.0</a></dd>
            <dd><a href="../../../../../release-3.0.0/index.html">release-3.0.0</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>