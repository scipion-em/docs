

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pkpd.models.pk_models &mdash; Scipion 3.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Set up</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/scipion-modes/how-to-install.html">Installing Scipion v3.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/scipion-modes/scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/scipion-modes/host-configuration.html">Host configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/user-documentation.html#tutorials">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/user-documentation.html#processing-how-to-s">Processing How Toâ€™s</a></li>
</ul>
<p class="caption"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/facilities/facilities.html">On-the-fly processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/facilities/customize-report.html">Summary Reports</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/api/scipion-API.html">Scipion API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/api/plugins-API.html">Plugins API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/api/xmipp-API.html">Xmipp API</a></li>
</ul>
<p class="caption"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/misc/contact-us.html">Contact Us</a></li>
</ul>
<p class="caption"><span class="caption-text">Licences</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../docs/user/license.html">Licenses</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../../pkpd.html">pkpd</a> &raquo;</li>
        
      <li>pkpd.models.pk_models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pkpd.models.pk_models</h1><div class="highlight"><pre>
<span></span><span class="c1"># **************************************************************************</span>
<span class="c1"># *</span>
<span class="c1"># * Authors:     Carlos Oscar Sorzano (info@kinestat.com)</span>
<span class="c1"># *</span>
<span class="c1"># * Kinestat Pharma</span>
<span class="c1"># *</span>
<span class="c1"># * This program is free software; you can redistribute it and/or modify</span>
<span class="c1"># * it under the terms of the GNU General Public License as published by</span>
<span class="c1"># * the Free Software Foundation; either version 2 of the License, or</span>
<span class="c1"># * (at your option) any later version.</span>
<span class="c1"># *</span>
<span class="c1"># * This program is distributed in the hope that it will be useful,</span>
<span class="c1"># * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="c1"># * GNU General Public License for more details.</span>
<span class="c1"># *</span>
<span class="c1"># * You should have received a copy of the GNU General Public License</span>
<span class="c1"># * along with this program; if not, write to the Free Software</span>
<span class="c1"># * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA</span>
<span class="c1"># * 02111-1307  USA</span>
<span class="c1"># *</span>
<span class="c1"># *  All comments concerning this program package may be sent to the</span>
<span class="c1"># *  e-mail address &#39;info@kinestat.com&#39;</span>
<span class="c1"># *</span>
<span class="c1"># **************************************************************************</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">PK models</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">pkpd.objects</span> <span class="k">import</span> <span class="n">PKPDModel</span><span class="p">,</span> <span class="n">PKPDODEModel</span>
<span class="kn">from</span> <span class="nn">pkpd.pkpd_units</span> <span class="k">import</span> <span class="p">(</span><span class="n">inverseUnits</span><span class="p">,</span> <span class="n">divideUnits</span><span class="p">,</span> <span class="n">multiplyUnits</span><span class="p">,</span>
                             <span class="n">unitFromString</span><span class="p">,</span> <span class="n">createUnit</span><span class="p">,</span> <span class="n">PKPDUnit</span><span class="p">)</span>


<div class="viewcode-block" id="PKModel"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKModel">[docs]</a><span class="k">class</span> <span class="nc">PKModel</span><span class="p">(</span><span class="n">PKPDModel</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="PKGenericModel"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKGenericModel">[docs]</a><span class="k">class</span> <span class="nc">PKGenericModel</span><span class="p">(</span><span class="n">PKModel</span><span class="p">):</span>
    <span class="k">pass</span></div>

<div class="viewcode-block" id="signifcantMessage1"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.signifcantMessage1">[docs]</a><span class="k">def</span> <span class="nf">signifcantMessage1</span><span class="p">(</span><span class="n">varName</span><span class="p">,</span><span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">lower</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">upper</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Suspicious, </span><span class="si">%s</span><span class="s2"> looks like a constant&quot;</span><span class="o">%</span><span class="n">varName</span>
    <span class="k">elif</span> <span class="n">lower</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Suspicious, </span><span class="si">%s</span><span class="s2"> may be unstable&quot;</span><span class="o">%</span><span class="n">varName</span>
    <span class="k">elif</span> <span class="n">lower</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;True&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;NA&quot;</span></div>

<div class="viewcode-block" id="signifcantMessage2"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.signifcantMessage2">[docs]</a><span class="k">def</span> <span class="nf">signifcantMessage2</span><span class="p">(</span><span class="n">varName</span><span class="p">,</span><span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">lower</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">upper</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Suspicious, </span><span class="si">%s</span><span class="s2"> looks like 0&quot;</span><span class="o">%</span><span class="n">varName</span>
    <span class="k">elif</span> <span class="n">upper</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Suspicious, </span><span class="si">%s</span><span class="s2"> seems to be negative&quot;</span><span class="o">%</span><span class="n">varName</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;True&quot;</span></div>

<div class="viewcode-block" id="signifcantMessage3"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.signifcantMessage3">[docs]</a><span class="k">def</span> <span class="nf">signifcantMessage3</span><span class="p">(</span><span class="n">varName</span><span class="p">,</span><span class="n">lower</span><span class="p">,</span><span class="n">upper</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">lower</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">upper</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Suspicious, </span><span class="si">%s</span><span class="s2"> looks like 0&quot;</span><span class="o">%</span><span class="n">varName</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;True&quot;</span></div>

<div class="viewcode-block" id="PKPDExponentialModel"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDExponentialModel">[docs]</a><span class="k">class</span> <span class="nc">PKPDExponentialModel</span><span class="p">(</span><span class="n">PKGenericModel</span><span class="p">):</span>
<div class="viewcode-block" id="PKPDExponentialModel.forwardModel"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDExponentialModel.forwardModel">[docs]</a>    <span class="k">def</span> <span class="nf">forwardModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="n">xToUse</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># From [array(...)] to array(...)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yPredicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">xToUse</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">proceed</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Nexp</span><span class="p">):</span>
            <span class="n">ck</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span>
            <span class="n">ck_1</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
            <span class="k">if</span> <span class="n">ck_1</span><span class="o">&lt;</span><span class="n">ck</span><span class="p">:</span>
                <span class="n">proceed</span><span class="o">=</span><span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">yPredicted</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1000</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">xToUse</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">proceed</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Nexp</span><span class="p">):</span>
                <span class="n">ck</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">]</span>
                <span class="n">lk</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">yPredicted</span> <span class="o">+=</span> <span class="n">ck</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">lk</span><span class="o">*</span><span class="n">xToUse</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yPredicted</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">yPredicted</span><span class="p">]</span> <span class="c1"># From array(...) to [array(...)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">yPredicted</span></div>

<div class="viewcode-block" id="PKPDExponentialModel.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDExponentialModel.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Sum of exponentials (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PKPDExponentialModel.prepare"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDExponentialModel.prepare">[docs]</a>    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xToUse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># From [array(...)] to array(...)</span>
            <span class="n">ylogToUse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ylog</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">xToUse</span><span class="p">,</span><span class="n">ylogToUse</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First estimate of 1 exponential term: &quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Y=</span><span class="si">%f</span><span class="s2">*exp(-</span><span class="si">%f</span><span class="s2">*X)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

            <span class="n">cBound</span> <span class="o">=</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)</span>
            <span class="n">lambdaBound</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">0.01</span><span class="p">,</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nexp</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cBound</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lambdaBound</span><span class="p">)</span></div>

<div class="viewcode-block" id="PKPDExponentialModel.printSetup"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDExponentialModel.printSetup">[docs]</a>    <span class="k">def</span> <span class="nf">printSetup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">getModelEquation</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of exponentials: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nexp</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bounds: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">))</span></div>

<div class="viewcode-block" id="PKPDExponentialModel.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDExponentialModel.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Y=sum_i c_i*exp(-lambda_i * X)&quot;</span></div>

<div class="viewcode-block" id="PKPDExponentialModel.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDExponentialModel.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">toPrint</span><span class="o">=</span><span class="s2">&quot;Y=&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nexp</span><span class="p">):</span>
            <span class="n">toPrint</span><span class="o">+=</span> <span class="s2">&quot;+[</span><span class="si">%f</span><span class="s2">*exp(-</span><span class="si">%f</span><span class="s2">*X)]&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">toPrint</span></div>

<div class="viewcode-block" id="PKPDExponentialModel.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDExponentialModel.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">parameterList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nexp</span><span class="p">):</span>
            <span class="n">parameterList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;c</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">parameterList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;lambda</span><span class="si">%d</span><span class="s1">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">parameterList</span></div>

<div class="viewcode-block" id="PKPDExponentialModel.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDExponentialModel.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">yunits</span><span class="p">,</span><span class="n">inverseUnits</span><span class="p">(</span><span class="n">xunits</span><span class="p">)]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">Nexp</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PKPDExponentialModel.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDExponentialModel.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nexp</span><span class="p">):</span>
            <span class="n">cLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span>
            <span class="n">cUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">cLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">cUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;False&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">cLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">cUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, this term may be negative&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

            <span class="n">decayLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">decayUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">decayLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">decayUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, looks like a constant&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">decayLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, this term may be unstable&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">decayLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PKPDExponentialModel.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDExponentialModel.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>

<div class="viewcode-block" id="PKPDSimpleEVModel"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDSimpleEVModel">[docs]</a><span class="k">class</span> <span class="nc">PKPDSimpleEVModel</span><span class="p">(</span><span class="n">PKModel</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">includeTlag</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">PKModel</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">includeTlag</span> <span class="o">=</span> <span class="n">includeTlag</span>

<div class="viewcode-block" id="PKPDSimpleEVModel.forwardModel"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDSimpleEVModel.forwardModel">[docs]</a>    <span class="k">def</span> <span class="nf">forwardModel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="kc">None</span><span class="p">:</span>
            <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span>
        <span class="n">xToUse</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># From [array(...)] to array(...)</span>

        <span class="n">Ka</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Vd</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">includeTlag</span><span class="p">:</span>
            <span class="n">tlag</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tlag</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">yPredicted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">xToUse</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">xToUse</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">xToUse</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">tlag</span><span class="p">:</span>
                <span class="n">td</span><span class="o">=</span><span class="n">xToUse</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">tlag</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">yPredicted</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Ka</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">F</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">D</span><span class="o">/</span><span class="p">(</span><span class="n">Vd</span><span class="o">*</span><span class="p">(</span><span class="n">Ka</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="o">*</span><span class="n">td</span><span class="p">)</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Ka</span><span class="o">*</span><span class="n">td</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">yPredicted</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">yPredicted</span><span class="p">]</span> <span class="c1"># From array(...) to [array(...)]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">yPredicted</span></div>

<div class="viewcode-block" id="PKPDSimpleEVModel.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDSimpleEVModel.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Simple non-iv model (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PKPDSimpleEVModel.prepare"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDSimpleEVModel.prepare">[docs]</a>    <span class="k">def</span> <span class="nf">prepare</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xToUse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># From [array(...)] to array(...)</span>
            <span class="n">yToUse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># Keep only the ascending part of the curve</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">yToUse</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">yToUse</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span><span class="n">yToUse</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first estimate of Ka and Vd cannot be determined&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span>
            <span class="n">xAscending</span> <span class="o">=</span> <span class="n">xToUse</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="n">yAscending</span> <span class="o">=</span> <span class="n">yToUse</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>

            <span class="n">ylogE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">,</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C0</span><span class="p">)],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">),</span><span class="n">xAscending</span><span class="p">)</span>
            <span class="n">ylogToFit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">yAscending</span><span class="p">)</span><span class="o">-</span><span class="n">ylogE</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">xAscending</span><span class="p">,</span><span class="o">-</span><span class="n">ylogToFit</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">Ka</span> <span class="o">=</span> <span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">Vd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">D</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="c1"># Incorrect: (Ka*self.F*self.D)/(math.exp(p[1])*(Ka-self.Ke))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">=</span><span class="p">[(</span><span class="n">Ka</span><span class="o">*</span><span class="mf">0.2</span><span class="p">,</span><span class="n">Ka</span><span class="o">*</span><span class="mi">5</span><span class="p">),(</span><span class="mf">0.2</span><span class="o">*</span><span class="n">Vd</span><span class="p">,</span><span class="mi">5</span><span class="o">*</span><span class="n">Vd</span><span class="p">)]</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First estimate of Ka: </span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">Ka</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First estimate of Vd: </span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">Vd</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">includeTlag</span><span class="p">:</span>
                <span class="n">tlag</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">C0</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">Ka</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First estimate of tlag: </span><span class="si">%f</span><span class="s2">&quot;</span><span class="o">%</span><span class="n">tlag</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">tlag</span><span class="p">),</span><span class="mi">5</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">tlag</span><span class="p">)))</span></div>

<div class="viewcode-block" id="PKPDSimpleEVModel.printSetup"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDSimpleEVModel.printSetup">[docs]</a>    <span class="k">def</span> <span class="nf">printSetup</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">getModelEquation</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bounds: &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bounds</span><span class="p">))</span></div>

<div class="viewcode-block" id="PKPDSimpleEVModel.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDSimpleEVModel.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">includeTlag</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Y=Ka*F*D/(Vd*(Ka-Ke))*(exp(-Ke*(t-tlag))-exp(-Ka*(t-tlag))&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Y=Ka*F*D/(Vd*(Ka-Ke))*(exp(-Ke*t)-exp(-Ka*t)&quot;</span></div>

<div class="viewcode-block" id="PKPDSimpleEVModel.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDSimpleEVModel.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Ka</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Vd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">includeTlag</span><span class="p">:</span>
            <span class="n">tlag</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">return</span> <span class="s2">&quot;Y=</span><span class="si">%f</span><span class="s2">*</span><span class="si">%f</span><span class="s2">*D/(</span><span class="si">%f</span><span class="s2">*(</span><span class="si">%f</span><span class="s2">-</span><span class="si">%f</span><span class="s2">))*(exp(-</span><span class="si">%f</span><span class="s2">*(t-(</span><span class="si">%f</span><span class="s2">)))-exp(-</span><span class="si">%f</span><span class="s2">*(t-(</span><span class="si">%f</span><span class="s2">))))&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Ka</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">F</span><span class="p">,</span><span class="n">Vd</span><span class="p">,</span><span class="n">Ka</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">,</span><span class="n">tlag</span><span class="p">,</span><span class="n">Ka</span><span class="p">,</span><span class="n">tlag</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Y=</span><span class="si">%f</span><span class="s2">*</span><span class="si">%f</span><span class="s2">*D/(</span><span class="si">%f</span><span class="s2">*(</span><span class="si">%f</span><span class="s2">-</span><span class="si">%f</span><span class="s2">))*(exp(-</span><span class="si">%f</span><span class="s2">*t)-exp(-</span><span class="si">%f</span><span class="s2">*t))&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Ka</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">F</span><span class="p">,</span><span class="n">Vd</span><span class="p">,</span><span class="n">Ka</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">Ke</span><span class="p">,</span><span class="n">Ka</span><span class="p">)</span></div>

<div class="viewcode-block" id="PKPDSimpleEVModel.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDSimpleEVModel.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">includeTlag</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Ka&#39;</span><span class="p">,</span><span class="s1">&#39;Vd&#39;</span><span class="p">,</span><span class="s1">&#39;tlag&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Ka&#39;</span><span class="p">,</span><span class="s1">&#39;Vd&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PKPDSimpleEVModel.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDSimpleEVModel.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">C0units</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">inverseUnits</span><span class="p">(</span><span class="n">xunits</span><span class="p">),</span><span class="n">Vunits</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">includeTlag</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xunits</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PKPDSimpleEVModel.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDSimpleEVModel.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># Ka</span>
        <span class="n">decayLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">decayUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">decayLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">decayUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Ka looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">decayLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Ka may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">decayLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Vd</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vd looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vd seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="c1"># tlag</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">includeTlag</span><span class="p">:</span>
            <span class="n">tLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">tUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">tLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">tUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, tlag looks like 0&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">tUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, tlag seems to be negative&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PKPDSimpleEVModel.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PKPDSimpleEVModel.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>

<div class="viewcode-block" id="PK_Monocompartment"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment">[docs]</a><span class="k">class</span> <span class="nc">PK_Monocompartment</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_Monocompartment.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># print(&quot;F t=&quot;,t,&quot; C=&quot;,y, &quot; incC=&quot;,-Cl/V*y)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">Cl</span><span class="o">/</span><span class="n">V</span><span class="o">*</span><span class="n">y</span></div>

<div class="viewcode-block" id="PK_Monocompartment.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># print(&quot;G t=&quot;,t,&quot; dD=&quot;,dD,&quot; incC=&quot;,dD/V)</span>
        <span class="k">return</span> <span class="n">dD</span><span class="o">/</span><span class="n">V</span></div>

<div class="viewcode-block" id="PK_Monocompartment.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PK_Monocompartment.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PK_Monocompartment.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Monocompartmental model (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_Monocompartment.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Cl/V * C + 1/V * dD/dt&quot;</span></div>

<div class="viewcode-block" id="PK_Monocompartment.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -(</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * C + 1/(</span><span class="si">%f</span><span class="s2">) dD/dt&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_Monocompartment.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Cl&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_Monocompartment.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">)</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_Monocompartment.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># Cl</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Cl looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Cl may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># V</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_Monocompartment.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div>

<div class="viewcode-block" id="PK_Monocompartment.printOtherParameterization"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Monocompartment.printOtherParameterization">[docs]</a>    <span class="k">def</span> <span class="nf">printOtherParameterization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model parameterization ===========&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The one compartment model (excluding the source) has been estimated according to the homogeneous equation:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is called the physiological parameterization&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dC/dt = -Cl/V * C&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;where:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C is the concentration in the central compartment&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;with parameters:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cl=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Clearance from central compartment)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;V=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Apparent volume of distribution in the central compartment)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An alternative formulation is given by its microconstants formulation:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dA/dt = -ke * A&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;where:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A is the amount of drug in the central compartment (A=C*V)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;with parameters:&quot;</span><span class="p">)</span>
        <span class="n">ke</span><span class="o">=</span><span class="n">Cl</span><span class="o">/</span><span class="n">V</span>
        <span class="n">kunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ke=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Elimination from central compartment, ke=Cl/V)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">ke</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">kunits</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An alternative formulation is given by its impulse response (response to an intravenous bolus of amount A0):&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A=A0*exp(-ke*t)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;where:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A is the amount of drug in the central compartment&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A0 is the amount of drug given in the bolus&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PK_MonocompartmentClint"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint">[docs]</a><span class="k">class</span> <span class="nc">PK_MonocompartmentClint</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
    <span class="c1"># https://www.nps.org.au/australian-prescriber/articles/pharmacokinetics-made-easy-9-non-linear-pharmacokinetics</span>
<div class="viewcode-block" id="PK_MonocompartmentClint.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">Vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Km</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Clint</span><span class="o">=</span><span class="n">Vmax</span><span class="o">/</span><span class="p">(</span><span class="n">Km</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="o">-</span><span class="n">Clint</span><span class="o">/</span><span class="n">V</span><span class="o">*</span><span class="n">y</span></div>

<div class="viewcode-block" id="PK_MonocompartmentClint.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">dD</span><span class="o">/</span><span class="n">V</span></div>

<div class="viewcode-block" id="PK_MonocompartmentClint.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PK_MonocompartmentClint.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PK_MonocompartmentClint.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Monocompartmental intrinsic clearance model (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_MonocompartmentClint.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Clint/V * C + 1/V * dD/dt and Clint=Vmax/(Km+C)&quot;</span></div>

<div class="viewcode-block" id="PK_MonocompartmentClint.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Km</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Clint/(</span><span class="si">%f</span><span class="s2">) * C + 1/(</span><span class="si">%f</span><span class="s2">) dD/dt and Clint=(</span><span class="si">%f</span><span class="s2">)/((</span><span class="si">%f</span><span class="s2">)+C)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Vmax</span><span class="p">,</span><span class="n">Km</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_MonocompartmentClint.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Vmax&#39;</span><span class="p">,</span><span class="s1">&#39;Km&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_MonocompartmentClint.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="n">unitFromString</span><span class="p">(</span><span class="s2">&quot;min&quot;</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">)</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="n">Vmaxunits</span> <span class="o">=</span> <span class="n">multiplyUnits</span><span class="p">(</span><span class="n">Clunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vmaxunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_MonocompartmentClint.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># Vmax</span>
        <span class="n">VmaxLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">VmaxlUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VmaxLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VmaxlUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vmax looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VmaxLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vmax may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VmaxLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Km</span>
        <span class="n">KmLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">KmUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">KmLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">KmUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Km looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">KmLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Km may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">KmLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># V</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_MonocompartmentClint.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentClint.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>

<div class="viewcode-block" id="PK_Twocompartments"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments">[docs]</a><span class="k">class</span> <span class="nc">PK_Twocompartments</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_Twocompartments.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">C</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Cp</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">Q12</span> <span class="o">=</span> <span class="n">Clp</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">Cp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">Cl</span><span class="o">*</span><span class="n">C</span> <span class="o">+</span> <span class="n">Q12</span><span class="p">)</span><span class="o">/</span><span class="n">V</span><span class="p">,</span> <span class="n">Q12</span><span class="o">/</span><span class="n">Vp</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_Twocompartments.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD</span><span class="o">/</span><span class="n">V</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_Twocompartments.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PK_Twocompartments.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="PK_Twocompartments.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Two-compartments model (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_Twocompartments.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Cl/V * C - Clp/V * (C-Cp) + 1/V * dD/dt and dCp/dt = Clp/Vp * (C-Cp)&quot;</span></div>

<div class="viewcode-block" id="PK_Twocompartments.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -(</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * C - (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp) + 1/(</span><span class="si">%f</span><span class="s2">) * dD/dt; dCp/dt = (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">Vp</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_Twocompartments.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Cl&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;Clp&#39;</span><span class="p">,</span><span class="s1">&#39;Vp&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_Twocompartments.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">)</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_Twocompartments.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># Cl</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Cl looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Cl may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># V</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="c1"># Clp</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Vp</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_Twocompartments.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div>

<div class="viewcode-block" id="PK_Twocompartments.printOtherParameterization"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Twocompartments.printOtherParameterization">[docs]</a>    <span class="k">def</span> <span class="nf">printOtherParameterization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model parameterization ===========&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The two compartment model (excluding the source) has been estimated according to the homogeneous equations:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is called the physiological parameterization&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dC/dt = -Cl/V * C - Clp/V * (C-Cp) and dCp/dt = Clp/Vp * (C-Cp)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;where:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C is the concentration in the central compartment&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cp is the concentration in the peripheral compartment&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;with parameters:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cl=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Clearance from central compartment)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;V=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Apparent volume of distribution in the central compartment)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Clp=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Clearance from the central to the peripheral compartment and viceversa)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Clp</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Vp=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Apparent volume of distribution in the peripheral compartment)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Vp</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">3</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An alternative formulation is given by its microconstants formulation:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dA/dt = -k10 * A - k12 * A + k21 * Ap and dAp/dt = k12 * A - k21 * Ap&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;where:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A is the amount of drug in the central compartment (A=C*V)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Ap is the amount of drug in the peripheral compartment (Ap=Cp*Vp)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;with parameters:&quot;</span><span class="p">)</span>
        <span class="n">k12</span><span class="o">=</span><span class="n">Clp</span><span class="o">/</span><span class="n">V</span>
        <span class="n">k21</span><span class="o">=</span><span class="n">Clp</span><span class="o">/</span><span class="n">Vp</span>
        <span class="n">k10</span><span class="o">=</span><span class="n">Cl</span><span class="o">/</span><span class="n">V</span>
        <span class="n">kunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;k10=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Elimination from central compartment, k10=Cl/V)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">k10</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">kunits</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;k12=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Transfer from central to peripheral compartment, k12=Clp/V)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">k12</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">kunits</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;k21=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Transfer from peripheral to central compartment, k21=Clp/Vp)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">k21</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">kunits</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An alternative formulation is given by its impulse response (response to an intravenous bolus of amount A0):&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A=A0*a*exp(-alpha*t)+A0*b*exp(-beta*t)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;where:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A is the amount of drug in the central compartment&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A0 is the amount of drug given in the bolus&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The first exponential (alpha) should extinguish faster than the second (beta)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;with parameters:&quot;</span><span class="p">)</span>
        <span class="n">u</span><span class="o">=</span><span class="n">k21</span><span class="o">+</span><span class="n">k12</span><span class="o">+</span><span class="n">k10</span>
        <span class="n">v</span><span class="o">=</span><span class="n">k21</span><span class="o">*</span><span class="n">k10</span>
        <span class="n">k2units</span> <span class="o">=</span> <span class="n">multiplyUnits</span><span class="p">(</span><span class="n">kunits</span><span class="p">,</span><span class="n">kunits</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;u=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (auxiliary variable, u=k12+k21+k10)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">kunits</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;v=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (auxiliary variable, u=k21*k10)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">k2units</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;alpha and beta are solved from:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;alpha+beta=u&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;alpha*beta=v&quot;</span><span class="p">)</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="o">+</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">u</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">v</span><span class="p">))</span>
        <span class="n">beta</span><span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">u</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">v</span><span class="p">))</span>
        <span class="n">a</span><span class="o">=</span><span class="p">(</span><span class="n">alpha</span><span class="o">-</span><span class="n">k21</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">alpha</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span>
        <span class="n">b</span><span class="o">=</span><span class="p">(</span><span class="n">k21</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span> <span class="o">/</span><span class="p">(</span><span class="n">alpha</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;a=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)     (Amplitude of first exponential,  a=(alpha-k21)/(alpha-beta))&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;alpha=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Decay of first exponential)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_INVTIME_MIN</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;b=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)     (Amplitude of second exponential, b=(k21-beta)/(alpha-beta))&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;beta=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)  (Decay of second exponential)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_INVTIME_MIN</span><span class="p">)))</span></div></div>

<div class="viewcode-block" id="PK_TwocompartmentsClint"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint">[docs]</a><span class="k">class</span> <span class="nc">PK_TwocompartmentsClint</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_TwocompartmentsClint.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">Vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Km</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">C</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Cp</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">Clint</span><span class="o">=</span><span class="n">Vmax</span><span class="o">/</span><span class="p">(</span><span class="n">Km</span><span class="o">+</span><span class="n">C</span><span class="p">)</span>
        <span class="n">Q12</span> <span class="o">=</span> <span class="n">Clp</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">Cp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">Clint</span><span class="o">*</span><span class="n">C</span> <span class="o">+</span> <span class="n">Q12</span><span class="p">)</span><span class="o">/</span><span class="n">V</span><span class="p">,</span> <span class="n">Q12</span><span class="o">/</span><span class="n">Vp</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClint.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD</span><span class="o">/</span><span class="n">V</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClint.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClint.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClint.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Two-compartments intrinsic clearance model (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClint.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Clint/V * C - Clp/V * (C-Cp) + 1/V * dD/dt and dCp/dt = Clp/Vp * (C-Cp) and Clint=Vmax/(Km+C)&quot;</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClint.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Km</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Clint/(</span><span class="si">%f</span><span class="s2">) * C - (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp) + 1/(</span><span class="si">%f</span><span class="s2">) * dD/dt; dCp/dt = (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp); Clint=(</span><span class="si">%f</span><span class="s2">)/((</span><span class="si">%f</span><span class="s2">)+C)&quot;</span><span class="o">%</span>\
               <span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">Vp</span><span class="p">,</span><span class="n">Vmax</span><span class="p">,</span><span class="n">Km</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClint.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Vmax&#39;</span><span class="p">,</span><span class="s1">&#39;Km&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;Clp&#39;</span><span class="p">,</span><span class="s1">&#39;Vp&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClint.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">)</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="n">Vmaxunits</span> <span class="o">=</span> <span class="n">multiplyUnits</span><span class="p">(</span><span class="n">Clunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vmaxunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClint.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># Vmax</span>
        <span class="n">VmaxLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">VmaxlUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VmaxLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VmaxlUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vmax looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VmaxLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vmax may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VmaxLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Km</span>
        <span class="n">KmLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">KmUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">KmLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">KmUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Km looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">KmLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Km may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">KmLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># V</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="c1"># Clp</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Vp</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClint.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClint.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintCl"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl">[docs]</a><span class="k">class</span> <span class="nc">PK_TwocompartmentsClintCl</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_TwocompartmentsClintCl.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">Vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Km</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">C</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Cp</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">Clint</span><span class="o">=</span><span class="n">Vmax</span><span class="o">/</span><span class="p">(</span><span class="n">Km</span><span class="o">+</span><span class="n">C</span><span class="p">)</span>
        <span class="n">Q12</span> <span class="o">=</span> <span class="n">Clp</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">Cp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="p">((</span><span class="n">Clint</span><span class="o">+</span><span class="n">Cl</span><span class="p">)</span><span class="o">*</span><span class="n">C</span> <span class="o">+</span> <span class="n">Q12</span><span class="p">)</span><span class="o">/</span><span class="n">V</span><span class="p">,</span> <span class="n">Q12</span><span class="o">/</span><span class="n">Vp</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintCl.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD</span><span class="o">/</span><span class="n">V</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintCl.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintCl.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintCl.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Two-compartments intrinsic and 1st order clearance model (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintCl.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -(Clint+Cl)/V * C - Clp/V * (C-Cp) + 1/V * dD/dt and dCp/dt = Clp/Vp * (C-Cp) and Clint=Vmax/(Km+C)&quot;</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintCl.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Km</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -(Clint+</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * C - (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp) + 1/(</span><span class="si">%f</span><span class="s2">) * dD/dt; dCp/dt = (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp); Clint=(</span><span class="si">%f</span><span class="s2">)/((</span><span class="si">%f</span><span class="s2">)+C)&quot;</span><span class="o">%</span>\
               <span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">Vp</span><span class="p">,</span><span class="n">Vmax</span><span class="p">,</span><span class="n">Km</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintCl.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Vmax&#39;</span><span class="p">,</span><span class="s1">&#39;Km&#39;</span><span class="p">,</span><span class="s1">&#39;Cl&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;Clp&#39;</span><span class="p">,</span><span class="s1">&#39;Vp&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintCl.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">)</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="n">Vmaxunits</span> <span class="o">=</span> <span class="n">multiplyUnits</span><span class="p">(</span><span class="n">Clunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vmaxunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintCl.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># Vmax</span>
        <span class="n">VmaxLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">VmaxlUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VmaxLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VmaxlUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vmax looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VmaxLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vmax may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VmaxLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Km</span>
        <span class="n">KmLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">KmUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">KmLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">KmUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Km looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">KmLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Km may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">KmLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Cl</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Cl looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Cl may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># V</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="c1"># Clp</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Vp</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintCl.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintCl.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite">[docs]</a><span class="k">class</span> <span class="nc">PK_TwocompartmentsClintMetabolite</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">Vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Km</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Clm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">Vm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">C</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Cm</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Cp</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">Clint</span><span class="o">=</span><span class="n">Vmax</span><span class="o">/</span><span class="p">(</span><span class="n">Km</span><span class="o">+</span><span class="n">C</span><span class="p">)</span>
        <span class="n">Q12</span> <span class="o">=</span> <span class="n">Clp</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">Cp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">Clint</span><span class="o">*</span><span class="n">C</span> <span class="o">+</span> <span class="n">Q12</span><span class="p">)</span><span class="o">/</span><span class="n">V</span><span class="p">,</span> <span class="p">(</span><span class="n">Clint</span><span class="o">*</span><span class="n">C</span><span class="o">-</span><span class="n">Clm</span><span class="o">*</span><span class="n">Cm</span><span class="p">)</span><span class="o">/</span><span class="n">Vm</span><span class="p">,</span> <span class="n">Q12</span><span class="o">/</span><span class="n">Vp</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD</span><span class="o">/</span><span class="n">V</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Two-compartments intrinsic clearance model with metabolites (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Clint/V * C - Clp/V * (C-Cp) + 1/V * dD/dt and dCp/dt = Clp/Vp * (C-Cp) and Clint=Vmax/(Km+C) and dCm/dt=Clint*C/Vm-Clm*Cm/Vm&quot;</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Vmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Km</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Clm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">Vm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Clint/(</span><span class="si">%f</span><span class="s2">) * C - (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp) + 1/(</span><span class="si">%f</span><span class="s2">) * dD/dt; dCp/dt = (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp); Clint=(</span><span class="si">%f</span><span class="s2">)/((</span><span class="si">%f</span><span class="s2">)+C); dCm/dt=Clint*C/(</span><span class="si">%f</span><span class="s2">)-(</span><span class="si">%f</span><span class="s2">)*Cm/(</span><span class="si">%f</span><span class="s2">)&quot;</span><span class="o">%</span>\
               <span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">Vp</span><span class="p">,</span><span class="n">Vmax</span><span class="p">,</span><span class="n">Km</span><span class="p">,</span><span class="n">Vm</span><span class="p">,</span><span class="n">Clm</span><span class="p">,</span><span class="n">Vm</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Vmax&#39;</span><span class="p">,</span><span class="s1">&#39;Km&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;Clp&#39;</span><span class="p">,</span><span class="s1">&#39;Vp&#39;</span><span class="p">,</span><span class="s1">&#39;Clm&#39;</span><span class="p">,</span><span class="s1">&#39;Vm&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="n">Vmaxunits</span> <span class="o">=</span> <span class="n">multiplyUnits</span><span class="p">(</span><span class="n">Clunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Vmaxunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># Vmax</span>
        <span class="n">VmaxLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">VmaxlUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VmaxLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VmaxlUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vmax looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VmaxLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vmax may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VmaxLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Km</span>
        <span class="n">KmLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">KmUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">KmLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">KmUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Km looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">KmLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Km may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">KmLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># V</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="c1"># Clp</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Vp</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="c1"># Clm</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clm looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Vm</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vm looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vm seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsClintMetabolite.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsClintMetabolite.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>

<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction">[docs]</a><span class="k">class</span> <span class="nc">PK_TwocompartmentsAutoinduction</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">E0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">kout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">C</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Cp</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">E</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">Cl</span><span class="o">=</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">E</span><span class="p">)</span>
        <span class="n">Q12</span> <span class="o">=</span> <span class="n">Clp</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">Cp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">Cl</span><span class="o">*</span><span class="n">C</span> <span class="o">+</span> <span class="n">Q12</span><span class="p">)</span><span class="o">/</span><span class="n">V</span><span class="p">,</span> <span class="n">Q12</span><span class="o">/</span><span class="n">Vp</span><span class="p">,</span> <span class="n">kout</span><span class="o">*</span><span class="p">(</span><span class="n">E0</span><span class="o">+</span><span class="n">C</span><span class="o">-</span><span class="n">E</span><span class="p">)],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD</span><span class="o">/</span><span class="n">V</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Two-compartments model with autoinduction (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Cl/V * C - Clp/V * (C-Cp) + 1/V * dD/dt, dCp/dt = Clp/Vp * (C-Cp), dE/dt=kout*(E0+C-E) and Cl=a*(1+E)&quot;</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">E0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">kout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Cl/(</span><span class="si">%f</span><span class="s2">) * C - (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp) + 1/(</span><span class="si">%f</span><span class="s2">) * dD/dt; dCp/dt = (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp); dE/dt=(</span><span class="si">%f</span><span class="s2">)*(</span><span class="si">%f</span><span class="s2">+C-E) and Cl=(</span><span class="si">%f</span><span class="s2">)*(1+E)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">Vp</span><span class="p">,</span><span class="n">kout</span><span class="p">,</span><span class="n">E0</span><span class="p">,</span><span class="n">a</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;E0&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;kout&#39;</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;Clp&#39;</span><span class="p">,</span><span class="s1">&#39;Vp&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">)</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># E0</span>
        <span class="n">E0Lower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">E0Upper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">E0Lower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">E0Upper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Cl looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">E0Lower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Cl may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">E0Lower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># A</span>
        <span class="n">ALower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">AUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ALower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">AUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, A looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ALower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># kout</span>
        <span class="n">koutLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">koutUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">koutLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">koutUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, A looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">koutLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># V</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="c1"># Clp</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Vp</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsAutoinduction.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsAutoinduction.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>


<div class="viewcode-block" id="PK_MonocompartmentUrine"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine">[docs]</a><span class="k">class</span> <span class="nc">PK_MonocompartmentUrine</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_MonocompartmentUrine.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fe</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">Cl</span><span class="o">/</span><span class="n">V</span><span class="o">*</span><span class="n">C</span><span class="p">,</span> <span class="n">fe</span><span class="o">*</span><span class="n">Cl</span><span class="o">*</span><span class="n">C</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_MonocompartmentUrine.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD</span><span class="o">/</span><span class="n">V</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_MonocompartmentUrine.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="PK_MonocompartmentUrine.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="PK_MonocompartmentUrine.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Monocompartmental model urine (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_MonocompartmentUrine.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Cl/V * C + 1/V * dD/dt and dAu/dt=fe*Cl*C&quot;</span></div>

<div class="viewcode-block" id="PK_MonocompartmentUrine.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fe</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -(</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * C + 1/(</span><span class="si">%f</span><span class="s2">) dD/dt and dAu/dt = (</span><span class="si">%f</span><span class="s2">)*(</span><span class="si">%f</span><span class="s2">)*C&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">fe</span><span class="p">,</span><span class="n">Cl</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_MonocompartmentUrine.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Cl&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;fe&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_MonocompartmentUrine.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_MonocompartmentUrine.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># Cl</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Ka looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Ka may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># V</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="n">feLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">feUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">feLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">feUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, fe looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">feUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, fe seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">feLower</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, fe seems to be larger than 1&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_MonocompartmentUrine.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentUrine.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1</span></div></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD">[docs]</a><span class="k">class</span> <span class="nc">PK_MonocompartmentLinkPD</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_MonocompartmentLinkPD.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Cb</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Q12</span> <span class="o">=</span> <span class="n">Clb</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">Cb</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">Cl</span><span class="o">*</span><span class="n">C</span> <span class="o">+</span> <span class="n">Q12</span><span class="p">)</span><span class="o">/</span><span class="n">V</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">Q12</span><span class="o">/</span><span class="n">Vb</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD</span><span class="o">/</span><span class="n">V</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD.H"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.H">[docs]</a>    <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">Cb</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">E0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">Cbm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="n">Cbb</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">Cb</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>

        <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">E0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">Cbb</span><span class="o">/</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">Cbm</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="n">Cbb</span><span class="p">))</span></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;One-compartmental model link pd (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Cl/V * C - Clb/V * (C-Cb) + 1/V * dD/dt, dCb/dt = Clb/Vb * (C-Cb) and E=E0+a*Cb^b/(Cbm^b+Cb^b)&quot;</span></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">E0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">Cbm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -(</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * C - (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cb) + 1/(</span><span class="si">%f</span><span class="s2">) * dD/dt, dCb/dt = (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cb) and E = (</span><span class="si">%f</span><span class="s2">)+(</span><span class="si">%f</span><span class="s2">)*Cb^(</span><span class="si">%f</span><span class="s2">)/((</span><span class="si">%f</span><span class="s2">)^(</span><span class="si">%f</span><span class="s2">)+Cb^(</span><span class="si">%f</span><span class="s2">))&quot;</span><span class="o">%</span>\
               <span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">Vp</span><span class="p">,</span><span class="n">E0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">Cbm</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Cl&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;Clp&#39;</span><span class="p">,</span><span class="s1">&#39;Vp&#39;</span><span class="p">,</span><span class="s1">&#39;E0&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;Cbm&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Eunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Eunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">yunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage1</span><span class="p">(</span><span class="s2">&quot;Cl&quot;</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">,</span>  <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage1</span><span class="p">(</span><span class="s2">&quot;Clp&quot;</span><span class="p">,</span><span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;Vp&quot;</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;E0&quot;</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span>  <span class="n">lowerBound</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, </span><span class="si">%s</span><span class="s2"> looks like 1&quot;</span> <span class="o">%</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;Cbm&quot;</span><span class="p">,</span><span class="n">lowerBound</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_MonocompartmentLinkPD.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentLinkPD.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>

<div class="viewcode-block" id="PK_MonocompartmentPD"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD">[docs]</a><span class="k">class</span> <span class="nc">PK_MonocompartmentPD</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_MonocompartmentPD.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">Cl</span><span class="o">*</span><span class="n">C</span><span class="o">/</span><span class="n">V</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_MonocompartmentPD.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD</span><span class="o">/</span><span class="n">V</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_MonocompartmentPD.H"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.H">[docs]</a>    <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">E0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Cm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Cb</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
            <span class="n">Cmb</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">Cm</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
            <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">E0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">Cb</span><span class="o">/</span><span class="p">(</span><span class="n">Cmb</span><span class="o">+</span><span class="n">Cb</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">E0</span></div>

<div class="viewcode-block" id="PK_MonocompartmentPD.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="PK_MonocompartmentPD.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="PK_MonocompartmentPD.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;One-compartmental model pd (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_MonocompartmentPD.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Cl/V * C + 1/V * dD/dt and E=E0+a*C^b/(Cm^b+C^b)&quot;</span></div>

<div class="viewcode-block" id="PK_MonocompartmentPD.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">E0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Cm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -(</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * C + 1/(</span><span class="si">%f</span><span class="s2">) * dD/dt, and E=(</span><span class="si">%f</span><span class="s2">)+(</span><span class="si">%f</span><span class="s2">)*Cb^(</span><span class="si">%f</span><span class="s2">)/((</span><span class="si">%f</span><span class="s2">)^(</span><span class="si">%f</span><span class="s2">)+Cb^(</span><span class="si">%f</span><span class="s2">))&quot;</span><span class="o">%</span>\
               <span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">E0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">Cm</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">b</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_MonocompartmentPD.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Cl&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;E0&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;Cbm&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_MonocompartmentPD.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Eunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Eunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">yunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_MonocompartmentPD.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage1</span><span class="p">(</span><span class="s2">&quot;Cl&quot;</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">,</span>  <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;E0&quot;</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span>  <span class="n">lowerBound</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, </span><span class="si">%s</span><span class="s2"> looks like 1&quot;</span> <span class="o">%</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;Cm&quot;</span><span class="p">,</span><span class="n">lowerBound</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_MonocompartmentPD.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_MonocompartmentPD.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>

<div class="viewcode-block" id="PK_TwocompartmentsUrine"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine">[docs]</a><span class="k">class</span> <span class="nc">PK_TwocompartmentsUrine</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_TwocompartmentsUrine.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Cp</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">fe</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Q12</span> <span class="o">=</span> <span class="n">Clp</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">Cp</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">Cl</span><span class="o">*</span><span class="n">C</span> <span class="o">+</span> <span class="n">Q12</span><span class="p">)</span><span class="o">/</span><span class="n">V</span><span class="p">,</span> <span class="n">fe</span><span class="o">*</span><span class="n">Cl</span><span class="o">*</span><span class="n">C</span><span class="p">,</span> <span class="n">Q12</span><span class="o">/</span><span class="n">Vp</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsUrine.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD</span><span class="o">/</span><span class="n">V</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsUrine.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsUrine.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsUrine.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Two-compartmental model urine (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsUrine.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Cl/V * C - Clp/V * (C-Cp) + 1/V * dD/dt, dCp/dt = Clp/Vp * (C-Cp) and dAu/dt=fe*Cl*C&quot;</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsUrine.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">fe</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -(</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * C - (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp) + 1/(</span><span class="si">%f</span><span class="s2">) * dD/dt, dCp/dt = (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp) and dAu/dt = (</span><span class="si">%f</span><span class="s2">)*(</span><span class="si">%f</span><span class="s2">)*C&quot;</span><span class="o">%</span>\
               <span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">Vp</span><span class="p">,</span><span class="n">fe</span><span class="p">,</span><span class="n">Cl</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsUrine.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Cl&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;Clp&#39;</span><span class="p">,</span><span class="s1">&#39;Vp&#39;</span><span class="p">,</span><span class="s1">&#39;fe&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsUrine.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsUrine.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># Cl</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Ka looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Ka may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># V</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="c1"># Clp</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clp may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Vp</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vp seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="c1"># fe</span>
        <span class="n">feLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">feUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">feLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">feUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, fe looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">feUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, fe seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">feLower</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, fe seems to be larger than 1&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsUrine.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsUrine.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">1</span></div></div>

<div class="viewcode-block" id="PK_TwocompartmentsBoth"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBoth">[docs]</a><span class="k">class</span> <span class="nc">PK_TwocompartmentsBoth</span><span class="p">(</span><span class="n">PK_Twocompartments</span><span class="p">):</span>
<div class="viewcode-block" id="PK_TwocompartmentsBoth.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBoth.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBoth.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBoth.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Two-compartmental model both (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBoth.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBoth.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD">[docs]</a><span class="k">class</span> <span class="nc">PK_TwocompartmentsBothPD</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_TwocompartmentsBothPD.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">C</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Cp</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">Q12</span> <span class="o">=</span> <span class="n">Clp</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">Cp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">Cl</span><span class="o">*</span><span class="n">C</span> <span class="o">+</span> <span class="n">Q12</span><span class="p">)</span><span class="o">/</span><span class="n">V</span><span class="p">,</span> <span class="n">Q12</span><span class="o">/</span><span class="n">Vp</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD</span><span class="o">/</span><span class="n">V</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD.H"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.H">[docs]</a>    <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">Cp</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">E0</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">Cpm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">Cpb</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">Cp</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
            <span class="n">Cpmb</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">Cpm</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
            <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">E0</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">Cpb</span><span class="o">/</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">Cpm</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">+</span><span class="n">Cpb</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">E0</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Two-compartments both PD model (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Cl/V * C - Clp/V * (C-Cp) + 1/V * dD/dt, dCp/dt = Clp/Vp * (C-Cp) and E=E0+a*Cp^b/(Cpm^b+Cp^b)&quot;</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vp</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -(</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * C - (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp) + 1/(</span><span class="si">%f</span><span class="s2">) * dD/dt; dCp/dt = (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cp)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clp</span><span class="p">,</span><span class="n">Vp</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Cl&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;Clp&#39;</span><span class="p">,</span><span class="s1">&#39;Vp&#39;</span><span class="p">,</span><span class="s1">&#39;E0&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;Cpm&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">Eunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Eunits</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">UNIT_NONE</span><span class="p">,</span><span class="n">yunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage1</span><span class="p">(</span><span class="s2">&quot;Cl&quot;</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;V&quot;</span><span class="p">,</span>  <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage1</span><span class="p">(</span><span class="s2">&quot;Clp&quot;</span><span class="p">,</span><span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;Vp&quot;</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;E0&quot;</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]))</span>
        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span>  <span class="n">lowerBound</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">5</span><span class="p">]))</span>

        <span class="k">if</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, </span><span class="si">%s</span><span class="s2"> looks like 1&quot;</span> <span class="o">%</span> <span class="s2">&quot;b&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">signifcantMessage2</span><span class="p">(</span><span class="s2">&quot;Cpm&quot;</span><span class="p">,</span><span class="n">lowerBound</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span><span class="n">upperBound</span><span class="p">[</span><span class="mi">7</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_TwocompartmentsBothPD.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_TwocompartmentsBothPD.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div></div>

<div class="viewcode-block" id="PK_Threecompartments"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments">[docs]</a><span class="k">class</span> <span class="nc">PK_Threecompartments</span><span class="p">(</span><span class="n">PKPDODEModel</span><span class="p">):</span>
<div class="viewcode-block" id="PK_Threecompartments.F"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.F">[docs]</a>    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clpa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vpa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Clpb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Vpb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">C</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">Cpa</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Cpb</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">Q12a</span> <span class="o">=</span> <span class="n">Clpa</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">Cpa</span><span class="p">)</span>
        <span class="n">Q12b</span> <span class="o">=</span> <span class="n">Clpb</span> <span class="o">*</span> <span class="p">(</span><span class="n">C</span><span class="o">-</span><span class="n">Cpb</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="p">(</span><span class="n">Cl</span><span class="o">*</span><span class="n">C</span> <span class="o">+</span> <span class="n">Q12a</span> <span class="o">+</span> <span class="n">Q12b</span><span class="p">)</span><span class="o">/</span><span class="n">V</span><span class="p">,</span> <span class="n">Q12a</span><span class="o">/</span><span class="n">Vpa</span><span class="p">,</span> <span class="n">Q12b</span><span class="o">/</span><span class="n">Vpb</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_Threecompartments.G"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.G">[docs]</a>    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">dD</span><span class="p">):</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">dD</span><span class="o">/</span><span class="n">V</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_Threecompartments.getResponseDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.getResponseDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getResponseDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="PK_Threecompartments.getStateDimension"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.getStateDimension">[docs]</a>    <span class="k">def</span> <span class="nf">getStateDimension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span></div>

<div class="viewcode-block" id="PK_Threecompartments.getDescription"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.getDescription">[docs]</a>    <span class="k">def</span> <span class="nf">getDescription</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Three-compartments model (</span><span class="si">%s</span><span class="s2">)&quot;</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span></div>

<div class="viewcode-block" id="PK_Threecompartments.getModelEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.getModelEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getModelEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -Cl/V * C - Clpa/V * (C-Cpa) - Clpb/V * (C-Cpb) + 1/V * dD/dt and dCpa/dt = Clpa/Vpa * (C-Cpa) and  dCpb/dt = Clpb/Vpb * (C-Cpb)&quot;</span></div>

<div class="viewcode-block" id="PK_Threecompartments.getEquation"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.getEquation">[docs]</a>    <span class="k">def</span> <span class="nf">getEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clpa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vpa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Clpb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Vpb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">return</span> <span class="s2">&quot;dC/dt = -(</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * C - (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cpa) - (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cpb) + 1/(</span><span class="si">%f</span><span class="s2">) * dD/dt and dCpa/dt = (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cpa) and dCpb/dt = (</span><span class="si">%f</span><span class="s2">)/(</span><span class="si">%f</span><span class="s2">) * (C-Cpb)&quot;</span><span class="o">%</span>\
               <span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clpa</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clpb</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Clpa</span><span class="p">,</span><span class="n">Vpa</span><span class="p">,</span><span class="n">Clpb</span><span class="p">,</span><span class="n">Vpb</span><span class="p">)</span></div>

<div class="viewcode-block" id="PK_Threecompartments.getParameterNames"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.getParameterNames">[docs]</a>    <span class="k">def</span> <span class="nf">getParameterNames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Cl&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">,</span><span class="s1">&#39;Clpa&#39;</span><span class="p">,</span><span class="s1">&#39;Vpa&#39;</span><span class="p">,</span><span class="s1">&#39;Clpb&#39;</span><span class="p">,</span><span class="s1">&#39;Vpb&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="PK_Threecompartments.calculateParameterUnits"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.calculateParameterUnits">[docs]</a>    <span class="k">def</span> <span class="nf">calculateParameterUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sample</span><span class="p">):</span>
        <span class="n">xunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xName</span><span class="p">)</span>
        <span class="n">yunits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">getVarUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yName</span><span class="p">)</span>
        <span class="n">Vunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Dunits</span><span class="p">,</span><span class="n">yunits</span><span class="p">)</span>
        <span class="n">Clunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="n">Vunits</span><span class="p">,</span><span class="n">xunits</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span> <span class="o">=</span> <span class="p">[</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">,</span><span class="n">Clunits</span><span class="p">,</span><span class="n">Vunits</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span></div>

<div class="viewcode-block" id="PK_Threecompartments.areParametersSignificant"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.areParametersSignificant">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersSignificant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lowerBound</span><span class="p">,</span> <span class="n">upperBound</span><span class="p">):</span>
        <span class="n">retval</span><span class="o">=</span><span class="p">[]</span>
        <span class="c1"># Cl</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Cl looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Cl may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># V</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, V seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="c1"># Clpa</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clpa looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clpa may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Vpa</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vpa looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vpa seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="c1"># Clpb</span>
        <span class="n">ClLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">ClUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ClUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clpb looks like a constant&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Clpb may be unstable&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ClLower</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;NA&quot;</span><span class="p">)</span>

        <span class="c1"># Vpb</span>
        <span class="n">VLower</span> <span class="o">=</span> <span class="n">lowerBound</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">VUpper</span> <span class="o">=</span> <span class="n">upperBound</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">VLower</span><span class="o">&lt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">VUpper</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vpb looks like 0&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">VUpper</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Suspicious, Vpb seems to be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;True&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">retval</span></div>

<div class="viewcode-block" id="PK_Threecompartments.areParametersValid"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.areParametersValid">[docs]</a>    <span class="k">def</span> <span class="nf">areParametersValid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span></div>

<div class="viewcode-block" id="PK_Threecompartments.printOtherParameterization"><a class="viewcode-back" href="../../../api/pkpd/pkpd.models.pk_models.html#pkpd.models.pk_models.PK_Threecompartments.printOtherParameterization">[docs]</a>    <span class="k">def</span> <span class="nf">printOtherParameterization</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Cl</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">Clpa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">Vpa</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">Clpb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">Vpb</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Model parameterization ===========&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The three compartment model (excluding the source) has been estimated according to the homogeneous equations:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;This is called the physiological parameterization&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dC/dt = -Cl/V * C - Clpa/V * (C-Cpa) - Clpb/V * (C-Cpb) and dCpa/dt = Clpa/Vp * (C-Cpa) and dCpb/dt = Clpb/Vp * (C-Cpb)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;where:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;C is the concentration in the central compartment&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cpa is the concentration in the peripheral compartment A (connected to the central)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cpb is the concentration in the peripheral compartment B (connected to the central)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;with parameters:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cl=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Clearance from central compartment)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Cl</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;V=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Apparent volume of distribution in the central compartment)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">V</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Clpa=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Clearance from the central to the peripheral compartment and viceversa)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Clpa</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Vpa=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Apparent volume of distribution in the peripheral compartment)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Vpa</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">3</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Clpb=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Clearance from the central to the peripheral compartment and viceversa)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Clpb</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">2</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Vpb=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Apparent volume of distribution in the peripheral compartment)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">Vpb</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">3</span><span class="p">])))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;An alternative formulation is given by its microconstants formulation:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dA/dt = -k10 * A - k12a * A + k21a * Apa - k12b * A + k21b * Apb and dApa/dt = k12a * A - k21a * Apa and dApb/dt = k12b * A - k21b * Apb&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;where:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;A is the amount of drug in the central compartment (A=C*V)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Apa is the amount of drug in the peripheral compartment A (Apa=Cpa*Vpa)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Apb is the amount of drug in the peripheral compartment A (Apb=Cpb*Vpb)&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;with parameters:&quot;</span><span class="p">)</span>
        <span class="n">k12a</span><span class="o">=</span><span class="n">Clpa</span><span class="o">/</span><span class="n">V</span>
        <span class="n">k21a</span><span class="o">=</span><span class="n">Clpa</span><span class="o">/</span><span class="n">Vpa</span>
        <span class="n">k12b</span><span class="o">=</span><span class="n">Clpb</span><span class="o">/</span><span class="n">V</span>
        <span class="n">k21b</span><span class="o">=</span><span class="n">Clpb</span><span class="o">/</span><span class="n">Vpb</span>
        <span class="n">k10</span><span class="o">=</span><span class="n">Cl</span><span class="o">/</span><span class="n">V</span>
        <span class="n">kunits</span> <span class="o">=</span> <span class="n">divideUnits</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">parameterUnits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;k10=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Elimination from central compartment, k10=Cl/V)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">k10</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">kunits</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;k12a=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Transfer from central to peripheral A compartment, k12a=Clpa/V)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">k12a</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">kunits</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;k21a=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Transfer from peripheral A to central compartment, k21a=Clpa/Vpa)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">k21a</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">kunits</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;k12b=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Transfer from central to peripheral B compartment, k12b=Clpb/V)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">k12b</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">kunits</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;k21b=</span><span class="si">%f</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">) (Transfer from peripheral B to central compartment, k21b=Clpb/Vpb)&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">k21b</span><span class="p">,</span><span class="n">PKPDUnit</span><span class="o">.</span><span class="n">codeToString</span><span class="p">(</span><span class="n">kunits</span><span class="p">)))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: dependabot/pip/jinja2-2.11.3
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="pk_models.html">dependabot/pip/jinja2-2.11.3</a></dd>
            <dd><a href="../../../../dependabot_pip_pygments-2.7.4/index.html">dependabot/pip/pygments-2.7.4</a></dd>
            <dd><a href="../../../../dependabot_pip_urllib3-1.26.5/index.html">dependabot/pip/urllib3-1.26.5</a></dd>
            <dd><a href="../../../../gh-pages/index.html">gh-pages</a></dd>
            <dd><a href="../../../../release-2.0.0/index.html">release-2.0.0</a></dd>
            <dd><a href="../../../../release-3.0.0/index.html">release-3.0.0</a></dd>
            <dd><a href="../../../../rsanchezgarc-patch-1/index.html">rsanchezgarc-patch-1</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>