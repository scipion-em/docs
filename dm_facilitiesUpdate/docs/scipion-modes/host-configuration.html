

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Host configuration &mdash; Scipion 2.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../static/documentation_options.js"></script>
        <script type="text/javascript" src="../../static/jquery.js"></script>
        <script type="text/javascript" src="../../static/underscore.js"></script>
        <script type="text/javascript" src="../../static/doctools.js"></script>
        <script type="text/javascript" src="../../static/language_data.js"></script>
    
    <script type="text/javascript" src="../../static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/banner.css" type="text/css" />
  <link rel="stylesheet" href="../../static/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Troubleshooting" href="../user/troubleshooting.html" />
    <link rel="prev" title="Scipion configuration" href="scipion-configuration.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Scipion
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Set up</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install-from-sources.html">Installing Scipion v2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="scipion-configuration.html">Scipion configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Host configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#parameters">Parameters:</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mpi-command">MPI command</a></li>
<li class="toctree-l3"><a class="reference internal" href="#queue-system">Queue System</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-configurations">Example configurations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-for-slurm">Example for Slurm</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-for-torque-pbs">Example for Torque-PBS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-for-sge">Example for SGE</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../user/troubleshooting.html">Troubleshooting</a></li>
</ul>
<p class="caption"><span class="caption-text">User documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/user-documentation.html">Graphical interface manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/user-documentation.html#tutorials">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/user-documentation.html#processing-how-to-s">Processing How To’s</a></li>
</ul>
<p class="caption"><span class="caption-text">Facilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../facilities/facilities.html">Streaming Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../facilities/facilities-workflows.html">Streaming workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../facilities/acquisition-simulation.html">Tutorial for Facilities</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer/developers.html">Developers Page</a></li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api/pyworkflow.html">pyworkflow package</a></li>
</ul>
<p class="caption"><span class="caption-text">Get in touch</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../misc/contact-us.html">Contact Us</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Scipion</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
      <li>Host configuration</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../sources/docs/scipion-modes/host-configuration.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="figure">
<a class="reference internal image-reference" href="../../images/scipion_logo.gif"><img alt="scipion logo" src="../../images/scipion_logo.gif" style="width: 250px;" /></a>
</div>
<div class="section" id="host-configuration">
<span id="id1"></span><h1>Host configuration<a class="headerlink" href="#host-configuration" title="Permalink to this headline">¶</a></h1>
<p>In Scipion the configuration file <code class="docutils literal notranslate"><span class="pre">scipion/config/hosts.conf</span></code> contains
some properties of the execution machine. (In a future release we are
planning to allow more than one machine to be configured and used to
launch jobs). This configuration file is particularly important for
clusters that use a Queue System. In this scenario, it is common that
users should write a submission script to launch jobs to the cluster. In
Scipion the submission scripts are generated from a template (that is
setup once by the system administrator) and the users no longer need to
care about it. In the following sections you can find the definition of
those parameters and also some examples that you can use as a starting
point.</p>
<div class="section" id="parameters">
<h2>Parameters:<a class="headerlink" href="#parameters" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mpi-command">
<h3>MPI command<a class="headerlink" href="#mpi-command" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">localhost</span><span class="p">]</span>
<span class="n">PARALLEL_COMMAND</span> <span class="o">=</span> <span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="o">%</span><span class="n">_</span><span class="p">(</span><span class="n">JOB_NODES</span><span class="p">)</span><span class="n">d</span> <span class="o">-</span><span class="n">bynode</span> <span class="o">%</span><span class="n">_</span><span class="p">(</span><span class="n">COMMAND</span><span class="p">)</span><span class="n">s</span>
</pre></div>
</div>
<p>This variable reflects how to run programs using MPI in you computer.
This variable should be set even if you are not using a cluster (for
example in a multi-core machine). <code class="docutils literal notranslate"><span class="pre">JOB_NODES</span></code> will be replaced by the
number of MPI selected by the user in the form and the <code class="docutils literal notranslate"><span class="pre">COMMAND</span></code> with the
job launched by Scipion. This two should not be modified. In this
example we are using two parameters of MPI in our computer: <code class="docutils literal notranslate"><span class="pre">--np</span></code> and
<code class="docutils literal notranslate"><span class="pre">--bynode=</span></code>.</p>
</div>
<div class="section" id="queue-system">
<h3>Queue System<a class="headerlink" href="#queue-system" title="Permalink to this headline">¶</a></h3>
<p>When you run a protocol with <code class="docutils literal notranslate"><span class="pre">Use</span> <span class="pre">queue</span> <span class="pre">=</span> <span class="pre">Yes</span></code> the actual job
description file is created in the logs directory. For example,
<code class="docutils literal notranslate"><span class="pre">ScipionUserData/projects/MyProject/Runs/000162_ProtCTFFind/logs/3162.job</span></code>.
You can take a look at this file to see if everything is properly
defined (according to the requirements of your queue system) Following
is a description of each of the variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NAME</span> <span class="o">=</span> <span class="n">SLURM</span>
<span class="n">MANDATORY</span> <span class="o">=</span> <span class="mi">4</span>
</pre></div>
</div>
<p>With the NAME variable you can specify the name of your Queue System
(only a descriptive variable) that should not be empty. <code class="docutils literal notranslate"><span class="pre">MANDATORY</span></code> can be
set to an integer number, it specify the number of processors from which
is mandatory to launch the jobs through the queue. (NOTE: <code class="docutils literal notranslate"><span class="pre">MANDATORY</span> <span class="pre">=</span> <span class="pre">0</span></code>
means no restriction, old configuration use False which is equivalent to
0)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SUBMIT_PREFIX</span> <span class="o">=</span> <span class="n">run</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">SUBMIT_PREFIX</span></code> var is optional. It adds a prefix to the generated
submit script, for example: <code class="docutils literal notranslate"><span class="pre">run178.job</span></code>. The default is to use only the
id as 178.job, but this causes problems in some clusters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SUBMIT_COMMAND</span> <span class="o">=</span> <span class="n">sbatch</span> <span class="o">%</span><span class="n">_</span><span class="p">(</span><span class="n">JOB_SCRIPT</span><span class="p">)</span><span class="n">s</span>
<span class="n">CANCEL_COMMAND</span> <span class="o">=</span> <span class="n">scancel</span> <span class="o">%</span><span class="n">_</span><span class="p">(</span><span class="n">JOB_ID</span><span class="p">)</span><span class="n">s</span>
<span class="n">CHECK_COMMAND</span> <span class="o">=</span> <span class="n">squeue</span> <span class="o">-</span><span class="n">j</span> <span class="o">%</span><span class="n">_</span><span class="p">(</span><span class="n">JOB_ID</span><span class="p">)</span><span class="n">s</span>
</pre></div>
</div>
<p>The previous variables are used to specify how to submit, cancel and
check jobs, respectively. In this case <code class="docutils literal notranslate"><span class="pre">JOB_ID</span></code> will be provided by
Scipion as well as the generated job file (<code class="docutils literal notranslate"><span class="pre">JOB_SCRIPT</span></code>). The examples
here are from Slurm, for Torque/PBS the commands are:
<code class="docutils literal notranslate"><span class="pre">qsub,</span> <span class="pre">qdel,</span> <span class="pre">qstatus</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SUBMIT_TEMPLATE</span> <span class="o">=</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">SUBMIT_TEMPLATE</span></code> variable contains the template that will be used to
generate the job script file. It can contains some special variables
that will be replaced by Scipion. Some of this variables can be specific
to your own queues and system, that should be defined in the <code class="docutils literal notranslate"><span class="pre">QUEUES</span></code>
variable. It is important that the lines of the template should be
indented so there are correctly associated to this variable. See the
examples in the next sections.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QUEUES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;myslurmqueue&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s2">&quot;JOB_MEMORY&quot;</span><span class="p">,</span> <span class="s2">&quot;8192&quot;</span><span class="p">,</span> <span class="s2">&quot;Memory (MB)&quot;</span><span class="p">,</span> <span class="s2">&quot;Select amount of memory (in megabytes) for this job&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;JOB_TIME&quot;</span><span class="p">,</span> <span class="s2">&quot;120&quot;</span><span class="p">,</span> <span class="s2">&quot;Time (hours)&quot;</span><span class="p">,</span> <span class="s2">&quot;Select the time expected (in hours) for this job&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;GPU_COUNT&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;Number of GPUs&quot;</span><span class="p">,</span> <span class="s2">&quot;Select the number of GPUs if protocol has been set up to use them&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;QUEUE_FOR_JOBS&quot;</span><span class="p">,</span> <span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s2">&quot;Use queue for jobs&quot;</span><span class="p">,</span> <span class="s2">&quot;Send individual jobs to queue&quot;</span><span class="p">]]</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">QUEUES</span></code> variable should contain the different queues that can be
used. It should be written as a JSON dictionary, where the key is the
queue name and the value is a list of parameters. Each parameter is
composed by a list of 4 values:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Variable Name, that can be used in the template to be replaced</li>
<li>The default value The variable</li>
<li>The variable label that will be shown to the users in the GUI</li>
<li>A help message that users can use to know the meaning of this queue parameter.</li>
</ol>
</div></blockquote>
<p>Keep in mind that the parameters defined here (like <code class="docutils literal notranslate"><span class="pre">JOB_TIME</span></code>, in the example) will be returned from the GUI
dialog as a string. Hence, in the template you will need to declare them as string (%s), even if they are integers (%d).
See the Torque example (<code class="docutils literal notranslate"><span class="pre">JOB_HOURS</span></code> parameter).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">GPU_COUNT</span></code> variable is only needed if the queue is configured to manage GPUs (for instance in slurm).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">QUEUE_FOR_JOBS</span></code> variable is needed if you want to give the possibility to submit single jobs to the queue (by default Scipion submits the whole protocol run to the queue as a single job). The other variable involved in this mode is JOB_DONE_REGEX which is used to check for finished jobs. If unset (not in the config) then jobs are considered finished when the CHECK_COMMAND returns nothing (for instance, slurm). If the batch system returns some string that needs to be parsed to check the job status then use this variable to specify the regular expression to check for finished jobs. This check is done every 3 seconds making this kind of submission slower for fast jobs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">QUEUES_DEFAULT</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;JOB_GPUS&quot;</span><span class="p">:</span> <span class="s2">&quot;0&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">QUEUES_DEFAULT</span></code> variable is optional. It is only useful if you have
configured more than one queue, and some of the queue have distinct
parameters than the others. In this case, you need to provide a default
value (to be used in the template script) when other queues are
selected. The values must be set with the Key = Value inside braces.</p>
</div>
</div>
<div class="section" id="example-configurations">
<h2>Example configurations<a class="headerlink" href="#example-configurations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="example-for-slurm">
<h3>Example for <a class="reference external" href="http://slurm.schedmd.com/slurm.html">Slurm</a><a class="headerlink" href="#example-for-slurm" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://thehatteronline.com/2014/11/18/turn-your-workstation-into-a-mini-grid-with-slurm">Here</a>
you can find a very simple tutorial about installing Slurm in Ubuntu.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">localhost</span><span class="p">]</span>
<span class="n">PARALLEL_COMMAND</span> <span class="o">=</span> <span class="n">mpirun</span> <span class="o">-</span><span class="n">np</span> <span class="o">%</span><span class="n">_</span><span class="p">(</span><span class="n">JOB_NODES</span><span class="p">)</span><span class="n">d</span> <span class="o">-</span><span class="n">bynode</span> <span class="o">%</span><span class="n">_</span><span class="p">(</span><span class="n">COMMAND</span><span class="p">)</span><span class="n">s</span>
</pre></div>
</div>
<p>NAME = SLURM
MANDATORY = False
SUBMIT_COMMAND = sbatch %_(JOB_SCRIPT)s
CANCEL_COMMAND = scancel %_(JOB_ID)s
CHECK_COMMAND = squeue -h -j %_(JOB_ID)s
SUBMIT_TEMPLATE = #!/bin/bash</p>
<blockquote>
<div><p>### Job name
#SBATCH -J %_(JOB_NAME)s
### Outputs (we need to escape the job id as %%j)
#SBATCH -o %_(JOB_LOGS)s.out
#SBATCH -e %_(JOB_LOGS)s.err
### Partition (queue) name
### if the system has only 1 queue, it can be omited
### if you want to specify the queue, ensure the name in the scipion dialog matches
### a slurm partition, then leave only 1 # sign in the next line
##### SBATCH -p %_(JOB_QUEUE)s</p>
<p>### Specify time, number of nodes (tasks), cores and memory(MB) for your job
#SBATCH –time=%_(JOB_TIME)s:00:00 –ntasks=%_(JOB_NODES)d –cpus-per-task=%_(JOB_THREADS)d –mem=%_(JOB_MEMORY)s           –gres=gpu:%_(GPU_COUNT)s
# Use as working dir the path where sbatch was launched
WORKDIR=$SLURM_SUBMIT_DIR</p>
<p>### Set environment varible to know running mode is non interactive
export XMIPP_IN_QUEUE=1</p>
<p>cd $WORKDIR
# Make a copy of node file
echo $SLURM_JOB_NODELIST &gt; %_(JOB_NODEFILE)s
# Calculate the number of processors allocated to this run.
NPROCS=`wc -l &lt; $SLURM_JOB_NODELIST`
# Calculate the number of nodes allocated.
NNODES=`uniq $SLURM_JOB_NODELIST | wc -l`</p>
<p>### Display the job context
echo Running on host <cite>hostname</cite>
echo Time is <cite>date</cite>
echo Working directory is <cite>pwd</cite>
echo Using ${NPROCS} processors across ${NNODES} nodes
echo NODE LIST - config:
cat $SLURM_JOB_NODELIST
echo CUDA_VISIBLE_DEVICES: $CUDA_VISIBLE_DEVICES
#################################
# echo ‘%_(JOB_COMMAND)s’ &gt;&gt; /tmp/slurm-jobs.log
%_(JOB_COMMAND)s
find “$SLURM_SUBMIT_DIR” -type f -user $USER -perm 644 -exec chmod 664 {} +</p>
</div></blockquote>
<dl class="docutils">
<dt>QUEUES = {</dt>
<dd><dl class="first last docutils">
<dt>“tesla”: [[“JOB_MEMORY”, “8192”, “Memory (MB)”, “Select amount of memory (in megabytes) for this job”],</dt>
<dd>[“JOB_TIME”, “120”, “Time (hours)”, “Select the time expected (in hours) for this job”],
[“GPU_COUNT”, “1”, “Number of GPUs”, “Select the number of GPUs if protocol has been set up to use them”],
[“QUEUE_FOR_JOBS”, “N”, “Use queue for jobs”, “Send individual jobs to queue”]],</dd>
<dt>“geforce”: [[“JOB_MEMORY”, “8192”, “Memory (MB)”, “Select amount of memory (in megabytes) for this job”],</dt>
<dd>[“JOB_TIME”, “120”, “Time (hours)”, “Select the time expected (in hours) for this job”],
[“GPU_COUNT”, “1”, “Number of GPUs”, “Select the number of GPUs if protocol has been set up to use them”],
[“QUEUE_FOR_JOBS”, “N”, “Use queue for jobs”, “Send individual jobs to queue”]],</dd>
<dt>“quadro”: [[“JOB_MEMORY”, “8192”, “Memory (MB)”, “Select amount of memory (in megabytes) for this job”],</dt>
<dd>[“JOB_TIME”, “120”, “Time (hours)”, “Select the time expected (in hours) for this job”],
[“GPU_COUNT”, “1”, “Number of GPUs”, “Select the number of GPUs if protocol has been set up to use them”],
[“QUEUE_FOR_JOBS”, “N”, “Use queue for jobs”, “Send individual jobs to queue”]]</dd>
</dl>
</dd>
</dl>
<p>}</p>
</div>
<div class="section" id="example-for-torque-pbs">
<h3>Example for Torque-PBS<a class="headerlink" href="#example-for-torque-pbs" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[localhost]
PARALLEL_COMMAND = mpirun -np %_(JOB_NODES)d -bynode %_(COMMAND)s
NAME = PBS/TORQUE
MANDATORY = False
SUBMIT_COMMAND = qsub %_(JOB_SCRIPT)s
SUBMIT_TEMPLATE = #!/bin/bash
        ### Inherit all current environment variables
        #PBS -V
        ### Job name
        #PBS -N %_(JOB_NAME)s
        ### Queue name
        ###PBS -q %_(JOB_QUEUE)s
        ### Standard output and standard error messages
        #PBS -k eo
        ### Specify the number of nodes and thread (ppn) for your job.
        #PBS -l nodes=%_(JOB_REAL_NODES)s:ppn=%_(CPUS_PER_NODE)s
        ### Tell PBS the anticipated run-time for your job, where walltime=HH:MM:SS
        #PBS -l walltime=%_(JOB_HOURS)s:00:00
        # Memory per node
        #PBS -l mem=%_(JOB_MEM)sg
        # Use as working dir the path where qsub was launched
        WORKDIR=$PBS_O_WORKDIR
        #################################
        ### Set environment varible to know running mode is non interactive
        export XMIPP_IN_QUEUE=1
        ### Switch to the working directory;
        cd $WORKDIR
        # Make a copy of PBS_NODEFILE
        cp $PBS_NODEFILE %_(JOB_NODEFILE)s
        # Calculate the number of processors allocated to this run.
        NPROCS=`wc -l &lt; $PBS_NODEFILE`
        # Calculate the number of nodes allocated.
        NNODES=`uniq $PBS_NODEFILE | wc -l`
        ### Display the job context
        echo Running on host `hostname`
        echo Time is `date`
        echo Working directory is `pwd`
        echo Using ${NPROCS} processors across ${NNODES} nodes
        echo PBS_NODEFILE:
        cat $PBS_NODEFILE
        #################################
        %_(JOB_COMMAND)s
CANCEL_COMMAND = canceljob %_(JOB_ID)s
CHECK_COMMAND = qstat %_(JOB_ID)s
QUEUES = { &quot;mypbsqueue&quot;: [ [&quot;JOB_HOURS&quot;, &quot;120&quot;, &quot;Time (hours)&quot;, &quot;Select the expected job time&quot;], [&quot;JOB_REAL_NODES&quot;, &quot;1&quot;, &quot;Nodes&quot;, &quot;How many nodes the job needs&quot;], [&quot;CPUS_PER_NODE&quot;, &quot;8&quot;, &quot;CPUs&quot;, &quot;How many CPUs/node to use&quot;], [&quot;JOB_MEM&quot;, &quot;16&quot;, &quot;Memory (GB)&quot;, &quot;Define the memory per node for the job&quot;] ] }
</pre></div>
</div>
</div>
<div class="section" id="example-for-sge">
<h3>Example for SGE<a class="headerlink" href="#example-for-sge" title="Permalink to this headline">¶</a></h3>
<p>This example is based on a config originally adapted by <a class="reference external" href="http://www.hpc.polito.it/">HPC&#64;POLITO</a> .</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">localhost</span><span class="p">]</span>
<span class="n">PARALLEL_COMMAND</span> <span class="o">=</span> <span class="n">mpirun</span>
<span class="n">MANDATORY</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">NAME</span> <span class="o">=</span> <span class="n">SGE</span>
<span class="n">CANCEL_COMMAND</span> <span class="o">=</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">sge6</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">x64</span><span class="o">/</span><span class="n">qdel</span> <span class="o">%</span><span class="n">_</span><span class="p">(</span><span class="n">JOB_ID</span><span class="p">)</span><span class="n">s</span>
<span class="n">CHECK_COMMAND</span> <span class="o">=</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">sge6</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">x64</span><span class="o">/</span><span class="n">qstat</span> <span class="o">-</span><span class="n">j</span> <span class="o">%</span><span class="n">_</span><span class="p">(</span><span class="n">JOB_ID</span><span class="p">)</span><span class="n">s</span>
<span class="n">SUBMIT_COMMAND</span> <span class="o">=</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">sge6</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">linux</span><span class="o">-</span><span class="n">x64</span><span class="o">/</span><span class="n">qsub</span> <span class="o">%</span><span class="n">_</span><span class="p">(</span><span class="n">JOB_SCRIPT</span><span class="p">)</span><span class="n">s</span>
<span class="n">SUBMIT_TEMPLATE</span> <span class="o">=</span> <span class="c1">#!/bin/bash</span>
    <span class="c1">###====================================================###</span>
    <span class="c1">#$ -V</span>
    <span class="c1">#$ -S /bin/bash</span>
    <span class="c1">#$ -cwd ### Use the current working directory</span>
    <span class="c1">#$ -N scipion%_(JOB_NAME)s ### Job name</span>
    <span class="c1">#$ -q %_(JOB_QUEUE)s ### Queue name</span>
    <span class="c1">#$ -pe %_(JOB_PE)s %_(JOB_SLOTS)s</span>
    <span class="c1">#$ -j y ### Merge stdin and stdout</span>
    <span class="c1">###=======================================================#</span>
    <span class="c1">#$ -l h_rt=%_(JOB_HOURS)s:00:00 ### Max run Time</span>
    <span class="c1">#$ -l vf=%_(JOB_MAX_MEM)sG</span>
    <span class="c1">###=====================================================###</span>

    <span class="o">%</span><span class="n">_</span><span class="p">(</span><span class="n">JOB_COMMAND</span><span class="p">)</span><span class="n">s</span>

<span class="n">QUEUES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;ogequeue&quot;</span><span class="p">:</span> <span class="p">[</span>
             <span class="p">[</span><span class="s2">&quot;JOB_QUEUE&quot;</span><span class="p">,</span><span class="s2">&quot;all.q&quot;</span><span class="p">,</span><span class="s2">&quot;Queue Name:&quot;</span><span class="p">,</span><span class="s2">&quot;Select the target queue&quot;</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;JOB_SLOTS&quot;</span><span class="p">,</span><span class="s2">&quot;16&quot;</span><span class="p">,</span><span class="s2">&quot;Total cores:&quot;</span><span class="p">,</span><span class="s2">&quot;(MPI tasks x threads)&quot;</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;JOB_PE&quot;</span><span class="p">,</span><span class="s2">&quot;orte&quot;</span><span class="p">,</span> <span class="s2">&quot;Parallel Environment (PE):&quot;</span><span class="p">,</span><span class="s2">&quot;Select the OGE Parallel Environment)&quot;</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;JOB_HOURS&quot;</span><span class="p">,</span><span class="s2">&quot;120&quot;</span><span class="p">,</span> <span class="s2">&quot;Hours:&quot;</span><span class="p">,</span><span class="s2">&quot;Maximum amount of time allowed for this job&quot;</span><span class="p">],</span>
             <span class="p">[</span><span class="s2">&quot;JOB_MAX_MEM&quot;</span><span class="p">,</span><span class="s2">&quot;64&quot;</span><span class="p">,</span><span class="s2">&quot;Mem(GB/node):&quot;</span><span class="p">,</span><span class="s2">&quot;Set the memory per node that this job needs&quot;</span><span class="p">]</span>
          <span class="p">]</span>
    <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../user/troubleshooting.html" class="btn btn-neutral float-right" title="Troubleshooting" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="scipion-configuration.html" class="btn btn-neutral float-left" title="Scipion configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Scipion team

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <span class="fa fa-book"> Other Versions</span>
        v: dm_facilitiesUpdate
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Branches</dt>
            <dd><a href="../../../dependabot_pip_urllib3-1.24.2/docs/scipion-modes/host-configuration.html">dependabot/pip/urllib3-1.24.2</a></dd>
            <dd><a href="host-configuration.html">dm_facilitiesUpdate</a></dd>
            <dd><a href="../../../gh-pages/docs/scipion-modes/host-configuration.html">gh-pages</a></dd>
            <dd><a href="../../../release-2.0.0/docs/scipion-modes/host-configuration.html">release-2.0.0</a></dd>
            <dd><a href="../../../release-3.0.0/docs/scipion-modes/host-configuration.html">release-3.0.0</a></dd>
            <dd><a href="../../../update_scipion_modes/docs/scipion-modes/host-configuration.html">update_scipion_modes</a></dd>
        </dl>
    </div>
</div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>